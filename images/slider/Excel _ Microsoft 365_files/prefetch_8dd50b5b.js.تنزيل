(window.webpackJsonp_8eb8d15c_ee39_4ddf_a600_2bbff775cefe=window.webpackJsonp_8eb8d15c_ee39_4ddf_a600_2bbff775cefe||[]).push([["prefetch"],{"+XOu":function(e,t,r){"use strict";r.r(t),r.d(t,"spRequestDurationHeader",(function(){return n})),r.d(t,"spClientServiceRequestDurationHeader",(function(){return o})),r.d(t,"sharePointCorrelationHeader",(function(){return c})),r.d(t,"getNamedHeadersFromXhr",(function(){return i})),r.d(t,"getRequestDurationFromXhr",(function(){return a})),r.d(t,"getRequestDurationFromHeaders",(function(){return u}));var n="sprequestduration",o="spclientservicerequestduration",c="sprequestguid";function i(e,t){var r={};if(e.getAllResponseHeaders){var n=e.getAllResponseHeaders();t.forEach((function(t){e.getResponseHeader&&-1!==n.indexOf(t)&&(r[t]=e.getResponseHeader(t)||"")}))}return r}function a(e){var t=i(e,[n,o]);return t[n]||t[o]||void 0}function u(e){return e[n]||e[o]||""}},"/hiP":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("k6ph"),o=r("x2tm"),c=r("WMEh");function i(e,t){return Object(o.a)(t,Object(n.a)(Object(c.a)(e))(t))}},"0tYw":function(e,t,r){"use strict";function n(e){var t=null;return function(r){return t?t(r):e.then((function(e){return t=e,e(r)}))}}r.r(t),r.d(t,"createAsyncTokenProvider",(function(){return n})),r.d(t,"fetch",(function(){return c.a})),r.d(t,"fetchAcquireToken",(function(){return i.default})),r.d(t,"fetchAndParseSearchConfiguration",(function(){return b})),r.d(t,"fetchCustomVerticals",(function(){return g.a})),r.d(t,"fetcher",(function(){return O.a})),r.d(t,"fetchBingConsumer",(function(){return j.default})),r.d(t,"fetchFileShareConnectorSettings",(function(){return y})),r.d(t,"fetchHubSites",(function(){return C.default})),r.d(t,"fetchPersonalData",(function(){return P})),r.d(t,"fetchTopicData",(function(){return T.default})),r.d(t,"fetchPersonalRankingContext",(function(){return w.default})),r.d(t,"fetchSearchCenterUrl",(function(){return R})),r.d(t,"fetchRawSearchCenterUrl",(function(){return E})),r.d(t,"fetchSearchConfiguration",(function(){return h.a})),r.d(t,"fetchTellMeSearchResults",(function(){return M.default})),r.d(t,"fetchParsedCustomVerticals",(function(){return d.default})),r.d(t,"fetchSearchConfigurationFromEcs",(function(){return A})),r.d(t,"fetchConfigFromEcsWithCacheAndMonitor",(function(){return U})),r.d(t,"fetchSiteNewsSuggestions",(function(){return q})),r.d(t,"fetchSharePointDigest",(function(){return _.default})),r.d(t,"fetchSharePointDigestV2",(function(){return z})),r.d(t,"fetchSitesFromSubstrate",(function(){return K})),r.d(t,"fetchNotificationConfig",(function(){return ne})),r.d(t,"updateNotificationConfig",(function(){return re})),r.d(t,"cache",(function(){return oe.cache})),r.d(t,"init",(function(){return oe.init})),r.d(t,"puid",(function(){return oe.puid})),r.d(t,"statusOk",(function(){return X.default})),r.d(t,"substrateIframeProxy",(function(){return W.substrateIframeProxy})),r.d(t,"getModuleProxy",(function(){return W.getModuleProxy})),r.d(t,"toTokenDetail",(function(){return ce.toTokenDetail})),r.d(t,"warmupMsb",(function(){return ae})),r.d(t,"resolveBingUrl",(function(){return $})),r.d(t,"resolveLokiEnvironment",(function(){return ue.resolveLokiEnvironment})),r.d(t,"resolveSubstrateUrl",(function(){return se.resolveSubstrateUrl})),r.d(t,"warmupSubstrateSearch",(function(){return fe.default})),r.d(t,"withBasicMonitor",(function(){return N.a})),r.d(t,"withMonitor",(function(){return de.a})),r.d(t,"withImportMonitor",(function(){return le.default})),r.d(t,"withPeriodicRefresh",(function(){return me})),r.d(t,"withRefresh",(function(){return pe})),r.d(t,"getEcsIds",(function(){return ve.a})),r.d(t,"withCache",(function(){return H.a})),r.d(t,"fetchParsedOcpsPolicies",(function(){return m})),r.d(t,"BUILD_VERSION",(function(){return be.a})),r.d(t,"getIframeProxy",(function(){return W.getIframeProxy}));var o,c=r("DHVw"),i=r("MkXD"),a=r("+zb2"),u=r("sUnP"),s=r("vskH"),f=r("CZty"),d=r("ZHTy"),l=r("LLyz"),h=r("zLON");function p(e){if(!o||!o.isPending||o.isRejected){o={};var t=new Promise((function(e,t){o.promiseResolver=function(t){o.isPending=!1,e(t)},o.promiseRejector=function(){o.isRejected=!0,o.isPending=!1,t()}}));o.promiseObj=t,o.isRejected=!1,t.catch((function(){}))}o.isPending=!0,e&&(o.option=e)}function m(){var e;if(o&&!o.isRejected){var t=o.option;p(t),Object(h.a)(t).then((function(e){var t,r,n=e.xhr;if(n.responseText){var c=JSON.parse(n.responseText).ocpsPolicies;null===(t=o.promiseResolver)||void 0===t||t.call(o,c)}else null===(r=o.promiseRejector)||void 0===r||r.call(o)})).catch((function(e){var t;console.error(e),null===(t=o.promiseRejector)||void 0===t||t.call(o,e),Object(l.throwSafeToLogError)("OCPS_POLICIES_FETCH_FAILED")})),e=o.promiseObj}return e}var v=r("msSD");function b(e){var t,r,n="true"===Object(u.getQueryStringValue)("cacheClear");Object(u.getQueryStringValue)("sid")&&(e.siteId=Object(u.getQueryStringValue)("sid")),e.siteId&&(e.siteId=e.siteId.toUpperCase());var o=null===(r=null===(t=e.additionalHeaders)||void 0===t?void 0:t[v.a.SearchComponent])||void 0===r?void 0:r.toLowerCase();return"serp"===o&&(Object(d.createSearchConfigPromiseEntity)(e),p(e)),e.useThor&&e.thorTokenProvider?e.tokenProvider=e.thorTokenProvider:e.useThor=!1,Object(h.a)(Object(a.a)(Object(a.a)({},e),{cacheClear:n})).then((function(e){var t=e.xhr,r=JSON.parse(t.responseText),n=null==r?void 0:r.ecsSettings;r.ecsSettings=Object(s.a)(Object(f.a)("ecsOverrides","wipeEcsConfig",n));var c=Object(d.getSearchConfigPromiseEntity)();return"serp"===o&&(r.verticalConfig?(null==c?void 0:c.promiseResolver)&&c.promiseResolver(r.verticalConfig):(null==c?void 0:c.promiseRejector)&&c.promiseRejector()),r})).catch((function(){var e,t=null===(e=Object(d.getSearchConfigPromiseEntity)())||void 0===e?void 0:e.promiseRejector;t&&t()}))}var g=r("e+qm"),O=r("/hiP"),j=r("n8Nd"),S=["AllVerticalContent","FilesVerticalContent"],y=Object(O.a)((function(e){return function(t){var r=t.endpoint;return Object(c.a)({url:"".concat(r,"/_api/web/AllProperties?$select=").concat(S.join(",")),method:"GET",headers:Object(a.a)({Accept:"application/json;odata=verbose"},e?{Authorization:"Bearer ".concat(e)}:{}),timeoutMs:5e3})}}),{monitorName:"prefetchFileShareConnectorsInfo",cacheId:"fileshareconnectorsettings",cacheVersion:"0",cacheItemLifetime:216e5,cacheKeyExtractor:function(e){return{endpoint:e.endpoint}}}),C=r("TG2i");function x(e){return function(t){return(t.prefetchFetch||c.a)(e(t))}}var I,P=Object(O.a)((function(e){return x((function(t){return{url:t.url,method:"GET",headers:Object(a.a)({Accept:"application/json;odata=verbose"},e?{Authorization:"Bearer ".concat(e)}:{}),timeoutMs:5e3}}))}),{monitorName:"fetchPersonalAccountName",cacheId:"personalaccountname",cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(){return{}}}),T=r("jt5z"),w=r("OMji");function E(e){var t=e.siteRoot,r=e.tokenProvider;return k({siteRoot:t,tokenProvider:r}).then((function(e){if(e.cacheItemResolved&&I)return I;var t=JSON.parse(e.xhr.responseText),r=t&&t.d&&t.d.searchcenterurl||"";return I=r,r}))}var k=Object(O.a)((function(){return function(e){var t=e.siteRoot;return(0,e.tokenProvider)({attempt:0}).then((function(e){return Object(c.a)({url:"".concat(t,"/_api/search/searchcenterurl"),method:"GET",headers:Object(a.a)({Accept:"application/json;odata=verbose"},e?{Authorization:"Bearer ".concat(e)}:{}),timeoutMs:5e3})}))}}),{monitorName:"fetchSearchCenterUrl",cacheId:"searchcenterurl",cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(){return{}},useCachePersistentStorage:!0}),R=function(e){return E({siteRoot:e.siteRoot,tokenProvider:e.tokenProvider}).then((function(e){return function(e){var t=e.lastIndexOf("/search/");if(t<0)return"";return e.substring(0,t+"/search/".length).replace(/\/$/,"")}(e)}))};var D,M=r("PWcX"),L=r("3UHF"),A=x((function(e){return e?{url:Object(f.b)(e),method:"GET"}:Object(L.a)("missing options for ECS call")})),N=r("uKfc"),H=r("k6ph"),U=Object(N.a)({monitorName:"searchConfigurationFromEcs",monitorType:"prefetch_request",successPropExtractor:function(e){return Object(f.c)(Object(f.d)(null==e?void 0:e.xhr.responseText,{disableUrlOverrides:!0}))},failurePropExtractor:function(e){return{errorCode:(null==e?void 0:e.status)||-1}}},Object(H.a)((D=A,function(e){return D(e).then((function(e){return{xhr:e}}))}))({cacheId:"searchConfigurationFromEcs",cacheVersion:"0",cacheItemLifetime:3e5,cacheKeyExtractor:function(e){return Object(a.d)(e,[])}}));function V(e,t,r){return"".concat(r.sitePath,"/_api/search/query?QueryText='*'").concat(function(e){var t=e.departmentId,r=e.isHubSite;return"&QueryTemplate='({searchterms}) ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118*"+" AND PromotedState:2 AND ".concat((r&&t?F:G)(e),"'")}(r))+"&HitHighlightedProperties='Title'&StartRow=0&RowLimit=100"+"&Properties='ClientFunction:News,EnableMultiGeoSearch:".concat(e?"true":"false","'")+"&sortlist='LastModifiedTime:descending'&SelectProperties='ContentClass,ContentTypeId,DefaultEncodingURL,DocId,EditorOWSUSER,FileExtension,GeoLocationSource,LastModifiedTime,ModifiedBy,Path,SPWebUrl,SPSiteURL,SecondaryFileExtension,ServerRedirectedUrl,SiteId,Title,UniqueId,WebId'"+"&ClientType='".concat(t,"'&EnableQueryRules=false")}function G(e){var t=e.sitePath;return'Path:"'.concat(t,'"')}function F(e){var t=e.departmentId;return"(DepartmentId:".concat(t," OR DepartmentId:").concat(t.replace(/[{}]/g,""),")")}var q=Object(O.a)((function(e){return function(t){var r=t.clientId,n=t.site;return Object(c.a)({url:V(!0,r,n),method:"GET",headers:Object(a.a)({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},e?{Authorization:"Bearer ".concat(e)}:{})})}}),{monitorName:"sitenews-rawPrefetch",cacheId:"sitenews-rawPrefetch",cacheVersion:"0",cacheItemLifetime:9e5,cacheKeyExtractor:function(e){return{sitePath:e.site.sitePath}}}),_=r("Y3nR"),B=!1,z=Object(O.a)((function(e){return function(t){var r=t.endpoint,n=t.overrideDigest;return n&&!B?(B=!0,new Promise((function(e){e({responseText:JSON.stringify({d:{GetContextWebInformation:{FormDigestValue:n}}})})}))):Object(c.a)({url:"".concat(r,"/_api/contextinfo"),method:"POST",headers:Object(a.a)({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},e?{Authorization:"Bearer ".concat(e)}:{}),timeoutMs:5e3})}}),{monitorName:"fetchSharepointDigest",cacheId:"fetchSharepointDigest",cacheVersion:"0",cacheItemLifetime:179e4,cacheKeyExtractor:function(e){return{url:e.endpoint}}}),J=r("W4Bk"),X=r("3WoE"),W=r("JCJM"),K=Object(O.a)((function(e){return function(t){var r=t.prefix,n=t.substrateUrl;return Object(W.substrateIframeProxy)(n).then((function(t){return t({action:"queryv2",token:e,prefix:r,cvid:Object(J.a)()}).then((function(e){if(!Object(X.default)(e.statusCode))throw{status:e.statusCode};return{status:e.statusCode,responseText:e.qfResponse}}))}))}}),{monitorName:"fetchSitesFromSubstrate",cacheId:"fetchSitesFromSubstrate",cacheVersion:"0",cacheItemLifetime:108e5,cacheKeyExtractor:function(e){e.token;var t=Object(a.d)(e,["token"]);return Object(a.a)({},t)}}),Q=r("KUM7");function Z(e,t){switch(e){case"dev":return"https://localhost:18101/api";case"test":return"https://bingatwork.asgfalcon-test.io/api";case"prod":return t||"https://business.bing.com/api";case"prod_generic":return t||"https://business.bing.com/work/api";case"prod_gcc":return t||"https://usgov.business.bing.com/api";case"prod_gcch":return t||"https://usgovhigh.business.bing.com/api";case"prod_dod":return t||"https://dod.mss.office365.us/api";case"dev_bing":return"https://localhost/work/api";case"staging_bing":return"https://www.staging-bing-int.com/work/api";default:return Object(Q.a)(e)}}function $(e){switch(e){case"test":return Z(e);case"gcc":return Z("prod_gcc");case"trailblazer":return Z("prod_gcch");case"pathfinder":return Z("prod_dod");default:return Z("prod_generic")}}var Y=r("WMEh"),ee=function(e){return"".concat($(e),"/v3/user/data/notifications")},te=function(e){return{authorization:"Bearer ".concat(e)}},re=Object(Y.a)((function(e){return x((function(t){var r=t.clientType,n=t.environment,o=t.action,c=t.notification;return{url:ee(n),method:"PUT",body:JSON.stringify({actions:[{action:o,notification:c}],clientContext:{clientType:r}}),headers:te(e)}}))})),ne=Object(O.a)((function(e){return x((function(t){var r=t.clientType,n=t.environment;return{url:ee(n)+"?q=me",method:"POST",body:JSON.stringify({placement:"MsoSearchBox",clientContext:{clientType:r}}),headers:te(e)}}))}),{monitorName:"fetchNotificationConfig",cacheId:"fetchNotificationConfig",cacheVersion:"0",cacheItemLifetime:18e5,cacheKeyExtractor:function(e){e.token;return Object(a.d)(e,["token"])}}),oe=r("DeF7"),ce=r("g1R2"),ie="warmupMsb",ae=Object(O.a)((function(e){return function(t){var r=t.msbUrl,n=t.clientType;"https://business.bing.com"===r&&(r+="/work/api");var o="".concat(r,"/v3/user/init"),i={Authentication:e,clientContext:{clientType:n}};return Object(c.a)({url:o,method:"POST",body:JSON.stringify(i)})}}),{monitorName:ie,cacheId:ie,cacheVersion:"0",cacheItemLifetime:5e3,cacheKeyExtractor:function(e){e.token;var t=Object(a.d)(e,["token"]);return Object(a.a)({},t)}}),ue=r("SGCm"),se=r("TCme"),fe=r("KzqD"),de=r("x2tm"),le=r("9Q1t"),he=r("DEsW");function pe(e,t){var r,n=null,o=!1,c=function(){return o||(o=!0,r=t({attempt:1}).then((function(e){return n=Object(ce.toTokenDetail)(e),o=!1,n.token})).catch((function(e){throw o=!1,e}))),r};return function(r,o,i){void 0===i&&(i=!0);var u,s,f,d=i?(u="".concat(e,"_withRefresh"),s=performance.now(),(f=Object(he.getDispatcher)()).dispatch({name:"generic_qos",nameDetail:u,timestamp:s,eventType:"QOSSTART"}),function(e,t,r){var n=performance.now();f.dispatch({name:"generic_qos",nameDetail:u,startTimestamp:s,totalTime:n-s,eventType:"QOSSTOP",result:e,properties:{customLogProps:JSON.stringify(t)},error:r})}):function(){};if(!t)return d("FAILURE",Object(a.a)({cacheItemResolved:!1,tokenProviderNull:!0},o)),Promise.reject("token provider is null");if(!n||!Object(ce.isValid)(n)||r.attempt>0)return c().then((function(e){return d("SUCCESS",Object(a.a)({cacheItemResolved:!1,expires:n&&new Date(n.expEpoch),didRefresh:!0},o)),e})).catch((function(e){throw d("FAILURE",Object(a.a)({cacheItemResolved:!1,tokenProviderNull:!1},o)),e.reason||e}));var l=Object(ce.isApproachingExpiration)(n);return l&&c(),d("SUCCESS",Object(a.a)({cacheItemResolved:!0,expires:n&&new Date(n.expEpoch),backgroundRefresh:l},o)),Promise.resolve(n.token)}}function me(e,t,r){var n,o,c=0,i=0,a=pe(e,t);return function(e){return c++,o||(o=window.setInterval((function(){var e={invokedByPeriodicRefresh:!0,invocationCounter:++c};Date.now()-n>864e5||i>=5?(window.clearInterval(o),o=void 0,i=0):a({attempt:0},e,!1).then((function(e){return i=0})).catch((function(e){console.error(e),i++}))}),r||3e5)),n=Date.now(),a(e,{invokedByPeriodicRefresh:!1,invocationCounter:c},!0)}}var ve=r("cLGF"),be=r("xn41")},"3UHF":function(e,t,r){"use strict";function n(e){throw new Error(e)}r.d(t,"a",(function(){return n}))},"3WoE":function(e,t,r){"use strict";function n(e){return e>=200&&e<=300||0===e}r.r(t),r.d(t,"default",(function(){return n}))},"6VTQ":function(e,t,r){"use strict";var n;function o(e){switch(e.complianceEnvironment){case"Df":return n.Dogfood;case"Msit":return n.MSIT;case"GccModerate":return n.GccModerate;case"GccHigh":return n.GccHigh;case"DoD":return n.DOD;case"Gallatin":return n.Gallatin;case"Prod":return n.TopLevel;case"AG08":return n.AG08;case"AG09":return n.AG09;default:return function(e){throw new Error("'".concat(e,"' is not an expected environment for Thor"))}(e.complianceEnvironment)}}r.d(t,"a",(function(){return o})),function(e){e.TopLevel="https://thor.aesir.office.com",e.Prod="https://thor.aesir.office.com",e.GccModerate="https://gcc.thor.aesir.office.com",e.GccHigh="https://gcchigh.thor.aesir.office365.us",e.DOD="https://dod.thor.aesir.office365.us",e.Gallatin="https://thor.aesir.office365.cn",e.Dogfood="https://df.thor.aesir.office.com",e.Df="https://df.thor.aesir.office.com",e.MSIT="https://msit.thor.aesir.office.com",e.AG08="https://thor.aesir.officenet.eaglex.ic.gov",e.AG09="https://thor.aesir.officenet.microsoft.scloud"}(n||(n={}))},CVAo:function(e,t,r){"use strict";t.a=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},CZty:function(e,t,r){"use strict";r.d(t,"b",(function(){return f})),r.d(t,"c",(function(){return d})),r.d(t,"d",(function(){return l})),r.d(t,"a",(function(){return m}));var n=r("+zb2"),o=r("KUM7"),c=r("DEsW"),i=r("sUnP"),a=r("vskH"),u=r("LLyz"),s=r("cLGF"),f=function(e,t){var r,n=e.complianceEnvironment,c=e.clientWorkload,i=e.component,a=e.userId,u=e.tenantId,s=e.ring,f=e.isGuestUser,d=function(e,t){if(null==t?void 0:t.ECS)return t.ECS;var r=e;switch(r){case"GccHigh":return"config.ecs.gov.teams.microsoft.us";case"DoD":return"config.ecs.dod.teams.microsoft.us";case"Blackforest":case"Df":case"Gallatin":case"GccModerate":case"Msit":case"Unknown":case"Prod":return"ecs.office.com";default:return Object(o.b)(r,"ecs.office.com")}}(n,null===(r=null==t?void 0:t.props.serviceEnvInfo)||void 0===r?void 0:r.urls),l=function(e){switch(e){case"Blackforest":return"BlackForest";case"GccModerate":return"Gcc";default:return e&&"Unknown"!==e?e:"Prod"}}(n);return"https://".concat(d,"/config/v1/LokiService/1.0.0.0?")+"agents=MicrosoftSearch&ecsserviceinformation=true"+"&ClientWorkload=".concat(c)+"&id=".concat(a)+"&TenantID=".concat(u)+"&ring=".concat(s)+"&ApEnvironment=".concat(l)+"&IsGuestUser=".concat(String(f))+(i?"&MsSearch_Component=".concat(i):"")};function d(e){var t={};if(e){var r=JSON.parse(e);if(r.ecsConfigIds&&r.ecsEtag){t.ecsConfigIds=Object(s.a)(r.ecsConfigIds)||"",t.ecsEtag=r.ecsEtag.replace(/"/g,"");var n={},o="searchux.".length;r.ecsSettings&&Object.keys(r.ecsSettings).filter((function(e){return"boolean"==typeof r.ecsSettings[e]&&"searchux."===e.substr(0,o)})).forEach((function(e){return n[e.substr(o)]=r.ecsSettings[e]})),t.ecsSettings=JSON.stringify(n)}}return t}function l(e,t){return e?JSON.stringify(function(e,t){var r,o;try{var c=Object(n.a)({disableUrlOverrides:!1},t).disableUrlOverrides,i=JSON.parse(e),s=null==i?void 0:i.MicrosoftSearch;!c&&(s=m("ecsSbOverrides","wipeSbEcsConfig",s)),s=function(e){var t=(i=e,h(i,"searchBoxPluginConfiguration.",(function(e,t){return{id:"searchux.searchBoxPlugin."+e.split(".")[1],position:v(t)}}))),r=function(e){return h(e,"suggestionProviderGroups.",(function(e,t){return{id:e.split(".")[1],optimalCount:t.optimalCount,maxCount:t.maxCount,component:t.component,ariaLabel:t.ariaLabel,heading:t.heading,providers:p(t)}}))}(e),o=function(e){return h(e,"searchBoxQuickAction.",(function(t){return Object(n.a)({id:t.split(".")[1]},e[t]||{})}))}(e),c=function(e){return h(e,"answerProviderGroups.",(function(e,t){return{id:e.split(".")[1],optimalCount:t.optimalCount,component:t.component,providers:p(t)}}))}(e);var i;return Object(n.a)(Object(n.a)(Object(n.a)(Object(n.a)({},Object(a.a)(e)),(null==o?void 0:o.length)>0?{"searchux.searchBoxQuickActionsConfiguration":{commands:o}}:{}),{searchBoxPluginConfiguration:{plugins:t}}),Object(n.a)({searchBoxSuggestionProviderConfiguration:{groups:r,streamPolicy:e["searchux.suggestionGroupStreamPolicy"]}},!!c.length&&{searchBoxAnswerProviderConfiguration:{answers:c}}))}(s);var f=null===(r=null==i?void 0:i.Headers)||void 0===r?void 0:r.ETag,d=[null===(o=null==i?void 0:i.ConfigIDs)||void 0===o?void 0:o.MicrosoftSearch];return{ecsSettings:s,ecsConfigIds:d,ecsEtag:f}}catch(e){Object(u.throwSafeToLogError)("Failed to parse ECS config")}}(e,t)):""}function h(e,t,r){return Object.keys(e).filter((function(r){return r.indexOf(t)>-1&&e[r]})).sort((function(t,r){return v(e[t])-v(e[r])})).map((function(t){try{return r(t,e[t])}catch(e){Object(c.getDispatcher)().dispatch({name:"generic_error",nameDetail:"ecsUtils.convertSettingsWithKeyToArray",eventType:"ERROR",detail:"Mapper failed on key: "+t})}})).filter((function(e){return e}))}function p(e){return h(e,"providers.",(function(e){return"searchux.suggestionProvider.provider."+e.split(".")[1]}))}function m(e,t,r){var o=Object(i.getQueryStringValue)(t);o&&"true"===o.toLowerCase()&&(r={});var c=decodeURIComponent(Object(i.getQueryStringValue)(e));return c?function e(t,r){if(!b(t))return t;var o=Object(n.a)({},t);b(r)&&Object.keys(r).forEach((function(n){b(r[n])?o[n]=n in t?e(t[n],r[n]):r[n]:o[n]=r[n]}));return o}(r,JSON.parse(c)):r}function v(e){var t;return null!==(t=e.position)&&void 0!==t?t:Number.MAX_VALUE}function b(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}},DHVw:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r("+zb2"),o=r("3WoE");function c(e){return new Promise((function(t,r){var c=new(e.XMLHttpRequest||XMLHttpRequest);c.requestLogData=Object(n.a)({},e.requestLogData),c.open(e.method,e.url,!0),e.timeoutMs&&(c.timeout=e.timeoutMs),e.withCredentials&&(c.withCredentials=e.withCredentials);var i=e.headers||{};Object.keys(i).map((function(e){c.setRequestHeader(e,i[e])})),c.onload=function(){4===c.readyState&&(Object(o.default)(c.status)?t(c):r(c))},c.onerror=function(){r(c)},c.ontimeout=function(){r(c)};var a=e.body||null;c.send(a)}))}},DeF7:function(e,t,r){"use strict";r.r(t),r.d(t,"init",(function(){return i})),r.d(t,"puid",(function(){return a})),r.d(t,"cache",(function(){return u}));var n,o=r("3UHF"),c=r("xn41");function i(e){n&&Object(o.a)("Can not set initial state more than once.")||(e.cache.participants.push(c.a),n=e)}r.d(t,"BUILD_VERSION",(function(){return c.a}));var a=s("puid"),u=s("cache");function s(e){return function(){return n&&n[e]||Object(o.a)("Trying to get ".concat(e," before it is set."))}}},JCJM:function(e,t,r){"use strict";r.r(t),r.d(t,"substrateIframeProxy",(function(){return m})),r.d(t,"getModuleProxy",(function(){return v})),r.d(t,"getIframeProxy",(function(){return b})),r.d(t,"sendSubstrateRequest",(function(){return O})),r.d(t,"parseDiagnostics",(function(){return S})),r.d(t,"parser",(function(){return y}));var n=r("+zb2"),o=r("W4Bk");function c(e,t){var r=i();return{iframe:r,initialize:function(){return document.body.contains(r)||(r.src=e,r.style.display="none",document.body.appendChild(r)),r},postMessage:function(n,o,c){var i=function(e,n){return a(r.contentWindow,t,e,n)}(o,c);return r.contentWindow&&r.contentWindow.postMessage(n,e),i}}}var i=function(){return document.createElement("iframe")},a=function(e,t,r,n){return new Promise((function(o,c){return u((function i(a){if(a.source===e&&a.origin===t){var u=void 0,f=!1;try{u=r(a)}catch(e){return s(i),void c(e)}try{f=n(u,a)}catch(e){return s(i),void c(e)}f&&(s(i),o(u))}}))}))},u=function(e){return addEventListener("message",e,!1)},s=function(e){return removeEventListener("message",e,!1)},f=r("LLyz");var d=r("qBZW"),l={},h={},p={};function m(e,t){return void 0===e&&(e="https://substrate.office.com"),void 0===t&&(t=!1),e=Object(d.c)(e),void 0===h[e]&&(h[e]=v(e,t).ready),h[e].then((function(){return p[e]=!0,function(r){return j(r,e,t)}}))}function v(e,t){return l[e]?l[e]:b((r=window).mssearchux&&r.mssearchux.reuseIframe||!1||t,e+"/search/api/v2/resources",e);var r}function b(e,t,r){if(e){var n=document.getElementById("ms-searchux-3s-proxy"),o=function(e,t){if(e&&e.src===t&&e.ready&&e.postMessage)return{postMessage:e.postMessage,iframe:e,ready:e.ready,initialize:function(){return e}};return null}(n,t);l[r]=o||g(!n,t,r)}else l[r]=g(!1,t,r);return l[r]}function g(e,t,r){var o=c(t,r),i=o.initialize(),u=a(i.contentWindow,r,(function(e){return e.data}),(function(e){return"loaded"===e}));return e&&(i.id="ms-searchux-3s-proxy",i.postMessage=o.postMessage,i.ready=u),Object(n.a)(Object(n.a)({},o),{ready:u})}var O=function(e,t,r){return void 0===t&&(t="https://substrate.office.com"),void 0===r&&(r=!1),t=Object(d.c)(t),p[t]?j(e,t,r):m(t,r).then((function(t){return t(e)}))};function j(e,t,r){var n=Object(o.a)(),c=e.action,i=e.token,a=e.prefix,u=e.cvid,s=e.additionalInfo,f=e.headers;return v(t,r).postMessage(JSON.stringify({requestId:n,action:c,token:i,prefix:a,cvid:u,additionalInfo:s,headers:f}),y,(function(e){return e.requestId===n}))}function S(e){var t=JSON.parse(e)[0];t.name;return Object(n.d)(t,["name"])}function y(e){try{return JSON.parse(e.data)}catch(e){return Object(f.throwSafeToLogError)("Failed to parse substrate API JSON response.")}}},KUM7:function(e,t,r){"use strict";function n(e){return e}function o(e,t){return t}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}))},KzqD:function(e,t,r){"use strict";r.r(t);var n=r("+zb2"),o=r("W4Bk"),c=r("/hiP"),i=r("3WoE"),a=r("JCJM");function u(e){return e.getResponseHeader?{correlationID:e.getResponseHeader("request-id")||"",properties:JSON.stringify({serverLatency:e.getResponseHeader("x-end2endlatencyms")||"",diagnosticsDuration:e.getResponseHeader("Substrate-DiagnosticsDuration")||""})}:{}}t.default=Object(c.a)((function(e){return function(t){var r=t.queryStringParameters,c=t.headers,u=t.postAction,s=void 0===u?"init":u,f=t.cvid,d=t.makeSubstrateRequest,l=t.substrateUrl,h=t.useNoBearerAuth,p=r?Object(n.a)({},r):{},m={action:s,token:e,prefix:void 0,cvid:f||Object(o.a)(),additionalInfo:Object(n.a)(Object(n.a)({},p),{diagnostics:"1"}),headers:c};return(d?d(Object(n.a)(Object(n.a)({},m),{useNoBearerAuth:h})):Object(a.sendSubstrateRequest)(m,l)).then((function(e){var t={};try{t=JSON.parse(e.responseHeaders)}catch(e){}if(e.diagnostics)try{var r=Object(a.parseDiagnostics)(e.diagnostics);r&&r.duration&&(t["Substrate-DiagnosticsDuration"]=""+r.duration)}catch(e){}var n={status:e.statusCode,responseText:e.qfResponse,getResponseHeader:function(e){return t[e]}};if(!Object(i.default)(e.statusCode))throw n;return n}))}}),{monitorName:"warmupSubstrateSearch",cacheId:"warmupSubstrateSearch",cacheVersion:"0",cacheItemLifetime:5e3,additionalSuccessPropsExtractor:u,additionalFailurePropsExtractor:u,cacheKeyExtractor:function(e){e.token,e.makeSubstrateRequest,e.cvid;var t=Object(n.d)(e,["token","makeSubstrateRequest","cvid"]);return Object(n.a)({},t)}})},LLyz:function(e,t,r){"use strict";function n(e,t,r){var n;return t&&t.safeToLog?(n=new Error("".concat(e," ").concat(t.message))).innerError=t:n=new Error(e),n.safeToLog=!0,n.logProperties=r,Object.freeze(n),n}function o(e,t,r){throw n(e,t,r)}r.r(t),r.d(t,"default",(function(){return n})),r.d(t,"throwSafeToLogError",(function(){return o}))},MkXD:function(e,t,r){"use strict";r.r(t);var n=r("+zb2"),o=r("DHVw"),c=r("k6ph"),i=r("x2tm"),a=["https://substrate.office.com","https://loki.delve.office.com","https://thor.aesir.office.com","https://www.bing.com","https://partner.outlook.cn/search","https://outlook.office365.com/search","https://outlook.office365.us/search"];t.default=Object(i.a)({monitorName:"prefetchAcquireToken",additionalSuccessPropsExtractor:function(e){var t=e&&e.responseText&&JSON.parse(e.responseText);return Object(n.a)({},t&&{resource:u(t.resource)?t.resource:"",expires_on:t.expires_on})},additionalFailurePropsExtractor:function(e){var t,r,n;try{n=e&&e.responseText&&JSON.parse(e.responseText)}catch(e){}var o=null===(t=null==n?void 0:n.error)||void 0===t?void 0:t.code;return{resource:null===(r=null==e?void 0:e.requestLogData)||void 0===r?void 0:r.resource,properties:JSON.stringify({responseErrorCode:isNaN(o)?"0":o})}}},Object(c.a)((function(e){var t=e.digest,r=e.portalUrl,c=e.resourceUrl,i={resource:c};return e.useSTI&&(i.tokenType="STI"),Object(o.a)(Object(n.a)({url:"".concat(r,"/_api/SP.OAuth.Token/Acquire"),method:"POST",headers:{"Content-Type":"application/json; charset=utf-8","Odata-Version":"4.0",Accept:"application/json;odata.metadata=minimal","X-RequestDigest":t},body:JSON.stringify(i),timeoutMs:7e3},u(c)&&{requestLogData:{resource:c}})).then((function(e){return{xhr:e,tokenAttemptCount:-1,tokenFetchDuration:-1,cacheItemType:null}}))}))({cacheId:"psst",cacheVersion:"0",cacheItemLifetime:3e5,cacheKeyExtractor:function(e){return{resource:e.resourceUrl}}}));var u=function(e){return-1!==a.indexOf(e)}},NShO:function(e,t,r){"use strict";r.d(t,"g",(function(){return l})),r.d(t,"e",(function(){return h})),r.d(t,"f",(function(){return p})),r.d(t,"a",(function(){return m})),r.d(t,"c",(function(){return v})),r.d(t,"d",(function(){return b})),r.d(t,"b",(function(){return g}));var n,o=r("+zb2"),c=r("KUM7");function i(e){switch(e){case"Df":return n.Dogfood;case"Msit":return n.MSIT;case"Blackforest":return n.Blackforest;case"GccModerate":return n.GccModerate;case"GccHigh":return n.GccHigh;case"DoD":return n.DOD;case"Gallatin":return n.Gallatin;case"Prod":return n.TopLevel;case"AG08":return n.AG08;case"AG09":return n.AG09;case"Unknown":throw new Error("'Unknown' is not an expected environment type in Loki");default:return Object(c.a)(e)}}!function(e){e.TopLevel="https://loki.delve.office.com",e.Blackforest="https://loki.delve.office.de",e.GccModerate="https://gcc.loki.delve.office.com",e.GccHigh="https://gcchigh.loki.office365.us",e.DOD="https://dod.loki.office365.us",e.Gallatin="https://loki.office365.cn",e.Dogfood="https://df.loki.delve.office.com",e.MSIT="https://msit.loki.delve.office.com",e.AG08="https://loki.officenet.eaglex.ic.gov",e.AG09="https://loki.officenet.microsoft.scloud"}(n||(n={}));r("OZIB");var a=r("sUnP"),u=r("msSD"),s=r("qBZW"),f=r("xn41"),d=function(e){return"".concat(Object(s.b)(e),"/api/v1/topic/getTopicById")};function l(e,t,r){void 0===t&&(t="");var n=function(e,t){var r=i(e);return r===e&&(r=i("Prod")),t(r)}(e,r);return"".concat(n).concat(t?"/".concat(t):"")}function h(e,t){return void 0===t&&(t=""),l(e,t,s.a)}function p(e,t){return void 0===t&&(t=""),l(e,t,d)}function m(e,t,r){var n;return Object(o.a)(Object(o.a)(Object(o.a)({},t),((n={"X-MSSearchVersion":f.a,"X-ClientFeature":"Search"})["X-ClientType"]=e,n)),r?{Authorization:"Bearer ".concat(r)}:{})}function v(e){return"".concat(Object(s.b)(e)||"","/api/v1/search/configuration/verticals")}function b(e,t){void 0===t&&(t=!1);var r={};return e&&(r.siteCollectionId=e.toUpperCase()),t&&(r.verticalState="all"),Object(a.getQueryStringValue)("ecsOverrides")&&(r.ecsOverrides=Object(a.getQueryStringValue)("ecsOverrides")),r}function g(){var e;return"true"===Object(a.getQueryStringValue)("cacheClear")?((e={})[u.a.VerticalsCacheClear]="uncached",e):{}}},OMji:function(e,t,r){"use strict";r.r(t);var n=r("+zb2"),o=r("DHVw"),c=r("/hiP");t.default=Object(c.a)((function(e){return function(t){var r=t.endpoint,c=t.clientId;return Object(o.a)({url:"".concat(r,"?querytext='*'&ClientType='").concat(c,"'")+"&Properties='ClientFunction:PersonalRelevanceContext,FetchPersonalRelevanceContext:true'&EnableQueryRules=false&ProcessBestBets=false&BypassResultTypes=true&ProcessPersonalFavorites=false&SourceId='8413cd39-2156-4e00-b54d-11efd9abdb89'&suxrid=ms-oil-datasource-spopersonalcontext",method:"GET",headers:Object(n.a)({Accept:"application/json;odata=verbose"},e?{Authorization:"Bearer ".concat(e)}:{}),timeoutMs:7e3})}}),{monitorName:"prefetchPersonalRelevance",cacheId:"prctx",cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(){return{}}})},OZIB:function(e,t,r){"use strict";function n(e){switch(e){case"SPHomeWeb":return"SPHome";case"TeamSiteSearch":case"CommSiteSearch":case"HubSiteSearch":case"MSW":return"ODSP";case"officehome":case"officehomemsa":case"officehomeuwp":return"OfficeDotCom";case"DelveWeb":return"DelveWeb";case"TeamsSearch":case"Teams.RoomsNearby":case"teams":return"MicrosoftTeams";case"BingForBusinessWeb":case"msb.ux.webserp":case"msb.ux.workserp":case"Wsb.MiniSerp":case"Wsb.PreviewPane":return"Bing";case"wsb.ux.workserp":return"WsbBingVertical";case"Owa.react":case"Outlook.ios":case"Outlook.android":case"OutlookOPX":return"OwaMail";default:return}}r.d(t,"a",(function(){return n}))},PWcX:function(e,t,r){"use strict";r.r(t);var n=r("DHVw"),o=r("k6ph"),c=r("x2tm");t.default=function(e){return Object(c.a)({monitorName:"tell-me-search-service-prefetch"},Object(o.a)((function(t){var r=t.url;return Object(n.a)({url:r,method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Office-Application":e.application,"X-Office-Platform":"Web","X-TellMe-SuggestionTypes":e.searchTypes.join(),"X-TellMe-Culture":e.marketValue},body:JSON.stringify({Query:e.searchText,TemplateInfo:{Application:e.templateTypes.join(),MaxTemplate:e.numberOfResultsToFetch}})}).then((function(e){return{xhr:e,tokenAttemptCount:-1,tokenFetchDuration:-1}}))}))({cacheId:"tell-me-search-service-prefetch",cacheVersion:"0",cacheItemLifetime:18e5,cacheKeyExtractor:function(e){return{query:e.searchText}}}))(e)}},SGCm:function(e,t,r){"use strict";r.r(t),r.d(t,"resolveLokiEnvironment",(function(){return o}));var n=r("KUM7");function o(e){switch(e){case"o365test":case"onebox":case"edog":case"spdf":case"test":return"Df";case"prodbubble":return"Msit";case"":case"prod":return"Prod";case"blackforest":return"Blackforest";case"gallatin":return"Gallatin";case"pathfinder":return"DoD";case"trailblazer":return"GccHigh";case"gcc":return"GccModerate";case"ag08":return"AG08";case"ag09":return"AG09";default:return Object(n.b)(e,"Prod")}}},TCme:function(e,t,r){"use strict";r.r(t),r.d(t,"resolveSubstrateUrl",(function(){return o}));var n=r("KUM7");function o(e,t){if(null==t?void 0:t.Substrate)return t.Substrate;var r=e;switch(r){case"GccHigh":return"https://substrate.office365.us";case"DoD":return"https://substrate-dod.office365.us";case"Gallatin":return"https://partner.outlook.cn";case"Df":case"Msit":case"Prod":case"GccModerate":case"Unknown":return"https://substrate.office.com";default:return Object(n.b)(r,"https://substrate.office.com")}}},TG2i:function(e,t,r){"use strict";r.r(t),r.d(t,"cacheId",(function(){return i}));var n=r("+zb2"),o=r("DHVw"),c=r("/hiP"),i="spohubsitesinfo";t.default=Object(c.a)((function(e){return function(t){var r=t.clientId,c=t.endpoint;return Object(o.a)({url:"".concat(c,"/_api/search/query?querytext='IsHubSite=1%20contentclass:STS_Site'")+"&selectproperties='DepartmentId,Title'&rowlimit=1000&ClientType='".concat(r,"'")+"&Properties='ClientFunction:SpoHubSitesInfo,FetchSpoHubSitesInfo:true,EnableDynamicGroups:true'&EnableQueryRules=false&ProcessBestBets=false&BypassResultTypes=true&ProcessPersonalFavorites=false&SourceId='8413cd39-2156-4e00-b54d-11efd9abdb89'&suxrid=spohubsitesinfo",method:"GET",headers:Object(n.a)({Accept:"application/json;odata=verbose"},e?{Authorization:"Bearer ".concat(e)}:{}),timeoutMs:5e3})}}),{monitorName:"prefetchSpoHubSitesInfo",cacheId:i,cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(e){return{endpoint:e.endpoint}}})},W4Bk:function(e,t,r){"use strict";function n(){return"object"==typeof window&&window.crypto&&(e=new Uint8Array(31),window.crypto.getRandomValues(e),e)||function(){for(var e=new Array(31),t=0;t<31;t++)e[t]=Math.floor(16*Math.random());return e}();var e}r.d(t,"a",(function(){return o}));function o(){for(var e=n(),t=0,r="",o=0;o<36;o++)switch(o){case 8:case 13:case 18:case 23:t+=1,r+="-";break;case 14:t+=1,r+="4";break;case 19:r+=(e[o-t]%4+8).toString(16);break;default:r+=(e[o-t]%16).toString(16)}return r}},WMEh:function(e,t,r){"use strict";function n(e){return function(t){var r=t.prefetchTimeSinceOrigin||performance.now.bind(performance),n=r();return c(0,n,t,e,r).catch((function(i){return o(i)?c(1,n,t,e,r).catch((function(e){return function(e,t,r){if(o(e)){var n=e;throw n.tokenAttemptCount=t,n.tokenFetchDuration=r,n}throw e}(e,2,r()-n)})):Promise.reject(i)}))}}function o(e){return!!e&&(401===e.status||0===e.status)}function c(e,t,r,n,o){if(!("token"in r)&&!("tokenProvider"in r))return Promise.reject(new Error("Token or token provider must be specified."));var c=-1;return"token"in r&&function(e){return!!e.token}(r)?n(r.token)(r).then((function(e){return{tokenAttemptCount:0,tokenFetchDuration:0,xhr:e}})):r.tokenProvider({attempt:e}).then((function(e){return c=o()-t,n(e)(r)})).then((function(t){return{tokenAttemptCount:e+1,tokenFetchDuration:c,xhr:t}}))}r.d(t,"a",(function(){return n}))},Y3nR:function(e,t,r){"use strict";r.r(t);var n=r("DHVw"),o=r("k6ph"),c=r("x2tm");t.default=function(e){var t=e.endpoint,r=e.forceDigestRefresh;return Object(c.a)({monitorName:"prefetchSharepointDigest"},Object(o.a)((function(e){var t=e.endpoint;return Object(n.a)({url:"".concat(t,"/_api/contextinfo"),method:"POST",headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},timeoutMs:5e3}).then((function(e){return{xhr:e,tokenAttemptCount:-1,tokenFetchDuration:-1}}))}))({cacheId:"pspd",cacheVersion:"0",cacheItemLifetime:179e4,cacheKeyExtractor:function(e){return{url:"".concat(e.endpoint,"/_api/contextinfo")}},forceRefresh:r}))({endpoint:t,forceDigestRefresh:r})}},ZHTy:function(e,t,r){"use strict";r.r(t),r.d(t,"getSearchConfigScope",(function(){return f})),r.d(t,"getSearchConfigPromise",(function(){return d})),r.d(t,"getSearchConfigPromiseEntity",(function(){return l})),r.d(t,"createSearchConfigPromiseEntity",(function(){return h})),r.d(t,"default",(function(){return p}));var n,o=r("+zb2"),c=r("6VTQ"),i=r("LLyz"),a=r("e+qm"),u=r("zLON"),s=r("NShO");function f(){return n&&n.option&&n.option.siteId||""}function d(){return n||h(),n?n.promiseObj:Promise.resolve([])}function l(){return n||h(),n}function h(e){if(!n||!n.isPending||n.isRejected){n={};var t=new Promise((function(e,t){n.promiseResolver=function(t){n.isPending=!1,e(t)},n.promiseRejector=function(){n.isRejected=!0,n.isPending=!1,t()}}));n.promiseObj=t,n.isRejected=!1,t.catch((function(){}))}n.isPending=!0,e&&(n.option=e)}function p(e){var t,r,d=f();if(n&&(!e.scope&&!d||(null===(r=null===(t=e.scope)||void 0===t?void 0:t.siteId)||void 0===r?void 0:r.toUpperCase())===d.toUpperCase())&&!n.isRejected){var l=n.option;return h(l),Object(u.a)(l).then((function(e){var t,r,o=e.xhr;if(o.responseText){var c=JSON.parse(o.responseText).verticalConfig;null===(t=n.promiseResolver)||void 0===t||t.call(n,c)}else null===(r=n.promiseRejector)||void 0===r||r.call(n)})).catch((function(e){var t;console.error(e),null===(t=n.promiseRejector)||void 0===t||t.call(n,e),Object(i.throwSafeToLogError)("CUSTOM_VERTICAL_FETCH_FAILED")})),n.promiseObj}var p,m=n.option,v=m.environment,b=m.culture,g=m.useThor,O=m.thorTokenProvider,j=e.url;v&&(p=Object(c.a)({complianceEnvironment:v})),("Df"===v||"Msit"===v&&-1!==(null==j?void 0:j.toLowerCase().indexOf("df")))&&(j=Object(s.g)(v,b,(function(e){return e})));var S=g?p:j;return g&&O&&(e=Object(o.a)(Object(o.a)({},e),{tokenProvider:O})),S?Object(a.a)(Object(o.a)(Object(o.a)({},e),{url:S})).then((function(e){var t=e.xhr;return t.responseText?JSON.parse(t.responseText):[]})).catch((function(e){console.error(e),Object(i.throwSafeToLogError)("CUSTOM_VERTICAL_FETCH_FAILED")})):(Object(i.throwSafeToLogError)("NO_SUITABLE_FETCH_URL_FOUND"),Promise.reject(new Error("NO_SUITABLE_FETCH_URL_FOUND")))}},cLGF:function(e,t,r){"use strict";function n(e){return e?e.filter((function(e){return e.indexOf("31828")>-1})).join()||e.join():void 0}r.d(t,"a",(function(){return n}))},"e+qm":function(e,t,r){"use strict";var n=r("+zb2"),o=r("sUnP"),c=r("DHVw"),i=r("/hiP"),a=r("NShO");t.a=Object(i.a)((function(e){return function(t){var r=t.url,i=t.clientType,u=t.scope,s=t.previewDisabledVerticals,f=t.useSimpleRequest,d=void 0!==f&&f,l=Object(a.a)(i,Object(a.b)(),e),h=u&&u.siteId?u.siteId:"";return d?Object(c.a)({url:Object(o.constructUrl)(Object(a.c)(r),Object(n.a)(Object(n.a)({},Object(a.d)(h,s)),{ConvertGetPost:"true"})),method:"POST",body:JSON.stringify(l)}):Object(c.a)({url:Object(o.constructUrl)(Object(a.c)(r),Object(a.d)(h,s)),method:"GET",headers:l})}}),{monitorName:"customVerticals",cacheId:"customVerticals",cacheVersion:"0",cacheItemLifetime:3e5,cacheKeyExtractor:function(e){return{url:e.url,showDisabled:e.previewDisabledVerticals,clientType:e.clientType,scope:e.scope&&e.scope.siteId&&e.scope.siteId.toUpperCase()||null}},additionalSuccessPropsExtractor:function(e){return{cacheClear:Object(o.getQueryStringValue)("cacheClear"),resource:e.responseURL||"",correlationId:e.getResponseHeader&&e.getResponseHeader("X-CorrelationId")||""}},additionalFailurePropsExtractor:function(e){return{correlationId:e.getResponseHeader("X-CorrelationId")||""}},forceRefresh:function(){return"true"===Object(o.getQueryStringValue)("cacheClear")}})},g1R2:function(e,t,r){"use strict";r.r(t),r.d(t,"toTokenDetail",(function(){return o})),r.d(t,"isApproachingExpiration",(function(){return c})),r.d(t,"isValid",(function(){return i}));function n(e){var t=(e=e.trim()).length;t%4==0&&(t=(e=e.replace(/==?$/,"")).length),(t%4==1||/[^\-_a-zA-Z0-9]/.test(e))&&function(e){throw new Error(e).name="InvalidCharacterError",new Error(e)}("Invalid character: the string to be decoded is not correctly encoded.");for(var r,n=0,o=0,c="",i=-1;++i<t;)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".indexOf(e.charAt(i)),o=n%4?64*o+r:r,n++%4&&(c+=String.fromCharCode(255&o>>(-2*n&6)));return c}function o(e){if("object"==typeof e)return{token:e.token,expEpoch:1e3*e.expiry};var t=Number.MAX_VALUE,r=e&&e.split(".");if(r&&3===r.length){var o=JSON.parse(n(r[1]));o&&o.exp&&(t=1e3*o.exp)}return{token:e,expEpoch:t}}function c(e){if(!i(e))return!1;return Date.now()>e.expEpoch-24e4}function i(e){return!!e&&!(e.expEpoch-Date.now()<12e4)}},jt5z:function(e,t,r){"use strict";r.r(t),r.d(t,"cacheTime",(function(){return u}));var n=r("+zb2"),o=r("sUnP"),c=r("DHVw"),i=r("/hiP"),a=r("NShO"),u=6e4;t.default=Object(i.a)((function(e){return function(t){var r=t.clientType,i=t.environment,u=t.culture,s=t.additionalHeaders,f=t.topicId,d=Object(a.a)(r,Object(n.a)(Object(n.a)({},s),Object(a.b)()),e);return Object(c.a)({url:Object(o.constructUrl)(Object(a.f)(i,u),{topicId:f||"",useTest:"false",enableRelatedTopics:"true",use403Cache:"false",useNetCoreEndpoint:"false"}),method:"GET",headers:d})}}),{monitorName:"topicData",cacheId:"topicData",cacheVersion:"0",cacheItemLifetime:u,cacheKeyExtractor:function(e){return{topicId:e.topicId}}})},k6ph:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n,o,c=r("+zb2"),i=r("DEsW"),a=r("3UHF"),u=!1,s=!1;function f(e,t,r,n){var o;h(r);var c=d(n);try{var a=c.getItem(e);if(!a)return null;o=JSON.parse(a)}catch(e){return!u&&Object(i.getDispatcher)().dispatch({eventType:"ERROR",name:"StorageCache",detail:"Failed to read from storage."}),u=!0,null}return o?o.cacheVersion!==t?(c.removeItem(e),null):o.puid&&o.puid===r?o:(c.removeItem(e),!!0&&Object(i.getDispatcher)().dispatch({eventType:"ERROR",name:"StorageCache",detail:"Invalid puid detected."}),null):null}var d=function(e){return e?(n||(n={getItem:function(e){return localStorage.getItem(l(e))},removeItem:function(e){return localStorage.removeItem(l(e))},setItem:function(e,t){localStorage.setItem(l(e),t)}}),n):(o||(o={getItem:function(e){return sessionStorage.getItem(l(e))},removeItem:function(e){return sessionStorage.removeItem(l(e))},setItem:function(e,t){sessionStorage.setItem(l(e),t)}}),o)};function l(e){return"mssearchux-cache-".concat(e)}function h(e){!e&&Object(a.a)("Puid not set.")}function p(e,t,r,n){var o=f(e,t,r,n);if(!o)return null;var c=o.cacheItems;return Object.keys(c).reduce((function(e,t){return e[t]={value:Promise.resolve({xhr:{responseText:c[t].value,status:c[t].status||0}}),expiryTime:c[t].expiryTime,cacheItemType:"storage",cacheItemResolved:!0},e}),{})}function m(e,t){return e.cacheItems[t]=null}function v(e,t,r,n,o){var a=t.cacheId,u=t.cacheVersion,l=t.cacheItemLifetime,p=t.useCachePersistentStorage;h(r);var v=e.cacheItems,g=b(v,o,{value:n,expiryTime:Date.now()+l,cacheItemType:"memory",cacheItemResolved:!1});return n.then((function(e){return b(v,o,Object(c.a)(Object(c.a)({},g),{cacheItemResolved:!0})),function(e,t,r,n,o,c,a,u){h(r);var l=f(e,t,r,u)||{cacheCreationTime:Date.now(),cacheVersion:t,puid:r,cacheItems:{}};l.cacheItems[n]={value:o,expiryTime:c,status:a};try{d(u).setItem(e,JSON.stringify(l))}catch(t){!s&&Object(i.getDispatcher)().dispatch({eventType:"ERROR",name:"StorageCache",nameDetail:e,detail:"Failed to write to session storage."}),s=!0}}(a,u,r,o,e.xhr.responseText,g.expiryTime,e.xhr.status,p),Object(c.a)(Object(c.a)({},e),{cacheItemResolved:!1,cacheItemType:null,expiryTime:g.expiryTime})}),(function(t){throw m(e,o),t}))}var b=function(e,t,r){return e[t]=r};function g(e,t){var r=t.cacheId,n=t.cacheVersion,o=t.cacheItemLifetime,i=t.userInfoPuid,a=t.useCachePersistentStorage;return{operation:function(t,u,s){var f=function(e,t,r,n,o){h(n);var c=e[t];return c&&c.puid!==n&&(c=null),c||(e[t]={puid:n,cacheItems:p(t,r,n,o)||{}})}(e,r,n,i,a);return"setItem"!==t&&function(e,t){var r=e.cacheItems[t];if(r){if(Date.now()<r.expiryTime)return r.value.then((function(e){return Object(c.a)(Object(c.a)({},e),{cacheItemType:r.cacheItemType,cacheItemResolved:r.cacheItemResolved,expiryTime:r.expiryTime})}));m(e,t)}return null}(f,u)||v(f,{cacheId:r,cacheVersion:n,cacheItemLifetime:o,useCachePersistentStorage:a},i,s(),u)}}}function O(e){return"object"==typeof e&&null!==e}var j=r("DeF7"),S=r("xn41");function y(e){return function(t){var r=t.cacheId,n=t.cacheVersion,o=t.cacheItemLifetime,c=t.cacheKeyExtractor,i=t.forceRefresh,a=t.useCachePersistentStorage;return function(t){var u=t.prefetchCacheCollection||x,s=function(e){if(!O(e))throw new Error("Key argument must be an object.");for(var t=Object.keys(e).sort(),r=t.length,n=[],o=0;o<r;o++){var c=t[o],i=e[c];void 0===i||O(i)||"function"==typeof i||n.push(c+":"+i)}return n.join(",")}(c(function(e){return Object.keys(e).reduce((function(t,r){return r.length>"prefetch".length&&0===r.indexOf("prefetch")||(t[r]=e[r]),t}),{})}(t))||{}),f=(null==i?void 0:i(t))?"setItem":"getItem";return u.bind({cacheConsumer:C,cacheId:r,cacheVersion:n,cacheItemLifetime:o,userInfoPuid:t.prefetchUserInfoPuid||Object(j.puid)(),useCachePersistentStorage:a}).operation(f,s,(function(){return e(t)}))}}}var C={packageName:"@1js/search-prefetch",packageVersion:S.a},x={bind:function(e){return g(Object(j.cache)().caches,e)}}},msSD:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e.SearchComponent="X-MSSearchComponent",e.SearchScenario="X-MSSearchScenario",e.VerticalsCacheClear="X-Cache-Mode"}(n||(n={}))},n8Nd:function(e,t,r){"use strict";r.r(t);var n=r("DHVw"),o=r("k6ph"),c=r("x2tm");t.default=function(e){return Object(c.a)({monitorName:"bing-consumer-prefetch"},Object(o.a)((function(e){var t=e.url;return Object(n.a)({url:t,method:"GET",withCredentials:!0}).then((function(e){return{xhr:e,tokenAttemptCount:-1,tokenFetchDuration:-1}}))}))({cacheId:"bing-consumer-prefetch",cacheVersion:"0",cacheItemLifetime:18e5,cacheKeyExtractor:function(e){return{query:e.searchText}}}))(e)}},qBZW:function(e,t,r){"use strict";function n(e){return function(e){return!!e&&(0===e.toLocaleLowerCase().indexOf("http://")||0===e.toLocaleLowerCase().indexOf("https://"))}(e)?e:"https://".concat(e)}r.d(t,"c",(function(){return n})),r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return c}));var o=function(e){return"string"==typeof e?e.replace(/\/+$/,""):e},c=function(e){return"".concat(o(e),"/api/v1/search/configuration")}},sUnP:function(e,t,r){"use strict";function n(e){var t=self&&self.location&&(self.location.search||self.location.hash)||"";return decodeURIComponent(t.replace(new RegExp("^(?:.*[&\\?]"+encodeURIComponent(e).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))}function o(e,t){var r=e,n=Object.keys(t);return n.length&&(r+="?",r+=n.map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])})).join("&")),r}r.r(t),r.d(t,"getQueryStringValue",(function(){return n})),r.d(t,"constructUrl",(function(){return o}))},vskH:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));function n(e){var t={},r={};for(var n in e)if(e.hasOwnProperty(n))if(0===n.indexOf("searchux.killSwitches.")){var o=n.slice("searchux.killSwitches.".length),c=Boolean(e[n]);r[o]=c}else t[n]=e[n];return t["searchux.killSwitches"]=r,t}},x2tm:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("+zb2"),o=r("+XOu"),c=r("uKfc");function i(e,t){var r=e.monitorName,o=e.monitorType,i=void 0===o?"prefetch_request":o,u=e.additionalSuccessPropsExtractor,s=e.additionalFailurePropsExtractor;return Object(c.a)({monitorName:r,monitorType:i,successPropExtractor:function(e){var t=e.xhr,r=e.tokenAttemptCount,o=e.tokenFetchDuration,c=e.cacheItemResolved,i=e.cacheItemType;return Object(n.a)(Object(n.a)(Object(n.a)(Object(n.a)({},a(t)),r?{tokenAttemptCount:r,tokenFetchDuration:Math.round(o)}:{}),{cacheItemResolved:c,cacheItemType:i}),null==u?void 0:u(t))},failurePropExtractor:function(e){var t;return Object(n.a)(Object(n.a)(Object(n.a)({},null==s?void 0:s(e)),a(e)),{errorCode:null===(t=e.status)||void 0===t?void 0:t.toString()})}},(function(e){return void 0===e?Promise.reject("undefined options"):t(e)}))}function a(e){if(!e||!e.getAllResponseHeaders)return{};var t=Object(o.getNamedHeadersFromXhr)(e,[o.spRequestDurationHeader,o.spClientServiceRequestDurationHeader,o.sharePointCorrelationHeader]),r={};return r[o.sharePointCorrelationHeader]=t[o.sharePointCorrelationHeader],r[o.spRequestDurationHeader]=t[o.spRequestDurationHeader]||t[o.spClientServiceRequestDurationHeader]||void 0,r}},xn41:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n="1.20230814.3.0"},zLON:function(e,t,r){"use strict";var n=r("+zb2"),o=r("sUnP"),c=r("CZty"),i=r("DHVw"),a=r("/hiP"),u=r("NShO"),s=r("6VTQ"),f=r("qBZW");function d(e,t,r){void 0===t&&(t="");var n=function(e,t){var r=Object(s.a)({complianceEnvironment:e});return r===e&&(r=Object(s.a)({complianceEnvironment:"Prod"})),t(r)}(e,r);return"".concat(n).concat(t?"/".concat(t):"")}function l(e,t,r){for(var o,c,i,a,u=[],f=3;f<arguments.length;f++)u[f-3]=arguments[f];var d=e.thorUrl||Object(s.a)({complianceEnvironment:e.complianceEnvironment||"Prod"}),l=new URL("".concat(d).concat(t));try{for(var h=Object(n.e)(u),p=h.next();!p.done;p=h.next()){void 0!==(b=r[g=p.value])&&l.searchParams.append(String(g),String(b))}}catch(e){o={error:e}}finally{try{p&&!p.done&&(c=h.return)&&c.call(h)}finally{if(o)throw o.error}}if(e.urlParams)try{for(var m=Object(n.e)(Object.keys(e.urlParams)),v=m.next();!v.done;v=m.next()){var b,g=v.value;null!=(b=e.urlParams[g])&&l.searchParams.append(g,b)}}catch(e){i={error:e}}finally{try{v&&!v.done&&(a=m.return)&&a.call(m)}finally{if(i)throw i.error}}return l}function h(e,t,r,o,c){var i,a,u={};try{for(var s=Object(n.e)(Object.keys(r)),f=s.next();!f.done;f=s.next()){var d=f.value,l=r[d];void 0!==l&&(u[d]=l)}}catch(e){i={error:e}}finally{try{f&&!f.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}return e.useSimpleRequest&&"GET"===o?(t.searchParams.append("ConvertGetPost","true"),new Request(t,{method:"POST",body:JSON.stringify(r)})):e.useSimpleRequest&&"POST"===o?(t.searchParams.append("ConvertSimpleRequest","POST"),new Request(t,{method:"POST",body:JSON.stringify(Object(n.a)(Object(n.a)({},c),{__request_headers:r}))})):new Request(t,{method:o,headers:u,body:JSON.stringify(c)})}function p(e){for(var t,r,o=[],c=1;c<arguments.length;c++)o[c-1]=arguments[c];try{for(var i=Object(n.e)(o),a=i.next();!a.done;a=i.next()){var u=a.value,s=e[u];if(void 0===s)throw new Error("Missing required parameter: ".concat(String(u)))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}}function m(e,t){return"void"===t?e.text().then((function(){})):"blob"===t?e.blob():e.json()}var v=function(e){return function(t){p(t.body);var r=l(e,"/api/v1/search/configuration",t.body,"spRootUrl","siteCollectionId","verticalState","ecsOverrides"),o=Object(n.a)(Object(n.a)({Accept:"text/plain, application/json, text/json"},{"X-Cache-Mode":t.headers.xCacheMode,Authorization:t.headers.authorization,"X-ClientCorrelationId":t.headers.xClientCorrelationId,"X-ClientType":t.headers.xClientType,"X-RootCorrelationId":t.headers.xRootCorrelationId,"X-ClientFeature":t.headers.xClientFeature,"X-ClientScenario":t.headers.xClientScenario,"X-HostAppPlatform":t.headers.xHostAppPlatform,"X-MSSearchComponent":t.headers.xMsSearchComponent,"X-MSSearchScenario":t.headers.xMsSearchScenario,"X-MSSearchVersion":t.headers.xMsSearchVersion}),t.additionalHeaders),c=h(e,r,o,"GET",void 0),i=e.fetch;return e.shouldReturnRawResponse?i(c):i(c).then((function(e){return m(e,"MicrosoftThorServiceProviderSearchConfigurationSearchConfiguration")}))}};var b=r("CVAo");t.a=Object(a.a)((function(e){return function(t){var r=t.clientType,c=t.environment,a=t.culture,s=t.additionalHeaders,l=t.siteId,h=void 0===l?"":l,p=t.useSimpleRequest,m=void 0!==p&&p,g=t.useThor,O=void 0!==g&&g,j=Object(u.a)(r,Object(n.a)(Object(n.a)(Object(n.a)({},s),Object(u.b)()),{"X-ClientCorrelationId":Object(b.a)()}),e),S=O?function(e,t){return void 0===t&&(t=""),d(e,t,f.a)}(c,a):Object(u.e)(c,a);return O?v({complianceEnvironment:c,token:e,fetch:fetch,useSimpleRequest:m})({body:Object(n.a)({},Object(u.d)(h,!1)),headers:{authorization:"Bearer ".concat(e),xClientType:j["X-ClientType"],xClientFeature:"Search"},additionalHeaders:Object(n.a)({},j)}).then((function(e){return{responseText:JSON.stringify(e)}})):m?Object(i.a)({url:Object(o.constructUrl)(S,Object(n.a)(Object(n.a)({},Object(u.d)(h,!1)),{ConvertGetPost:"true"})),method:"POST",body:JSON.stringify(j)}):Object(i.a)({url:Object(o.constructUrl)(S,Object(u.d)(h,!1)),method:"GET",headers:j})}}),{monitorName:"searchConfiguration",cacheId:"searchConfiguration",cacheVersion:"0",cacheItemLifetime:6e5,cacheKeyExtractor:function(e){e.token;var t=Object(n.d)(e,["token"]),r=t.additionalHeaders&&t.additionalHeaders["X-MSSearchScenario"]||"";return delete t.cacheClear,Object(n.a)(Object(n.a)({},t),{msSearchScenario:r})},additionalSuccessPropsExtractor:function(e){return Object(n.a)(Object(n.a)({},Object(c.c)(e.responseText)),{resource:e.responseURL||"",correlationId:e.getResponseHeader&&e.getResponseHeader("X-CorrelationId")||""})},additionalFailurePropsExtractor:function(e){return{correlationId:e.getResponseHeader("X-CorrelationId")||""}},forceRefresh:function(e){return(null==e?void 0:e.cacheClear)||!1}})}}]);