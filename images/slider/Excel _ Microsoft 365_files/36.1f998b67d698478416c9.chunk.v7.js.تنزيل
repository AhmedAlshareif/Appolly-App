(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[36],{"/5so":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("QjXU"),r=n("mgFK");function a(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return t.isMsa?[4,Object(r.a)("consumerInstallInfo",e)]:[2,null];case 1:return[2,n.sent()||null]}}))}))}},"6MXh":function(e,t,n){"use strict";function i(e,t,n,i,r,a,o,u){if(void 0===i&&(i=!1),void 0===a&&(a=!1),void 0===o&&(o=!1),void 0===u&&(u=!1),!document)return null;if(r){var c=document.getElementById(r);if(null!=c)return t&&t(),c}var l=document.createElement("script");if(l.src=e,r&&(l.id=r),t&&(l.onload=t),n&&(l.onerror=function(){var e;n(),o&&(null===(e=l.parentNode)||void 0===e||e.removeChild(l))}),a&&(l.crossOrigin="anonymous"),u&&(l.async=!0),i){var d=document.getElementsByTagName("script")[0];if(d&&d.parentNode)return d.parentNode.insertBefore(l,d)}return document.body.appendChild(l)}n.d(t,"a",(function(){return i}))},CDFH:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("QjXU"),r=n("mgFK");function a(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return t.isMsa?[4,Object(r.a)("workloadPublicData",e)]:[2,null];case 1:return[2,n.sent()||null]}}))}))}},"D/tM":function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.O365Home=0]="O365Home",e[e.O365Personal=1]="O365Personal",e[e.O365Solo=2]="O365Solo",e[e.OtherSubscription=3]="OtherSubscription",e[e.Perpetual=4]="Perpetual",e[e.Perpetual2019=5]="Perpetual2019",e[e.O365HomeTrial=6]="O365HomeTrial",e[e.NonActive=7]="NonActive",e[e.NotSubscribed=8]="NotSubscribed",e[e.NotDetected=9]="NotDetected"}(i||(i={}))},P8ZZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("NrNW"),r=n("B5kz"),a=n("CaQ9"),o=n("CDFH");function u(){var e=Object(i.a)().data,t=Object(a.a)().data;return Object(r.c)(["WorkloadPublicDataConfig"],(function(){return Object(o.a)(e,t)}),{cacheTime:1/0,staleTime:1/0,enabled:!!e&&!!t})}},bcUD:function(e,t,n){"use strict";n.d(t,"a",(function(){return U}));var i=n("QjXU"),r=n("CaQ9"),a=n("wVmX"),o=n("Coo+"),u=n("mXGw"),c=n("a3FV"),l=n("MJsD"),d=n("B5kz"),s=n("CMIS"),m=n("Wa5Y"),f={dime:void 0,dimeDisabled:!1,dimeLoadPromise:void 0},v=n("W7wX"),b=n("cenr"),p=n("Dn7E"),O=function(e){var t=e.eventName,n=e.dimeExperience,r=e.result,a=void 0===r?"":r,o=e.metaData,u=void 0===o?"":o,c=e.extraInfo,l=void 0===c?"":c;return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var e,r,o,c;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:e="",i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Object(v.a)()];case 2:return(null==(r=i.sent())?void 0:r.userCountryCode)&&(e=null==r?void 0:r.userCountryCode),[3,4];case 3:return i.sent(),[3,4];case 4:if((o={}).DimeExperience=n,o.State=a,o.UserCountryCode=e,c=l?l+";":"","string"==typeof u&&u)c+=u;else try{c+=JSON.stringify(u)}catch(e){}return o.DebugInfo=c,Object(b.a)(t,o),Object(p.a)({featureName:"Upsell",eventName:t,area:"Other",params:{DimeExperience:n,State:a,DebugInfo:c,UserCountryCode:e}}),[2]}}))}))},h=n("GeVZ"),D=n("Ot9e"),j=n("6MXh"),w=function(e){var t=e.dimeJSUrl,n=e.puid,r=e.upn,a=e.pwaEnabled,o=e.preferredCulture,u=e.sessionId;return Object(i.__awaiter)(void 0,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return f.dimeLoadPromise||(performance.mark("LoadDimeScript_Started"),f.dimeLoadPromise=new Promise((function(e){Object(j.a)(t,(function(){O({eventName:c.a.DimeLoadScript,dimeExperience:"",result:"Succeeded"}),performance.mark("LoadDimeScript_Completed"),function(e,t,n,r,a){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var o;return Object(i.__generator)(this,(function(i){if(f.dime)return[2,1];if(f.dimeDisabled)return[2,2];if("undefined"==typeof Dime)throw f.dimeDisabled=!0,O({eventName:c.a.DimeInitialize,dimeExperience:"",result:"Failed",metaData:"Dime Undefined"}),new Error("Unable to initialize. Dime is undefined.");performance.mark("DimeInitialize_Start"),o={partnerId:n?"officepwa":"officedotcom",language:r,sessionId:a,authHint:n?e:t,userInfo:{puid:e}};try{return f.dime=new Dime(o),performance.mark("DimeInitialize_Complete"),O({eventName:c.a.DimeInitialize,dimeExperience:"",result:"Succeeded"}),[2,1]}catch(e){throw f.dimeDisabled=!0,O({eventName:c.a.DimeInitialize,dimeExperience:"",result:"Failed",metaData:e&&"object"==typeof e?e:void 0}),new Error("Error encountered while initializing Dime.")}return[2]}))}))}(n,r,a,o,u).then((function(){e(1)})).catch((function(){e(2)}))}),(function(){O({eventName:c.a.DimeLoadScript,dimeExperience:"",result:"Failed"}),e(2)}),!1,"dimeScriptReact")}))),[2,f.dimeLoadPromise]}))}))},C=function(e){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,Promise.all([n.e(4),n.e(59)]).then(n.bind(null,"DZQ9"))];case 1:return t.sent().launchUrl(e,{action:"Upsell"}),[2]}}))}))};var g=n("gB6C"),_=n("pdjy"),P=(n("DCX/"),n("m118"),[]),I=n("rbGx"),N=n("NZpx"),S=n("NrNW"),E=n("kPR3"),U=function(e){var t,n=e.experiences,v=e.disableSubscriptionCheck,b=void 0!==v&&v,p=e.disableWarmup,j=void 0!==p&&p,U=function(){var e=Object(S.a)().data,t=Object(E.a)().data,n=Object(N.a)().data,i=Object(r.a)().data;return Object(u.useMemo)((function(){if(e&&t&&n&&i)return{dimeJSUrl:t.dimeJSUrl,dimeTimeoutMs:t.dimeTimeoutMs,preferredCulture:e.preferredCulture,puid:i.puid,pwaEnabled:n.pwaEnabled,sessionId:e.sessionId,upn:i.userPrincipalName||""}}),[n,e,t,i])}(),k=Object(u.useContext)(I.a),x=Object(o.a)().data,y=Object(r.a)().data,L=Object(a.a)(),T=Object(u.useCallback)((function(e,t){U&&function(e){var t,n=e.dimeActionCreators,r=e.dimeExperience,a=e.dimeJSUrl,o=e.dimeTimeoutMs,u=e.preferredCulture,v=e.puid,b=e.pwaEnabled,p=e.sessionId,j=e.targetUrl,g=e.upn;Object(i.__awaiter)(this,void 0,void 0,(function(){var e,_,P,I,N,S;return Object(i.__generator)(this,(function(E){switch(E.label){case 0:return f.dimeDisabled?(O({eventName:c.a.DimeLaunch,dimeExperience:r,result:"Failed",metaData:"RedirectToPOC;DimeDisabled"}),C(j),[2]):(e=null,_=w({dimeJSUrl:a,puid:v,upn:g,pwaEnabled:b,preferredCulture:u,sessionId:p}),P=new Promise((function(t){e=setTimeout((function(){t(0)}),o)})),[4,Promise.race([_,P])]);case 1:if(I=E.sent(),e&&clearTimeout(e),1!==I)return f.dimeDisabled=!0,O({eventName:c.a.DimeLaunch,dimeExperience:r,result:"Failed",metaData:"TimeOut"}),[2];try{N=function(e){if(e&&e.indexOf("ocid=")>0){var t=Object(h.a)(e);if(t){var n=Object(D.a)(t.search);return""!==n.ocid?n.ocid:"PROD_OfficeCom"}}return"PROD_OfficeCom"}(j),S={experience:r,campaignId:N},O({eventName:c.a.DimeLaunch,dimeExperience:r,result:"Start"}),null==n||n.setDialogState("Open"),null===(t=f.dime)||void 0===t||t.launch(S,(function(){O({eventName:c.a.DimeTransactionCompleted,dimeExperience:r}),null==n||n.setConvertedToPaid(!0),function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r,a;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,Object(l.a)()];case 1:return[4,(e=i.sent()).getIdentity()];case 2:return t=i.sent(),n={headers:(a={accept:"application/json"},a["X-OfficeHome-UserId"]=t.puid,a["X-OfficeHome-TenantId"]=t.tenantId,a)},r="".concat(e.officeHomeApiRoot,"/api/workloadpublicdata/consumer"),r="".concat(r,"?forceRefresh=true"),[2,Object(m.a)(c.a.OfficeConsumerWorkloadPublicDataFetch,"Office_Consumer_Workload_Public_Data_Fetch",r,n,e.jwtAuthEnabled,e.getAccessToken,e.officeHomeApiRoot,e.correlationId,"OfficeHome").then((function(e){if(!e.data)throw new Error("No data returned from Consumer workload public data endpoint");return function(e){var t=["WorkloadPublicDataConfig"];d.a.cancelQueries(t),d.a.setQueryData(t,e)}(e.data),e.data})).catch((function(e){Object(s.a)({eventName:c.a.OfficeConsumerWorkloadPublicDataFetch,message:"Failed to get consumer workload public data with error: ".concat(e)})}))]}}))}))}().then((function(e){O({eventName:c.a.DimeForceRefreshWorkloadPublicData,dimeExperience:r,result:"",metaData:{hasBusinessLicense:e.hasBusinessLicense}})})).catch((function(e){O({eventName:c.a.DimeForceRefreshWorkloadPublicData,dimeExperience:r,result:"Failed",metaData:e})}))})).then((function(e){O({eventName:c.a.DimeCompleted,dimeExperience:r,result:null==e?void 0:e.status,metaData:null==e?void 0:e.metaData}),null==n||n.setDialogState("Closed")}))}catch(e){f.dimeDisabled=!0,O({eventName:c.a.DimeLaunch,dimeExperience:r,result:"Failed",metaData:e&&"object"==typeof e?e:void 0,extraInfo:"RedirectToPOC;LaunchException"}),C(j)}return[2]}}))}))}(Object(i.__assign)(Object(i.__assign)({},U),{dimeActionCreators:k,dimeExperience:e,targetUrl:t}))}),[U,k]);return Object(u.useMemo)((function(){var e;if((null==y?void 0:y.isMsa)&&(!L||b)&&!(null==y?void 0:y.isPipl)&&(null===(e=null==x?void 0:x.result)||void 0===e?void 0:e.ShowConsumerUpsell))return j||function(e,t){t&&(t.pwaEnabled&&(null===window||void 0===window?void 0:window.prelaunchmode)||e.forEach((function(e){!function(e,t){-1===P.indexOf(e)&&(P.push(e),O({eventName:c.a.DimeWarmup,dimeExperience:e}),function(e,t){Object(i.__awaiter)(void 0,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){return Object(g.a)((function(){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,w(t)];case 1:return 1===n.sent()&&function(e){if(f.dime){performance.mark("DimePreload_Start");var t=e.experiences.toString();O({eventName:c.a.DimePreload,dimeExperience:t,result:"Start"}),f.dime.preload(e).catch((function(e){O({eventName:c.a.DimePreload,dimeExperience:t,result:"Failed",metaData:e&&"object"==typeof e?e:void 0})}))}}(e),[2]}}))}))}),_.d),[2]}))}))}({experiences:[e]},t))}(e,t)})))}(n,U),T}),[b,j,T,n,null==y?void 0:y.isMsa,null==y?void 0:y.isPipl,L,U,null===(t=null==x?void 0:x.result)||void 0===t?void 0:t.ShowConsumerUpsell])}},"faO/":function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.BuyButton="buybutton",e.InstallGoPremiumButton="installbutton",e.ShellGoPremiumButton="gopremium",e.PaidConsumerBenefitsButton="paidconsumer-unity",e.PremiumTemplates="templates",e.Fre="fre",e.WelcomeBadge="welcomebadge",e.Resubscribe="renew"}(i||(i={}))},gYHC:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("QjXU"),r=n("mgFK"),a=n("aADZ"),o={key:"InstallConfig",isGetClientGeneratedConfigEnabled:function(e){var t;return!!(null===(t=e.resolveConfigGates)||void 0===t?void 0:t.resolveConfigInstallEnabled)},getClientGeneratedConfig:function(e){var t,n,i,r,o,u,c,l,d,s,m,f,v,b,p=e.featureGates,O=e.featureSettings,h=e.componentContext.preferredCulture,D=O.install,j=null!==(n=null===(t=p.ecsInstallNoLicenseOptionsGates)||void 0===t?void 0:t.ecsInstallNoLicenseOptionsEnabled)&&void 0!==n&&n,w=null!==(r=null===(i=p.installGates)||void 0===i?void 0:i.installPwaInstallMoveEnabled)&&void 0!==r&&r,C=null!==(o=null==D?void 0:D.buyOffice365Url)&&void 0!==o?o:"",g=null!==(u=null==D?void 0:D.consumerDirectInstallUrl)&&void 0!==u?u:"",_=null!==(c=null==D?void 0:D.consumerInstallLink)&&void 0!==c?c:"",P=null!==(l=null==D?void 0:D.consumerSSUInstallLink)&&void 0!==l?l:"",I=null!==(d=null==D?void 0:D.dimeJSUrl)&&void 0!==d?d:"",N=Object(a.a)(null!==(s=null==D?void 0:D.dimeTimeoutMs)&&void 0!==s?s:"5000"),S=null!==(m=null==D?void 0:D.goPremiumUrl)&&void 0!==m?m:"",E=null!==(f=null==D?void 0:D.haveOfficeProductKeyUrl)&&void 0!==f?f:"",U=null!==(v=null==D?void 0:D.installApiRoot)&&void 0!==v?v:"",k=null!==(b=null==D?void 0:D.needHelpInstallingOfficeUrl)&&void 0!==b?b:"";return{buyOffice365Url:C,commercialMySoftwarePageUrl:function(e){var t,n=null===(t=e.resources)||void 0===t?void 0:t.adminPortalRootUrl;return n?"".concat(n,"/account#installs"):""}(O),consumerDirectInstallUrl:g,consumerInstallLink:_,consumerSSUInstallLink:P.replace("{0}",h),dimeJSUrl:I,dimeTimeoutMs:N,ecsInstallNoLicenseOptionsEnabled:j,goPremiumUrl:S,haveOfficeProductKeyUrl:E,installApiRoot:U,needHelpInstallingOfficeUrl:k,pwaInstallMoveEnabled:w}},getServerGeneratedConfig:function(e){return function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(r.a)("installConfig",e)];case 1:return[2,t.sent()]}}))}))}(e)}}},kPR3:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("CDuu"),r=n("gYHC");function a(){return Object(i.a)(r.a)}},m118:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("QjXU"),r=n("28zg"),a=n("gYHC");function o(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return[2,Object(r.a)(a.a)]}))}))}},vz6o:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("D/tM"),r=function(e){var t=e.consumerInstallConfig,n=e.workloadPublicDataConfig;return!!(null==n?void 0:n.hasBusinessLicense)||!!t&&function(e){return e!==i.a.NotSubscribed&&e!==i.a.NotDetected&&e!==i.a.NonActive&&e!==i.a.Perpetual&&e!==i.a.Perpetual2019}(t.currentSkuInfo.skuType)}},wVmX:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("zsD3"),r=n("P8ZZ"),a=n("mXGw"),o=n("vz6o"),u=function(){var e=Object(i.a)().data,t=Object(r.a)().data;return Object(a.useMemo)((function(){return Object(o.a)({consumerInstallConfig:e,workloadPublicDataConfig:t})}),[e,t])}},zsD3:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("NrNW"),r=n("B5kz"),a=n("CaQ9"),o=n("/5so");function u(){var e=Object(i.a)().data,t=Object(a.a)().data;return Object(r.c)(["ConsumerInstallInfoConfig"],(function(){return Object(o.a)(e,t)}),{cacheTime:1/0,staleTime:1/0,enabled:!!e&&!!t})}}}]);
//# sourceMappingURL=36.1f998b67d698478416c9.chunk.v7.js.map