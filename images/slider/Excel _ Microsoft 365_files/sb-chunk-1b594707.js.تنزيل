(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["fb-comp"],{"49By":function(t,e,n){"use strict";var r=n("do/B"),o=n("TSIh"),i=Object.prototype.hasOwnProperty;e.a=function(t,e,n){var c=t[e];i.call(t,e)&&Object(o.a)(c,n)&&(void 0!==n||e in t)||Object(r.a)(t,e,n)}},"6kjB":function(t,e,n){"use strict";n.d(e,"a",(function(){return j}));var r=n("+zb2"),o=n("e24R"),i=Object(o.a)("bingForBusiness"),c=n("ohlq"),a=n("cDcd"),s=n("/hiP"),u=n("KUM7");function l(t,e){switch(t){case"dev":return"https://localhost:18101/api";case"test":return"https://bingatwork.asgfalcon-test.io/api";case"prod":return e||"https://business.bing.com/api";case"prod_generic":return e||"https://business.bing.com/work/api";case"prod_gcc":return e||"https://usgov.business.bing.com/api";case"prod_gcch":return e||"https://usgovhigh.business.bing.com/api";case"prod_dod":return e||"https://dod.mss.office365.us/api";case"dev_bing":return"https://localhost/work/api";case"staging_bing":return"https://www.staging-bing-int.com/work/api";default:return Object(u.a)(t)}}var f=n("nPTt"),p=n("WMEh"),d=function(t){return"".concat(function(t){switch(t){case"test":return l(t);case"gcc":return l("prod_gcc");case"trailblazer":return l("prod_gcch");case"pathfinder":return l("prod_dod");default:return l("prod_generic")}}(t),"/v3/user/data/notifications")},g=function(t){return{authorization:"Bearer ".concat(t)}},b=Object(p.a)((function(t){return Object(f.a)((function(e){var n=e.clientType,r=e.environment,o=e.action,i=e.notification;return{url:d(r),method:"PUT",body:JSON.stringify({actions:[{action:o,notification:i,campaign:"none"}],clientContext:{clientType:n}}),headers:g(t)}}))})),h=Object(s.a)((function(t){return Object(f.a)((function(e){var n=e.clientType,r=e.environment,o=e.params;return{url:d(r)+(o?"?"+new URLSearchParams(o).toString():""),method:"POST",body:JSON.stringify({placement:"MsoSearchBox",clientContext:{clientType:n}}),headers:g(t)}}))}),{monitorName:"fetchNotificationConfig",cacheId:"fetchNotificationConfig",cacheVersion:"0",cacheItemLifetime:18e5,cacheKeyExtractor:function(t){t.token;return Object(r.__rest)(t,["token"])}});const m=window.sessionStorage,v=t=>"mssearchux-cache-notificationConfig-"+t,O=t=>(e,n)=>r=>{if("DISMISSED_OR_SHOWN"!==m.getItem(n))return m.setItem(n,e),t(r)};function j(t,e,n){const o=Object(c.a)(),s=i(),[u,l]=Object(a.useState)(!1);return{update:n=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var r;t&&(null===(r=(t=>O(b)("DISMISSED_OR_SHOWN",v(t)))(e)({action:n,environment:t,clientType:o,tokenProvider:s,notification:e}))||void 0===r||r.catch(()=>{}),l(!1))})),fetch:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var r;t&&(null===(r=(t=>O(h)("FETCH",v(t)))(e)({environment:t,clientType:o,tokenProvider:s,params:n}))||void 0===r||r.then(({xhr:t})=>l(((t,e)=>{var n,r;return!!t.responseText&&(null===(r=null===(n=JSON.parse(t.responseText))||void 0===n?void 0:n.notifications)||void 0===r?void 0:r.includes(e))})(t,e))).catch(()=>{}))})),showNotification:u}}},AJTS:function(t,e,n){"use strict";function r(t,e,n,r){return r.Observable.merge(n.map((function(t){return r.Observable.merge(t).distinct(e)})))}n.d(e,"a",(function(){return r}))},HySD:function(t,e,n){"use strict";var r=n("by8I"),o=n("3AH6"),i=n("bWJB"),c=n("XZkk"),a=n("tH0V"),s=Math.max;e.a=function(t,e,n,u){t=Object(o.a)(t)?t:Object(a.a)(t),n=n&&!u?Object(c.a)(n):0;var l=t.length;return n<0&&(n=s(l+n,0)),Object(i.a)(t)?n<=l&&t.indexOf(e,n)>-1:!!l&&Object(r.a)(t,e,n)>-1}},ICr9:function(t,e,n){"use strict";n.r(e);var r,o=n("3twC"),i=n("2HxI"),c=n("Px+X"),a=n("Q+OV"),s=n("cDcd"),u=n("QlCf"),l=function(){return(l=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},f=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),p=function(t,e,n,r){var o,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(c=(i<3?o(c):i>3?o(e,n,c):o(e,n))||c);return i>3&&c&&Object.defineProperty(e,n,c),c},d=function(t){function e(e){var n=t.call(this,e)||this;return n.handleKeyCapture=function(t){"Enter"!==t.key&&" "!==t.key||n._configuration.onClick()},n._configuration=Object(i.a)(),Object(a.a)(void 0,{disableWarnings:!0}),n}return f(e,t),e.prototype.render=function(){var t;this._configuration=Object(i.a)();var e,n={iconName:this._configuration.iconName||"Equalizer"};return s.createElement(c.a,{id:this._configuration.id,iconProps:n,onClick:this._configuration.onClick,onKeyDownCapture:this.handleKeyCapture,ariaLabel:this._configuration.ariaLabel,title:this._configuration.title,styles:(e=null===(t=this.props.theme)||void 0===t?void 0:t.themeStyles,{root:l(l({},Object(u.e)(e)),{background:"transparent"}),rootHovered:{background:"transparent"},rootFocused:{background:"transparent"},rootPressed:{background:"transparent"},icon:l(l({},u.f),{lineHeight:"18px",color:e.palette.themeDarkAlt,"&:hover, &:active":{color:e.palette.themeDark}})}),"aria-haspopup":"dialog"})},e=p([Object(o.a)("endButton","FilterButtonComponent")],e)}(s.Component);e.default=d},MdsR:function(t,e,n){"use strict";n.r(e);var r=n("3twC"),o=n("Jd8/"),i=n("cDcd"),c=n("wXX+"),a=n("6kjB"),s=n("m+2y"),u=n("n8h4"),l=Object(u.b)(({themeStyles:t,componentStyles:e})=>{const n=Object.assign(Object.assign({},e.IconContainer),{display:"flex",justifyContent:"center",alignItems:"center"});return Object(s.b)({container:{backgroundColor:t.palette.neutralLight,display:"flex",alignItems:"center",width:"100%",height:38,overflow:"hidden"},displayText:Object.assign({display:"block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",width:"100%",color:t.palette.neutralPrimary},t.fonts.medium),icon:{fontSize:t.fonts.large.fontSize},deleteIcon:{fontSize:t.fonts.small.fontSize,color:t.palette.neutralPrimary},errorIcon:{fontSize:t.fonts.large.fontSize,color:t.palette.red},startIconWrapper:Object.assign(Object.assign({},n),{":hover":{cursor:"default"}}),endIconIconWrapper:Object.assign(Object.assign({},n),{height:"100%",border:"none",background:"transparent",selectors:{":hover":{cursor:"pointer"}}})})});const f=({theme:t,instrumenter:e,expanded:n})=>{var r;const s=l(t),{fetch:u,update:f,showNotification:p}=Object(a.a)(null===(r=e.props.serviceEnvInfo)||void 0===r?void 0:r.environment,"SearchBoxQuickActionTeachingMomentInSuggestion",{variants:"bfbmsosbquick"});if(i.useEffect(()=>{n&&u()},[u,n]),!p)return i.createElement(i.Fragment,null);return i.createElement("div",{className:s.container},i.createElement("div",{className:s.startIconWrapper},i.createElement(o.a,{iconName:"lightbulb",className:s.icon})),i.createElement("span",{className:s.displayText},Object(c.d)()),i.createElement("button",{className:s.endIconIconWrapper,onMouseDown:t=>t.preventDefault(),onClick:()=>f("Shown")},i.createElement(o.a,{iconName:"ChromeClose",className:s.deleteIcon})))};e.default=Object(r.a)("suggestion","TeachingMomentInSuggestion")(t=>i.createElement(f,Object.assign({},t)))},UZl3:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i}));var r=n("n5ha"),o=(Object(r.declareString)("search-dl.quickActions.copyLink.tooltip")),i=(Object(r.declareString)("search-dl.quickActions.successfulCopy.tooltip"))},"Z/gI":function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var r=n("+zb2"),o=n("+du+"),i=n("ZUMI");function c(t,e,n){var c=Object(o.a)(Object(i.a)(e,(function(t){return t.id})),(function(t){return t[0]})),a=t.map((function(t){var e=t.id;return c[e]})),s=a.map((function(t){return t?t.suggestions.length:0})),u=s.reduce((function(t,e){return t+e}),0),l=t.map((function(t){return t.optimalCount}));return(u<=l.reduce((function(t,e){return t+e}))?a:function(t,e){var n=t.reduce((function(t,e){return t+e}),0),r=e.map((function(e,n){return Math.min(e,t[n])})),o=n-r.reduce((function(t,e){return t+e}),0);return r.map((function(t,n){var r=Math.min(t+o,e[n]);return o-=r-t,r}))}(l,s).map((function(t,e){return t?Object(r.__assign)(Object(r.__assign)({},a[e]),{suggestions:a[e].suggestions.slice(0,t)}):null}))).filter((function(t){return t}))}n("AJTS");var a=n("W4Bk"),s=n("UlRC"),u=n("tH0V");function l(){var t={},e={};return this.select((function(t){if(t.logProps&&t.logProps.traceId&&t.logProps.entityId)return t;var n=t.providerId;e[n]=e[n]||Object(a.a)();var o=t.logProps&&t.logProps.traceId||e[n],i=t.logProps&&t.logProps.entityId||Object(a.a)();return Object(r.__assign)(Object(r.__assign)({},t),{entityType:"External",logProps:{traceId:o,entityId:i}})})).select((function(e){return function(e){var n=e.groupId;t[n]=t[n]?t[n].addSuggestion(e):new f(n,[e])}(e),Object(u.a)(t)}))}var f=function(){function t(t,e){this.id=t,this.suggestions=e}return t.prototype.addSuggestion=function(e){return new t(this.id,this.suggestions.concat(e))},t}();function p(t){return d(c,t)}function d(t,e){return function(n,r,o,i,c){var a=n.map((function(t){return t.optimalCount})),s=n.map((function(t){return t.maxCount||Number.MAX_VALUE}));return(e({optimals:a,maxes:s},r,o,i)||i.Observable.empty()).toSuggestionGroups().select((function(e){return t(n,e,c)}))}}s.Observable.prototype.toSuggestionGroups=l},"eer+":function(t,e,n){"use strict";n.r(e),n.d(e,"registration",(function(){return i}));var r=n("upmR");const{provider:o,registration:i}=Object(r.a)({entityType:"People",filter:t=>!t.PeopleIntent});e.default=o},gWgi:function(t,e,n){"use strict";e.a=function(t,e){for(var n=-1,r=null==t?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}},ohIh:function(t,e,n){"use strict";e.a=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}},tgN9:function(t,e,n){"use strict";n.r(e);var r=n("3twC"),o=n("RFWU"),i=n("cDcd"),c=n("wXX+"),a=n("6kjB");const s=({instrumenter:t,searchBox:e,expanded:n})=>{var r,s;const u=null===(r=t.props.serviceEnvInfo)||void 0===r?void 0:r.environment,{showNotification:l,update:f,fetch:p}=Object(a.a)(u,"SearchBoxQuickActionTeachingMomentBubble",{variants:"bfbmsosbquick"}),d=null===(s=e.getInputElement())||void 0===s?void 0:s.closest("form");if(i.useEffect(()=>{n||p()},[p,n]),!d||!l)return i.createElement(i.Fragment,null);const g={children:Object(c.b)(),onClick:()=>{null==e||e.activate(),b()}},b=()=>f("Shown");return d.addEventListener("click",(function(){null==e||e.activate(),b()})),i.createElement(o.a,{target:d,headline:Object(c.c)(),hasCloseButton:!0,onDismiss:b,primaryButtonProps:g},Object(c.a)())};e.default=Object(r.a)("startButton","TeachingMomentBubble")(t=>i.createElement(s,Object.assign({},t)))},"wXX+":function(t,e,n){"use strict";n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return a}));var r=n("n5ha");const o=(Object(r.declareString)("search-box-container-plugins.teachingMoment.suggestion.displayText")),i=(Object(r.declareString)("search-box-container-plugins.teachingMoment.bubble.title")),c=(Object(r.declareString)("search-box-container-plugins.teachingMoment.bubble.body")),a=(Object(r.declareString)("search-box-container-plugins.teachingMoment.bubble.button.tryItNow"))},xo1z:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("KmCS"),o=Object(r.regs)("searchux.substrateSuggestionsScenario","",{required:!1,tags:["session"]});function i(t){var e=o();return["teamsitesearch","commsitesearch","hubsitesearch"].indexOf(t.toLowerCase())>-1||""===e?t:e}}}]);