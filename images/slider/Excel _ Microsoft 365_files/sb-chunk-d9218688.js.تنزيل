(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["sug-entitypicker"],{"5MAU":function(e,t,n){"use strict";var r=n("Puxc"),i=n("xZQ+"),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;t.a=function(e,t){if(Object(r.a)(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Object(i.a)(e))||(a.test(e)||!o.test(e)||null!=t&&e in Object(t))}},"8gmL":function(e,t,n){"use strict";t.a=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}},"9YZs":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("qTII"),i=n("ohlq");var o=n("9LXr"),a=n("cbro");function c(e,t){Object.assign(e.style,t)}function s(e,t){var n=document.createElement("div");n.setAttribute("id","sb-share-dialog-container"),c(n,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.2)",zIndex:"999999",display:"flex",alignItems:"center",justifyContent:"center"});var r=document.createElement("div");c(r,{position:"absolute",width:"480px",height:t?"180px":"480px",backgroundColor:"rgb(240, 240, 240)",display:"flex",alignItems:"center",justifyContent:"center"});var i=document.createElement("div");c(i,{position:"absolute",borderRadius:"50%",borderColor:"rgb(0, 120, 212) rgb(199, 224, 244) rgb(199, 224, 244)",borderWidth:"1.5px",borderStyle:"solid",width:"25px",height:"25px"});var o=document.createElement("style");o.innerText="\n    .closeBtn:hover {\n      cursor: pointer;\n    }\n    .closeBtn {\n      width: 16px;\n      height: 16px;\n      opacity: 0.7;\n    }\n    .closeBtn:hover {\n      opacity: 1;\n    }\n    .closeBtn:before, .closeBtn:after {\n      top: 0;\n      position: absolute;\n      content: ' ';\n      height: 17px;\n      width: 1px;\n      background-color: #333;\n    }\n    .closeBtn:before {\n      transform: rotate(45deg);\n    }\n    .closeBtn:after {\n      transform: rotate(-45deg);\n    }\n  ";var a=document.createElement("button");a.className="closeBtn",a.onclick=function(){return n.remove()},c(a,{position:"absolute",right:"28px",top:"24px",border:"none"}),i.animate([{transform:"rotate(0deg)"},{transform:"rotate(360deg)"}],{duration:1300,iterations:1/0,easing:"cubic-bezier(0.53, 0.21, 0.29, 0.67)"});var s=document.createElement("iframe");return s.src=e,c(s,{width:"100%",height:"100%",border:"none",visibility:"hidden"}),n.appendChild(o),r.appendChild(i),r.appendChild(a),n.appendChild(r),n.appendChild(s),function(e,t,n){function r(e){if(e.data&&"string"==typeof e.data){var r=JSON.parse(e.data);switch(null==r?void 0:r.name){case"share_dismiss":i();break;case"share_ready":case"share_uiReady":t.remove(),n.style.visibility="visible"}}}function i(){e.removeEventListener("click",i),e.remove(),window.removeEventListener("message",r)}e.addEventListener("click",i),window.addEventListener("message",r)}(n,r,s),n}function l(e,t,n){var c=function(e){var t=e.split("_")[1];return atob(t).split(",").pop()||null}(e),l=Object(a.a)(e),u=Object(o.a)(t);if(!c||!u||!l){var d="";return!c&&(d+="listId is missing. "),!u&&(d+="sitePath is missing. "),!l&&(d+="uniqueId is missing. "),d+="(spoId: ".concat(e,")"),Promise.reject(d)}var p="".concat(u,"_layouts/15/sharedialog.aspx?clientId=").concat(function(){var e,t;switch(null===(t=(e=Object(i.a)()).toLowerCase)||void 0===t?void 0:t.call(e)){case"sphomeweb":return"sharePoint";case"officehome":return"officecom";default:return"sharePoint"}}(),"&listId=").concat(c,"&uniqueId=").concat(l,"&smkt=").concat(Object(r.a)(),"&clickTime=").concat(Date.now(),"&fullScreenMode=true").concat(n?"&mode=copy":""),f=document.getElementById("sb-share-dialog-container");return f&&f.remove(),document.body.appendChild(s(p,n)),Promise.resolve()}},C2jH:function(e,t,n){"use strict";var r=n("xZQ+");t.a=function(e){if("string"==typeof e||Object(r.a)(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},Ilj9:function(e,t,n){"use strict";n.r(t),n.d(t,"fileDataMapper",(function(){return h})),n.d(t,"onSearchTextChange",(function(){return m})),n.d(t,"default",(function(){return v})),n.d(t,"registration",(function(){return b}));var r=n("UlRC"),i=n("KmCS"),o=n("F6lS"),a=n("mGoP"),c=n("svMQ"),s=n("GJi/"),l=n("n5ha");const u=(Object(l.declareStringWithPlaceholders)("search-box-suggestion-providers.searchux.strings.EWFileSuggestion.someoneEditedDisplayText")),d=(Object(l.declareStringWithPlaceholders)("search-box-suggestion-providers.searchux.strings.EWFileSuggestion.youEditedDisplayText")),p=(Object(l.declareStringWithPlaceholders)("search-box-suggestion-providers.searchux.strings.EWFileSuggestion.someoneMentionedDisplayText")),f=e=>{const t=Object(s.a)();let n="";const r=e.map(e=>{var t,n;return{actor:null===(t=e.actor)||void 0===t?void 0:t.name,actorUpn:null===(n=e.actor)||void 0===n?void 0:n.upn,action:e.reasonType,time:e.timestamp}})[0];if(!r)return"";switch(r.action){case"Edit":n=t!==r.actorUpn?u({user:r.actor,when:c.a.timeSince(r.time.toUTCString())}):d({when:c.a.timeSince(r.time.toUTCString())});break;case"Mention":n=p({user:r.actor})}return n},g=e=>{switch(e){case"Word":return"docx";case"Excel":return"xlsx";case"PowerPoint":return"pptx";case"OneNote":return"one";case"Fluid":return"loop";case"Pdf":return"pdf";default:return""}},h=(e,t)=>{var n,r,i;return{id:e.id,searchText:t,url:e.webUrl,title:e.fileName?Object(a.b)(t,"FileName",e.fileName,["FileName"]):e.title?Object(a.b)(t,"FileName",e.title,["FileName"]):"",iconUrl:e.iconUrl,secondaryDisplayText:(null===(n=e.activity)||void 0===n?void 0:n.plainText)?null===(r=e.activity)||void 0===r?void 0:r.plainText:e.recentActivities.length>0?f(e.recentActivities):"",sPWebUrl:e.webUrl,uniqueId:null===(i=e.sharepointIds)||void 0===i?void 0:i.listItemUniqueId,fileExtension:e.extension?e.extension:g(e.fileType),fileType:e.fileType,downloadUrl:e.downloadUrl}},m=(e,t)=>{const n=e.filter(e=>e.fileName.toLowerCase().includes(t.toLowerCase())||e.title.toLowerCase().includes(t.toLowerCase()));if(0===n.length)throw new Error("no file found matching search term");return r.Observable.fromArray(n.map(e=>h(e,t)))};class v{getId(){return"EWFileSuggestionProvider"}createStream(e){var t;if(!window.getEdgeworthSuggestions||0===(null===(t=window.getEdgeworthSuggestions.allDocs)||void 0===t?void 0:t.length))throw new Error("Data source not found on window");const n=window.getEdgeworthSuggestions.allDocs.filter(e=>!e.isHidden&&("Word"===e.fileType||"Excel"===e.fileType||"PowerPoint"===e.fileType||"Pdf"===e.fileType||"Fluid"===e.fileType||"OneNote"===e.fileType));if(0===(null==n?void 0:n.length))throw new Error("No file data found");return""===e?r.Observable.fromArray(n.map(e=>h(e,""))):m(n,e)}}const b=Object(i.regs)(`${o.a}.${v.prototype.getId()}`,v)},L7bx:function(e,t,n){"use strict";var r=n("QTQf"),i=n("C2jH");t.a=function(e,t){for(var n=0,o=(t=Object(r.a)(t,e)).length;null!=e&&n<o;)e=e[Object(i.a)(t[n++])];return n&&n==o?e:void 0}},QTQf:function(e,t,n){"use strict";var r=n("Puxc"),i=n("5MAU"),o=n("RwT/");var a=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,c=/\\(\\)?/g,s=function(e){var t=Object(o.a)(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(a,(function(e,n,r,i){t.push(r?i.replace(c,"$1"):n||e)})),t})),l=n("EhQd"),u=n("gWgi"),d=n("xZQ+"),p=l.a?l.a.prototype:void 0,f=p?p.toString:void 0;var g=function e(t){if("string"==typeof t)return t;if(Object(r.a)(t))return Object(u.a)(t,e)+"";if(Object(d.a)(t))return f?f.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n};var h=function(e){return null==e?"":g(e)};t.a=function(e,t){return Object(r.a)(e)?e:Object(i.a)(e,t)?[e]:s(h(e))}},QZJ3:function(e,t,n){"use strict";n.r(t),n.d(t,"registration",(function(){return o}));var r=n("upmR");const{provider:i,registration:o}=Object(r.a)({entityType:"Message"});t.default=i},ddrb:function(e,t,n){"use strict";var r=n("L7bx");t.a=function(e,t,n){var i=null==e?void 0:Object(r.a)(e,t);return void 0===i?n:i}},eEnn:function(e,t,n){"use strict";n.r(t),n.d(t,"EntityPickerSuggestion",(function(){return w}));var r=n("+zb2"),i=n("cDcd"),o=n("NaTl"),a=n("wAGM"),c=n("Dxhy"),s=n("j4bS"),l=n("zt+T"),u=n("/krt"),d=n("3lF4");function p(e){var t=e.displayTexts,n=e.styles,o=e.theme,a=function(e){var t={icons:[],texts:[]};return e.slice(1).forEach((function(e){var n=e.icon,r=e.text;t.icons.push(n&&n.fluentIcon?{icon:n.fluentIcon,ariaLabel:n.ariaLabel}:void 0),t.texts.push(r)})),t}(t);return i.createElement("div",{className:n.suggestionTextWrapper},i.createElement("div",{className:n.suggestionTitle,"data-tooltip":!0},i.createElement(u.a,{markType:"mark",text:t[0].text,highlightCssClass:n.highlighted}),i.createElement("span",{className:n.offScreen},",")),i.createElement(d.a,Object(r.__assign)({},{styles:n,theme:o,tidbits:a.texts,tidbitIcons:a.icons})))}var f=n("m+2y"),g=n("n8h4"),h=n("y1hr"),m=Object(g.b)((function(e,t){var n=Object(h.a)(e),i=e.themeStyles.palette,o=e.componentStyles;return Object(f.b)(Object(r.__assign)(Object(r.__assign)({},n),{suggestion:[n.suggestion,{padding:o.Suggestion.padding,height:t?48:38,selectors:{"&:hover":{cursor:"pointer"}}}],iconWrapper:[n.suggestionIconWrapper,{display:"flex",flex:"0 0 44px",justifyContent:"center",width:24,height:24,selectors:{"> img, > canvas":{verticalAlign:"middle"}}}],icon:[{color:i.neutralPrimary,verticalAlign:"middle",fontSize:16,width:"24px !important",height:"24px !important"}],rounded:{borderRadius:"50%"},squared:{borderRadius:2}}))})),v=n("R+K2"),b=n("t5x4"),y=function(e){var t=e.children,n=e.theme,o=e.handlers,a=Object(v.a)(n);return i.createElement("div",Object(r.__assign)({className:a.suggestionContainer},o,{onKeyDown:b.a}),t&&t)},x=n("YBZd"),w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){var e,t=(e=this.props).displayTexts,n=e.entityType,r=e.theme,a=e.url;if(!r||t.length<1||!n)return null;var c=m(r,t.length>1);return i.createElement(y,{theme:r},i.createElement(o.a,null,i.createElement("a",{href:(null==a?void 0:a.trim())||"#",className:c.suggestion,target:"_blank",rel:"noopener noreferrer",onClick:this.onClick},t[0].icon&&i.createElement(x.a,{icon:t[0].icon,styles:{icon:c.icon,iconWrapper:c.iconWrapper},theme:r}),i.createElement(p,{displayTexts:t,styles:c,theme:r}))))},t.prototype.onClick=function(e){var t,n,r=null===(n=(t=this.props).onClick)||void 0===n?void 0:n.call(t,e);e.currentTarget.blur(),r&&e.preventDefault()},Object(r.__decorate)([l.a,Object(c.a)(),s.a],t.prototype,"onClick",null),t}(i.Component);t.default=Object(a.a)("EntityPickerSuggestion")(w)},fVGf:function(e,t,n){"use strict";var r=function(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n},i=n("MMhY"),o=n("FjJx");var a=function(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n},c=n("Puxc");t.a=function(e,t,n){var s=Object(c.a)(e)?r:a,l=arguments.length<3;return s(e,Object(o.a)(t,4),n,l,i.a)}},yK09:function(e,t,n){"use strict";n.r(t);var r=n("+zb2"),i=n("aU0P"),o=n("pgot"),a=n("cDcd"),c=n("y1hr"),s=n("TkU3"),l=n("4Zy8");t.default=function(e){var t=e.styles,n=e.displayName,u=e.phone;if(!u){var d=s.i({name:n});return a.createElement(l.a,Object(r.__assign)({ariaLabel:s.d(d,"",!1),captionText:d},e))}var p=s.j({name:n}),f="".concat(u.Number," (").concat(u.Type,")");return a.createElement(l.a,Object(r.__assign)({ariaLabel:s.d(p,f,!0),captionText:p},e),a.createElement("span",null,f),a.createElement(i.a,{content:u.Number,contentLabel:s.h(),styles:{copyButton:t.copyButton},revealingParentClassName:Object(o.a)()?c.d:t.suggestion}))}}}]);