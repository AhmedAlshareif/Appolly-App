(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[663],{"3M/p":function(e,t,n){"use strict";function r(e,t,n){return u(e,1,t,n)}function i(e,t,n){return u(e,2,t,n)}function a(e,t,n){return u(e,3,t,n)}function s(e,t,n){return u(e,0,t,n)}function o(e,t,n){return u(e,4,t,n)}function u(e,t,n,r){return{name:e,dataType:t,value:n,classification:r||4}}n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return o}))},KLDM:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("3M/p"),i=n("bgLm"),a=n("USFr"),s="Office.Telemetry.OTelJS.EventThrottled";function o(e){return"number"==typeof e}var u=function(){function e(e,t){this._sinkName=e,this._telemetrySink=t,this.name="EventThrottler",this._totalEventsInLastInterval=0,this._singleEventInLastInterval={},this._eventThrottleReported={},this._lastIntervalStart=Date.now(),this._maxNamedEventsPerSecond={}}return e.prototype.setSingleEventThrottle=function(e){this._maxSingleEventPerSecond=e},e.prototype.setTotalEventThrottle=function(e){this._maxTotalEventsPerSecond=e},e.prototype.setNamedEventThrottle=function(e,t){this._maxNamedEventsPerSecond[e]=t},e.prototype.processEvent=function(e){var t=e.eventName;if(t===s)return!0;var n=!0;return Date.now()-this._lastIntervalStart>1e3&&(this._lastIntervalStart=Date.now(),this._totalEventsInLastInterval=0,this._singleEventInLastInterval={}),this._singleEventInLastInterval[t]=this._singleEventInLastInterval[t]+1||1,t in this._maxNamedEventsPerSecond?n=this.applyThrottle(this._singleEventInLastInterval[t],this._maxNamedEventsPerSecond[t],"MaxNamedEventsPerSecond",t):o(this._maxSingleEventPerSecond)&&(n=this.applyThrottle(this._singleEventInLastInterval[t],this._maxSingleEventPerSecond,"MaxSingleEventsPerSecond",t)),o(this._maxTotalEventsPerSecond)&&(this._totalEventsInLastInterval++,n&&(n=this.applyThrottle(this._totalEventsInLastInterval,this._maxTotalEventsPerSecond,"MaxTotalEventsPerSecond",t))),n},e.prototype.applyThrottle=function(e,t,n,o){return!(e>t&&(e===t+1&&this._telemetrySink&&!this._eventThrottleReported[o]&&(this._eventThrottleReported[o]=!0,this._telemetrySink.sendTelemetryEvent({eventName:s,telemetryProperties:{ariaTenantToken:a.a,nexusTenantToken:1723},eventFlags:{diagnosticLevel:110},dataFields:[Object(r.e)("SinkName",this._sinkName||""),Object(r.e)("ThrottledEvent.Name",o),Object(r.d)(n,t)]})),Object(i.b)(2,1,(function(){return"1DS Sink Event Throttle: Exceeded ".concat(t," ").concat(n,": ").concat(o)})),1))},e}()},aCzR:function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return h}));var r=n("QjXU"),i=n("bgLm"),a={};function s(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?a[e]?(t.ariaTenantToken&&(a[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(a[e].dnmToken=t.dnmToken)):a[e]=t:Object(i.b)(0,0,(function(){return"Namespace: ".concat(e)}))}function o(e,t){for(var n=e.length;n>0;){var r=e.substr(0,n);if(a[r]){var i=a[r];return t.ariaTenantToken=i.ariaTenantToken,t.dnmToken=i.dnmToken,!0}n=e.lastIndexOf(".",n-1)}return!1}var u=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,c=/^[a-zA-Z0-9_\.]{1,95}$/;function l(e){return c.test(e)}function d(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!l(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<-9007199254740991||e>9007199254740991)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)}))}var f=n("3M/p"),p=-1;function v(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?Object(r.__assign)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var h=function(){function e(e,t,n){var i,a,s;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=n||{},e&&(this.telemetrySinks=e.telemetrySinks,(i=this.persistentDataFields).push.apply(i,e.persistentDataFields),this.config=Object(r.__assign)(Object(r.__assign)({},e.getConfig()),this.config),(a=this.partAFields).push.apply(a,e.partAFields)),t&&(s=this.persistentDataFields).push.apply(s,t)}return e.prototype.addEventContentType=function(e,t){e.push(Object(f.d)("EventContent.Type",t))},e.prototype.sendTelemetryEvent=function(e){var t=v(e),n=t.telemetryProperties;n.nexusTenantToken=p;var r=n.ariaTenantToken;r||o(t.eventName,n)||r?this.sendTelemetryEventInternal(t,1):Object(i.b)(0,0,(function(){return"No tenant token: "+e.eventName}))},e.prototype.sendCustomerContent=function(e){var t=v(e),n=t.telemetryProperties,r=n.customerContentVersion;return(!r||r>2)&&(n.customerContentVersion=2),n.ariaTenantToken=void 0,n.nexusTenantToken=void 0,n.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=v(e),n=t.telemetryProperties;n.dnmToken||o(t.eventName,n)||n.dnmToken?(this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)):Object(i.b)(0,0,(function(){return"No dnm token: "+t.eventName}))},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):Object(i.b)(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e,t)}catch(e){return void Object(i.a)(0,"SendTelemetryEvent",e)}this.telemetrySinks.forEach((function(n){try{3===t||2===t?n.sendNonStandardEvent&&n.sendNonStandardEvent(e,t):n.sendTelemetryEvent(e)}catch(e){}}))}else Object(i.b)(0,0,(function(){return"Customer content"}))},e.prototype.processTelemetryEvent=function(e,t){var n,r,i;if(e.dataFields&&(null===(i=e.dataFields)||void 0===i||i.unshift(Object(f.e)("OTelJS.Version","4.13.14")),3!==t&&this.persistentDataFields&&(n=e.dataFields).unshift.apply(n,this.persistentDataFields)),this.partAFields.length>0){var a=e.eventContract||{name:"",dataFields:[]};(r=a.dataFields).push.apply(r,this.partAFields),e.eventContract=a}this.config.disableValidation||function(e){if(!function(e){return!(!e||e.length>98)&&u.test(e)}(e.eventName))throw new Error("Invalid eventName");var t=e.eventContract;if(t){if(t.name&&!l(t.name))throw new Error("Invalid eventContract");d(t.dataFields)}d(e.dataFields)}(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,n=e;t<n.length;t++){var r=n[t];this.sendTelemetryEventInternal(r[0],r[1])}},e.prototype.setTenantToken=function(e,t,n){s(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.setDNMToken=function(e,t){s(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return v(e)},e.prototype.getConfig=function(){return this.config},e}()},av1u:function(e,t,n){"use strict";n.d(t,"f",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"h",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"i",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"g",(function(){return v})),n.d(t,"d",(function(){return h})),n.d(t,"e",(function(){return m}));var r=n("3M/p");function i(e,t){return e?e+"."+t:t}function a(e,t,n,a,s){void 0===s&&(s=4),a&&e.push(Object(r.e)("".concat(i(t,n)),a,s))}function s(e,t,n,a){"boolean"==typeof a&&e.push(Object(r.a)("".concat(i(t,n)),a))}function o(e,t,n,a){"number"==typeof a&&e.push(Object(r.d)("".concat(i(t,n)),a))}var u={getFields:function(e){var t="Activity.Result",n=[];return o(n,t,"Code",e.code),a(n,t,"Type",e.type),o(n,t,"Tag",e.tag),s(n,t,"IsExpected",e.isExpected),n.push(Object(r.e)("zC.Activity.Result","Office.System.Result")),n}},c={contractName:"Office.System.Activity",getFields:function(e){var t="Activity",n=[];return a(n,t,"CV",e.cV),o(n,t,"Duration",e.duration),o(n,t,"Count",e.count),o(n,t,"AggMode",e.aggMode),s(n,t,"Success",e.success),e.result&&n.push.apply(n,u.getFields(e.result)),n.push(Object(r.e)("zC.Activity",this.contractName)),n}},l={getFields:function(e){var t="User",n=[];return a(n,t,"PrimaryIdentityHash",e.primaryIdentityHash),a(n,t,"PrimaryIdentitySpace",e.primaryIdentitySpace),a(n,t,"TenantId",e.tenantId,1),a(n,t,"TenantGroup",e.tenantGroup,1),s(n,t,"IsAnonymous",e.isAnonymous),n}},d={getFields:function(e,t){var n=[];return a(n,e,"Name",t.name),a(n,e,"State",t.state),n}},f={getFields:function(e){var t="UserAction",n=[];return o(n,t,"Id",e.id),a(n,t,"Name",e.name),a(n,t,"CommandSurface",e.commandSurface),a(n,t,"ParentName",e.parentName),a(n,t,"TriggerMethod",e.triggerMethod),o(n,t,"TimeOffsetMs",e.timeOffsetMs),n}},p={getFields:function(e){var t="App",n=[];return a(n,t,"Name",e.name,1),a(n,t,"Platform",e.platform,1),a(n,t,"Version",e.version,1),n}},v={getFields:function(e){var t="Session",n=[];return a(n,t,"Id",e.id,1),a(n,t,"EcsETag",e.ecsETag,1),n}},h={getFields:function(e){var t=[];return t.push(Object(r.e)("Pillar",e.pillar)),t.push(Object(r.e)("Veto",e.veto)),t.push(Object(r.a)("IsIntentional",e.isIntentional)),t.push(Object(r.a)("IsInternal",e.isInternal)),t.push(Object(r.a)("AlertOnPillar",e.alertOnPillar)),t.push(Object(r.a)("IsSessionEndingError",e.isSessionEndingError)),s(t,void 0,"InStaging",e.inStaging),t}},m={getFields:function(e){var t=[];return a(t,"Release","AudienceGroup",e.audienceGroup,1),t}}},bgLm:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var r=function(){var e=[];return{fireEvent:function(t){e.forEach((function(e){return e(t)}))},addListener:function(t){t&&e.push(t)}}}();function i(){return r}function a(e,t,n){r.fireEvent({level:e,category:t,message:n})}function s(e,t,n){a(0,e,(function(){var e=n instanceof Error?n.message:"";return"".concat(t,": ").concat(e)}))}},"uTS/":function(e,t,n){"use strict";n.r(t),n.d(t,"OneDSEndpoint",(function(){return r.a})),n.d(t,"EventThrottler",(function(){return i.a})),n.d(t,"getCorrespondingCCCOEndpoint",(function(){return a.b})),n.d(t,"OneDSHelper",(function(){return a.a})),n.d(t,"OneDSSink",(function(){return s.a})),n.d(t,"Sampler",(function(){return c})),n.d(t,"OsPlugin",(function(){return p})),n.d(t,"DNMHandler",(function(){return b})),n.d(t,"CustomerContentHandler",(function(){return T}));var r=n("svub"),i=n("KLDM"),a=n("h+vv"),s=n("3qFY"),o=n("3M/p"),u=1e3,c=function(){function e(){this.name="Sampler",this.sampleRate=.02}return e.prototype.enableWithIdentifier=function(e,t){return!("string"!=typeof t||t.length<4||(this.samplingValue=function(e){return function(e){for(var t=5381,n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n);return t>>>0}(e)%u/u}(t),this.samplingKey=e,0))},e.prototype.enableWithSamplingValue=function(e,t){return!(isNaN(t)||t<0||t>=1||(this.samplingValue=t,this.samplingKey=e,0))},e.prototype.enableWithRandomValue=function(){var e=new Uint32Array(1);return!("object"!=typeof window||!window.crypto||(window.crypto.getRandomValues(e),this.samplingValue=e[0]%u/u,this.samplingKey="Random",0))},e.prototype.setSampleRate=function(e){return e>=0&&e<=1&&(this.sampleRate=e,!0)},e.prototype.getSamplingValue=function(){return this.samplingValue},e.prototype.isMeasuresEnabled=function(){return void 0===this.samplingValue||this.samplingValue<this.sampleRate},e.prototype.processEvent=function(e){var t=e.eventFlags.samplingPolicy;return void 0===this.samplingValue||void 0===t||(1===t?!!this.isMeasuresEnabled()&&(this.addSampleRateField(e,this.sampleRate,this.samplingValue),!0):2!==t&&(this.addSampleRateField(e,1,this.samplingValue),!0))},e.prototype.addSampleRateField=function(e,t,n){e.eventContract||(e.eventContract={name:"",dataFields:[]});var r=e.eventContract.dataFields;r.push(Object(o.b)("Event.SampleRate",t)),r.push(Object(o.b)("Session.SamplingValue",n)),this.samplingKey&&r.push(Object(o.e)("Session.SamplingKey",this.samplingKey)),r.push(Object(o.a)("Session.MeasuresEnabled",this.isMeasuresEnabled()))},e}(),l=n("QjXU");function d(){var e;return Object(l.__awaiter)(this,void 0,void 0,(function(){return Object(l.__generator)(this,(function(t){switch(t.label){case 0:return navigator.userAgent&&navigator.userAgent.indexOf("Windows")>0&&(null===(e=navigator.userAgentData)||void 0===e?void 0:e.getHighEntropyValues)?[4,navigator.userAgentData.getHighEntropyValues(["platformVersion"]).then((function(e){return parseInt(e.platformVersion.split(".")[0],10)>=13})).catch((function(e){return!1}))]:[3,2];case 1:return[2,t.sent()];case 2:return[2,!1]}}))}))}var f,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.identifier="Windows11",t.priority=449,t._isWindows11=!1,t}return Object(l.__extends)(t,e),t.prototype.processTelemetry=function(e,t){this._isWindows11&&(e.ext=e.ext||{},e.ext.os=e.ext.os||{},e.ext.os.name="Windows 11");var n=this._getTelCtx(t);this.processNext(e,n)},t.prototype.detectOs=function(){return Object(l.__awaiter)(this,void 0,void 0,(function(){var e;return Object(l.__generator)(this,(function(t){switch(t.label){case 0:return e=this,[4,d()];case 1:return e._isWindows11=t.sent(),[2]}}))}))},t}(n("Yf3j").a),v=n("bgLm"),h=n("aCzR"),m=n("fc9b"),g=n("USFr"),y=((f={})[3]=g.b,f[4]=g.c,f[5]=g.d,f[2]=g.g,f[1]=g.f,f),b=function(){return function(e){var t,n,r=this;this.eventsProcessed=0,this.initialize=function(r,i){var a=Object(l.__assign)(Object(l.__assign)({},i),{endpointUrl:e.endpointUrl,extensionConfig:Object(l.__assign)(Object(l.__assign)({},i.extensionConfig),{PrivacyGuardPlugin:{}}),plugins:[],nonStandardEventHandlers:[]});t=Object(m.a)(a,"67074e509c164bcaaf85b53c0ad0cde2-13c1c869-7901-4e72-b536-9e754e3b7413-6518"),a.disableStatsTracking||Object(m.b)(r,t),n=r},this.shutdown=function(){null==t||t.shutdown()},this.flush=function(e){null==t||t.flush(e)},this.canHandle=function(e){return 3===e},this.processEvent=function(e){return r.eventsProcessed++,Object(g.l)((function(){var r=function(e){var t,r=Object(h.c)(e),i=[];if(n.getPreprocessors().forEach((function(e){"EventThrottler"===e.name&&i.push(e)})),Object(g.k)(r,i)){var a=Object(g.j)(r);a.setMilliseconds(0),a.setSeconds(0),a.setMinutes(0),2===r.telemetryProperties.dnmInterval&&a.setHours(0);var s={"Event.Name":r.eventName,"Event.Source":"OTelJS","Event.Time":{value:a.toISOString(),propertyType:9}},o=function(e,t){var n={};return t&&t.forEach((function(t){var r=y[t];n[r]=e[r]})),n}(n.getOneDSPersistentDataFields(),null===(t=null==e?void 0:e.telemetryProperties)||void 0===t?void 0:t.dnmAllowedPartA);for(var u in o)s[u]=o[u];if(!Object(g.h)(s,r.dataFields,!0,3))return void Object(v.b)(0,1,(function(){return"Dropping Event: "+r.eventName}));var c=function(e){if(e.telemetryProperties&&e.telemetryProperties.dnmToken)return e.telemetryProperties.dnmToken;Object(v.b)(0,1,(function(){return"Missing DNM Token"}))}(r);if(!c)return;return{iKey:c,name:r.eventName,data:s,time:a.toISOString(),baseType:"custom",ext:{sdk:{seq:0},utc:{eventFlags:2097152}}}}}(e);r&&t&&(null==t||t.track(r))}),g.m)}}}(),T=function(){return function(){var e,t,n=this;this.eventsProcessed=0,this.initialize=function(n,r){var i=Object(a.b)(r.endpointUrl);if(i){var s=Object(l.__assign)(Object(l.__assign)({},r),{endpointUrl:i,extensionConfig:Object(l.__assign)(Object(l.__assign)({},r.extensionConfig),{PrivacyGuardPlugin:{}}),nonStandardEventHandlers:[],plugins:[]});e=Object(m.a)(s,g.e),r.disableStatsTracking||Object(m.b)(n,e),t=n}else Object(v.b)(0,1,(function(){return"Missing 1DS CCCO Endpoint"}))},this.shutdown=function(){null==e||e.shutdown()},this.flush=function(t){null==e||e.flush(t)},this.canHandle=function(e){return t&&2===e},this.processEvent=function(r){return n.eventsProcessed++,Object(g.l)((function(){var n=t.getOneDSCustomerContent(r);n&&e&&(null==e||e.track(n))}),g.m)}}}()}}]);
//# sourceMappingURL=vendors~oteljs1ds.9e4f8c865b088bc1eef3.chunk.v7.js.map