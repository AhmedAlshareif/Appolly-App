(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["pro-kmsite"],{"1DZO":function(e,t,r){"use strict";r.r(t);var o=r("wAGM"),i=r("GtFt"),n=r("3twC"),s=r("D59/"),c=r("oQg0"),a=r("cDcd");const l=Object(s.a)("pp-comp",()=>Promise.all([r.e("pro-3sfile"),r.e("cpl-clear"),r.e(0),r.e("oneds"),r.e("strings"),r.e("pro-asite"),r.e("fb-comp"),r.e("cpl-search"),r.e("vendors~ans-people~cmd-openpeoplecentricsb~cpl-answerproviderhost~extracted-people-answers-email~ext~3fcab59c"),r.e("sug-text"),r.e("warmup"),r.e("stream"),r.e("sug-file"),r.e(2),r.e("pro-kmfile"),r.e("sug-news"),r.e(3),r.e("pro-kmsite"),r.e("pro-3stext"),r.e("pol-eager"),r.e("sug-entitypicker"),r.e("pol-fifo"),r.e("pro-3spers"),r.e("sug-univ"),r.e(4),r.e("cpl-exit"),r.e("sug-horizontalapp"),r.e(5),r.e("vendors~cpl-teachingmoments~debug~fb-comp~mp-comp~pp-comp~sc-comp~sug-pplkey~tp-comp"),r.e("cmd-copyemail"),r.e("pro-3sdoc"),r.e("pro-3s-pplkw"),r.e(1),r.e("ans-people~cmd-openpeoplecentricsb~cpl-answerproviderhost~cpl-host~cpl-invoker~cpl-no-submit~extract~728bf252"),r.e("mp-comp"),r.e("cmd-mailto"),r.e("pro-3sapp"),r.e("ans-people~cmd-openpeoplecentricsb~cpl-answerproviderhost~extracted-people-answers-email~extracted-p~54138f85"),r.e("ans-people~cmd-openpeoplecentricsb~cpl-answerproviderhost~extracted-people-answers-email~extracted-p~8b4a36fd"),r.e("cpl-filterbtn"),r.e("cpl-answerproviderhost~cpl-host~cpl-invoker~cpl-no-submit~extracted-people-answers-email~extracted-p~7f628318"),r.e("pro-3sepa"),r.e("cpl-answerproviderhost~cpl-exit~cpl-host~cpl-invoker~cpl-no-submit~pp-comp~stream"),r.e("pp-comp")]).then(r.bind(null,"Elzn")),e=>e.default),p=Object(c.a)(l);class d extends a.Component{constructor(e){var t,r,o;super(e),this.state={personaPillData:(null===(o=null===(r=null===(t=this.props.instrumenter)||void 0===t?void 0:t.props)||void 0===r?void 0:r.scenarioContext)||void 0===o?void 0:o.personScope)||{}}}componentDidMount(){var e;const t=null===(e=this.props.instrumenter)||void 0===e?void 0:e.register(e=>{var t;e.hostAppInfo&&("person"!==e.hostAppInfo.scopeId&&"personAnswer"!==e.hostAppInfo.scopeId||!(null===(t=e.scenarioContext)||void 0===t?void 0:t.personScope)?this.setState({personaPillData:{}}):this.setState({personaPillData:e.scenarioContext.personScope}))});this.setState({instrumenterId:t})}render(){return this.state.personaPillData&&this.state.personaPillData.userPrincipalName?a.createElement(p,Object.assign({},this.props,{personaPillData:this.state.personaPillData||{}})):null}}var u=Object(n.a)("startButton","SearchBoxPersonaPill")(e=>a.createElement(d,Object.assign({},e)));t.default=Object(o.a)(i.n)(u)},"3Ir8":function(e,t,r){"use strict";r.r(t);var o=r("9YZs"),i=r("9LXr"),n=r("UZl3"),s=r("GPGK"),c=Object(s.a)({id:"CopyLink",entityType:"File",parameters:[{name:"file",entity:"File",isRequired:!0,validate:function(e){var t;return e.id.startsWith("SPO_")&&!!Object(i.a)((null===(t=e.customProps)||void 0===t?void 0:t.fileUrl)||e.id)}}],execute:function(e){var t=e.file.value,r=t.customProps,i=t.id;return Object(o.a)(i,(null==r?void 0:r.fileUrl)||i,!0)},additionalProps:{tooltip:n.a,icon:{iconName:"Link"}}});t.default=c},"7w/n":function(e,t,r){"use strict";r.r(t),r.d(t,"registration",(function(){return h}));var o=r("+zb2"),i=r("rpSO"),n=r("KmCS"),s=r("F6lS"),c=r("POWj"),a=r("bs+K"),l=r("a7o/"),p=r("ohlq"),d=r("xo1z"),u=r("qGDX"),m=r("q9uV");let b=class{constructor(e,t,r,o){this.config=e,this.fetcher=t,this.site=r,this.conversation=o}getId(){return"AutoSuggestSiteScopedSiteSuggestionProvider"}createStream(e){return Object(u.b)(this.fetcher,"Site",{searchText:e,entityTypes:Object(m.b)(this.config,e),scenario:Object(d.a)(Object(p.a)()),appOverride:Object(c.a)(),logicalSearchId:this.conversation&&this.conversation.getLogicalSearchId("sb"),conversationId:this.conversation&&this.conversation.conversationId}).select(({AccessUrl:t,Acronym:r,Color:o,Title:i,logProps:n,originalLogicalSearchId:s,entityType:c})=>({id:t,acronym:r,color:o,searchText:e,title:Object(l.c)([e],Object(a.a)(i)),url:t,secondaryDisplayText:t,displayText:Object(l.c)([e],Object(a.a)(i)),logProps:n,originalLogicalSearchId:s,entityType:c}))}};b=Object(o.__decorate)([Object(m.a)({entityType:"Site"}),Object(o.__param)(0,Object(i.a)("config")),Object(o.__param)(1,Object(i.a)("fetcher")),Object(o.__param)(2,Object(i.a)("site")),Object(o.__param)(3,Object(i.a)("conversation"))],b),t.default=b;const h=Object(n.regs)(s.a+".autosuggestsitescopedsite",b)},DePt:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return s}));var o=r("n5ha"),i=(o.declareString("search-dl.querySuggestion.manageHistoryButtonText")),n=(o.declareString("search-dl.querySuggestion.accessManageHistoryButtonLabel")),s=(o.declareString("search-dl.querySuggestion.removePQRedirectWarningTooltip"))},H3jn:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var o=r("UlRC"),i=r("ABrm"),n=r("Ta5s"),s=r("QxCF"),c=r("oo+0");function a(e,t,r){if(!e)throw new Error("Search box configuration must be specified.");const{streamPolicy:a,groups:p}=e,d=p.map(o=>new c.a(e,o,t).createStream(r)),u=d.map(e=>e.slice(0,e.length-1)),m=o.Observable.fromArray(Object(i.a)(d.map(e=>Object(n.a)(e)))).selectMany(e=>e.catchException(e=>o.Observable.returnValue(e))).toArray().where(e=>!!e.length).select(e=>{throw Object(s.a)(new Error("Suggestion stream error. See inner errors for details."),{innerErrors:e})});return(a(p,l,u,o,{searchText:r})||o.Observable.empty()).concat(m)}const l=e=>e.id},MMhY:function(e,t,r){"use strict";var o=r("faBt"),i=r("3AH6");var n=function(e,t){return function(r,o){if(null==r)return r;if(!Object(i.a)(r))return e(r,o);for(var n=r.length,s=t?n:-1,c=Object(r);(t?s--:++s<n)&&!1!==o(c[s],s,c););return r}}(o.a);t.a=n},bzle:function(e,t,r){"use strict";r.r(t),r.d(t,"registration",(function(){return f}));var o=r("+zb2"),i=r("UlRC"),n=r("rpSO"),s=r("KmCS"),c=r("F6lS"),a=r("POWj"),l=r("mGoP"),p=r("bs+K"),d=r("Q+QT"),u=r("ohlq"),m=r("xo1z"),b=r("qGDX"),h=r("q9uV");let v=class{constructor(e,t,r,o,i){this.config=e,this.fetcher=t,this.conversation=r,this.searchBox=o,this.context=i}getId(){return"FactFileSuggestionProvider"}createStream(e){var t,r;const o=null===(r=null===(t=this.context)||void 0===t?void 0:t.commanding.currentCommand.values[0])||void 0===r?void 0:r.customProps,n=null==o?void 0:o.EmailAddresses[0];if(!n)return i.Observable.fromArray([]);const s=null==o?void 0:o.logicalId,c=e.length>0?`from:${n} ${e}`:"from:"+n;return Object(b.b)(this.fetcher,"File",{searchText:c,entityTypes:Object(h.b)(this.config,e),scenario:Object(m.a)(Object(u.a)()),appOverride:Object(a.a)(),logicalSearchId:s,conversationId:this.conversation&&this.conversation.conversationId}).select(t=>{var r;const{AccessUrl:o,Author:i,AuthorEmail:n,DateCreated:s,DateModified:c,DateAccessed:a,FileExtension:u,FileName:m,FileSourceType:b,FileType:h,ModifiedBy:v,ModifiedByDisplayName:f,PropertyHits:g,SourceTitle:O,logProps:j,originalLogicalSearchId:y,entityType:S,From:x,SharedDateTime:I,UserRelationshipType:T}=t,w=Object(p.a)(m),_=Object(l.b)(Object(l.d)(e),"FileName",w,g),P=Object(l.a)({createdDate:s,authorDisplayName:i||(null===(r=null==x?void 0:x.EmailAddress)||void 0===r?void 0:r.Name)||"",authorEmail:n||"",dateModified:c,modifiedByDisplayName:f,propertyHits:g,searchText:e,lastAccessedDate:a,fileType:h,fileSourceType:b,modifiedBy:v,fromObject:x,sharedDateTime:I,userRelationshipType:T}),D=Object(d.a)(t);return{logProps:j,id:o,searchText:e,title:_,url:o+"?web=1",fileExtension:u,fileSourceType:b,fileType:h,displayText:_,lastModifiedTime:c,lastModifiedBy:f,lastModifiedByAccountName:v,parentSiteTitle:O,secondaryDisplayText:P,originalLogicalSearchId:y,entityType:S,displayTextRaw:w,tidbitIconName:null==D?void 0:D.icon,customProps:{tidbitIconLabel:null==D?void 0:D.label}}})}};v=Object(o.__decorate)([Object(h.a)({entityType:"File"}),Object(o.__param)(0,Object(n.a)("config")),Object(o.__param)(1,Object(n.a)("fetcher")),Object(o.__param)(2,Object(n.a)("conversation")),Object(o.__param)(3,Object(n.a)("searchBox")),Object(o.__param)(4,Object(n.a)("context"))],v),t.default=v;const f=Object(s.regs)(`${c.a}.${v.prototype.getId()}`,v)},"lzq+":function(e,t,r){"use strict";r.r(t),r.d(t,"KMSiteSuggestionEntity",(function(){return b})),r.d(t,"registration",(function(){return v}));var o=r("+zb2"),i=r("qArz"),n=r("UlRC"),s=r("rpSO"),c=r("KmCS"),a=r("F6lS"),l=r("AF84"),p=r("a7o/"),d=r("HTw2"),u=r("V34+"),m=r("lS1Q");const b="Site";let h=class{constructor(e,t){this.topicScope=e,this.context=t}getId(){return`KM${b}SuggestionProvider`}createStream(e){var t,r,o;const s=null===(t=this.context)||void 0===t?void 0:t.commanding.currentCommand.values[0].id;if(!s||!(null===(r=this.context)||void 0===r?void 0:r.instrumenter.props.serviceEnvInfo))return n.Observable.empty();const c=Object(d.a)(null===(o=this.context)||void 0===o?void 0:o.instrumenter.props.serviceEnvInfo);return Object(m.a)({topicId:s,environment:c,entity:b,filterSpec:u.b,searchText:e}).select(({Id:t,Title:r,Acronym:o,Color:n,Url:s})=>({entityType:"KM"+b,id:t,displayTexts:[{text:Object(p.c)([e],r),icon:{acronymIcon:{acronym:o,color:Object(i.a)(n,void 0,!0)},ariaLabel:Object(l.d)()}}],url:s}))}};h=Object(o.__decorate)([Object(o.__param)(0,Object(s.a)("topicScope")),Object(o.__param)(1,Object(s.a)("context"))],h),t.default=h;const v=Object(c.regs)(`${a.a}.${h.prototype.getId()}`,h)},"oo+0":function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var o=r("UlRC"),i=r("mkze"),n=r("D7WJ"),s=r("nbvZ");class c{constructor(e,t,r){if(this.config=e,this.groupConfig=t,!t.providers)throw new Error("Search box suggestion type configuration must contain a list of providers.");if(this.providerInstances=t.providers.map(n=>Object(i.a)(n,Object.assign(Object.assign({},r),{config:e,groupConfig:t,rxjs:o}))),!this.providerInstances.every(e=>p(e.getId)&&p(e.createStream)))throw new Error("Suggestion providers must implement methods getId and createStream.")}createStream(e){const t=[],r=[],i=this.providerInstances,c=this.groupConfig.id;for(let l=0;l<i.length;l++)!function(i){try{const l=i.getId();r.push(i.createStream(e).select(e=>Object.assign(Object.assign({},e),{emitTime:Object(n.a)(),groupId:c,providerId:l})).catchException(e=>{var r;return s.a.DEBUG_SB_PROVIDER&&(null===(r=null===console||void 0===console?void 0:console.error)||void 0===r||r.call(console,"In provider:",l,e)),t.push(a(l,e)),o.Observable.empty()}))}catch(e){t.push(a(i.getId(),e))}}(i[l]);return r.push(o.Observable.defer(()=>t.length?o.Observable.throwException(l(c,t)):o.Observable.empty())),Object.freeze(r)}}const a=(e,t)=>{const r=new Error(`Error in suggestion provider "${e}". See inner error for details.`);return r.providerId=e,r.innerError=t,r},l=(e,t)=>{const r=new Error(`Error in suggestion provider group "${e}". See inner error for details.`);return r.providerGroupId=e,r.innerErrors=t,r};function p(e){return"function"==typeof e}}}]);