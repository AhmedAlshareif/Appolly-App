(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[159],{aBzG:function(n,e,t){"use strict";t.r(e),t.d(e,"ContextMenuModuleNgFactory",(function(){return w}));var l=t("keVe"),u=t("mu6k"),i=t("5FMq"),o=t("hZW2"),s=t("4/We"),c=t("/I02"),a=function(){function n(n,e,t,l,u,i){this.capabilitiesService=n,this.contextService=e,this.contextMenuService=t,this.documentService=l,this.ngZone=u,this.shellHeight=i}return Object.defineProperty(n.prototype,"menuComponent",{set:function(n){n&&this.mobileMenusEnabled&&this.focusOnOpen&&n.setActiveIndex(0,!0)},enumerable:!0,configurable:!0}),n.prototype.ngOnInit=function(){var n=this;this.mobileMenusEnabled=this.capabilitiesService.capabilities.mobileContextMenusEnabled,this.contextMenuSubscription=this.contextMenuService.subscribeToOpenEvents((function(e){e&&(n.animationState="open",n.focusOnOpen=e.focusFirstItem,n.menu=e,n.mobileMenusEnabled||n.ngZone.run((function(){n.positionMenu()})))}))},n.prototype.ngOnDestroy=function(){this.contextMenuSubscription&&this.contextMenuSubscription.unsubscribe()},n.prototype.onSelectItem=function(n){this.menu.menu.items[n.index].executeAction(n.nativeDomEvent),this.onCloseMenu()},n.prototype.onCloseMenu=function(){var n,e;this.contextMenuService.closeMenu(this.menu),this.animationState=null,this.focusOnOpen=!1;var t=document.getElementById(null===(e=null===(n=this.menu)||void 0===n?void 0:n.menu)||void 0===e?void 0:e.id);null==t||t.focus(),this.menu=null},n.prototype.positionMenu=function(){var e=this.documentService.nativeDocument.querySelector("#officeHome__scroll-content");this.menuStyle={"left.px":this.menu.position.left,"top.px":this.menu.position.top-this.shellHeight+e.scrollTop};var t=this.contextService.isRtl;(this.menu.position.left<n.ContextMenuBuffer&&(t?!this.menu.menu.rightAligned:this.menu.menu.rightAligned)||this.menu.position.left>e.clientWidth-n.ContextMenuBuffer&&(t?this.menu.menu.rightAligned:!this.menu.menu.rightAligned))&&(this.menu.menu.rightAligned=!this.menu.menu.rightAligned),this.menu.position.top<n.ContextMenuBuffer&&this.menu.menu.bottomAligned?this.menu.menu.bottomAligned=!1:this.menu.position.top>e.clientHeight+this.shellHeight-n.ContextMenuBuffer&&!this.menu.menu.bottomAligned&&(this.menu.menu.bottomAligned=!0)},n.ContextMenuBuffer=300,n}(),m=a,b=function(){return function(){}}(),r=t("fYis"),p=t("pzhl"),f=t("PkQn"),h=t("TOqr"),d=t("RitX"),g=t("W3Zz"),M=t("PBJH"),v=t("BMb5"),y=t("vW6f"),x=l.Fb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"open",definitions:[{type:1,expr:"* => open",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{opacity:0},offset:null},{type:4,styles:{type:6,styles:{opacity:"{{ opacity }}"},offset:null},timings:"{{ fadeDuration }} 0ms linear"}],options:{params:{fadeDuration:"150ms",opacity:.5}}},options:null},options:null}],options:{}}]}});function C(n){return l.jc(0,[(n()(),l.Hb(0,0,null,null,0,"div",[["class","page-overlay__background page-overlay__background--darker"]],[[24,"@open",0]],null,null,null,null))],null,(function(n,e){n(e,0,0,e.component.animationState)}))}function S(n){return l.jc(0,[(n()(),l.Hb(0,0,null,null,5,null,null,null,null,null,null,null)),(n()(),l.Hb(1,0,null,null,4,"div",[["class","actions-menu-item__flex-content"]],null,null,null,null,null)),(n()(),l.Hb(2,0,null,null,1,"ohp-icon-font",[["size","16"]],null,null,null,p.b,p.a)),l.Gb(3,638976,null,0,f.a,[s.a],{color:[0,"color"],cssClass:[1,"cssClass"],iconFontCssClass:[2,"iconFontCssClass"],iconFontType:[3,"iconFontType"],size:[4,"size"]},null),(n()(),l.Hb(4,0,null,null,1,"div",[],[[8,"className",0]],null,null,null,null)),(n()(),l.gc(5,null,["",""]))],(function(n,e){n(e,3,0,e.context.item.iconColor,l.Ob(2,"actions-menu-item__icon ms-fcl-bl ",e.component.mobileMenusEnabled?"actions-menu-item__icon--mobile":""," ",e.context.item.disabled?"menu-item__icon--disabled":"",""),e.context.item.iconCssClass,e.context.item.icon,"16")}),(function(n,e){n(e,4,0,l.Ob(1,"list-item__title menu-item__title ms-fcl-bl ",e.context.item.disabled?"menu-item__title--disabled":"","")),n(e,5,0,e.context.item.title)}))}function _(n){return l.jc(0,[(n()(),l.Hb(0,0,null,null,11,"div",[],[[1,"role",0],[1,"aria-modal",0]],null,null,null,null)),l.Gb(1,278528,null,0,h.i,[l.x,l.y,l.o,l.K],{ngClass:[0,"ngClass"]},null),l.Zb(2,{"o365cs-base page-overlay":0}),(n()(),l.qb(16777216,null,null,1,null,C)),l.Gb(4,16384,null,0,h.k,[l.W,l.S],{ngIf:[0,"ngIf"]},null),(n()(),l.Hb(5,0,null,null,6,"div",[["class","context-menu"]],null,null,null,null,null)),l.Gb(6,278528,null,0,h.n,[l.o,l.y,l.K],{ngStyle:[0,"ngStyle"]},null),(n()(),l.Hb(7,0,null,null,4,"ohp-menu",[],null,[[null,"selectItem"],[null,"closeMenu"]],(function(n,e,t){var l=!0,u=n.component;return"selectItem"===e&&(l=!1!==u.onSelectItem(t)&&l),"closeMenu"===e&&(l=!1!==u.onCloseMenu()&&l),l}),d.b,d.a)),l.Gb(8,4440064,[[1,4]],1,u.a,[g.c,o.a,l.h,M.a,l.K,l.o,v.b],{menuModel:[0,"menuModel"],mobileMenu:[1,"mobileMenu"]},{selectItem:"selectItem",closeMenu:"closeMenu"}),l.cc(603979776,2,{menuItems:1}),(n()(),l.qb(0,null,null,1,null,S)),l.Gb(11,16384,[[2,4]],0,u.b,[l.S],null,null)],(function(n,e){var t=e.component,l=n(e,2,0,t.mobileMenusEnabled);n(e,1,0,l),n(e,4,0,t.mobileMenusEnabled),n(e,6,0,t.menuStyle),n(e,8,0,t.menu.menu,t.mobileMenusEnabled)}),(function(n,e){var t=e.component;n(e,0,0,t.mobileMenusEnabled?"dialog":null,!!t.mobileMenusEnabled||null)}))}function I(n){return l.jc(0,[l.cc(671088640,1,{menuComponent:0}),(n()(),l.qb(16777216,null,null,1,null,_)),l.Gb(2,16384,null,0,h.k,[l.W,l.S],{ngIf:[0,"ngIf"]},null)],(function(n,e){n(e,2,0,e.component.menu)}),null)}var H=l.Db("ohp-context-menu",a,(function(n){return l.jc(0,[(n()(),l.Hb(0,0,null,null,1,"ohp-context-menu",[],null,null,null,I,x)),l.Gb(1,245760,null,0,a,[s.a,c.a,i.a,o.a,l.F,y.a],null,null)],(function(n,e){n(e,1,0)}),null)}),{},{},[]),E=t("xIlw"),O=t("+a0u"),U=t("lQwO"),k=t("+P5Z"),A=t("CfLe"),B=t("ej7j"),F=t("X+PR"),G=t("VY7U"),j=t("CCRL"),w=l.Eb(b,[],(function(n){return l.Tb([l.Ub(512,l.k,l.hb,[[8,[r.a,H]],[3,l.k],l.D]),l.Ub(4608,h.m,h.l,[l.z]),l.Ub(1073742336,h.c,h.c,[]),l.Ub(1073742336,E.a,E.a,[]),l.Ub(1073742336,O.a,O.a,[]),l.Ub(1073742336,U.a,U.a,[]),l.Ub(1073742336,k.a,k.a,[]),l.Ub(1073742336,A.a,A.a,[]),l.Ub(1073742336,B.a,B.a,[]),l.Ub(1073742336,F.o,F.o,[[2,F.t],[2,F.n]]),l.Ub(1073742336,G.a,G.a,[]),l.Ub(1073742336,b,b,[]),l.Ub(256,j.a,m,[])])}))}}]);
//# sourceMappingURL=context-menu.dab1d42d063095209de0.chunk.v7.js.map