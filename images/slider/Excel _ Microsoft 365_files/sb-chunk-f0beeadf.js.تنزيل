(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["pp-comp"],{"3Odw":function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i("n5ha");const o=(Object(r.declareString)("search-box-container-plugins.searchux.strings.SearchBoxHideableMagnifierSubmitButton.label"))},Elzn:function(t,e,i){"use strict";i.r(e);var r=i("W4Bk"),o=i("A9an"),n=i("Rhqu"),s=i("qrE1"),a=i("5SaU"),l=i("C30r"),c=i("G9Vw"),u=i("8btz"),p=i("KmCS"),h=Object(p.regs)("searchux.isExitOutOfPCSWithPersonNameEnabled",!1),d=i("4zpW"),b=i("w9Rb"),m=i("BsjR"),g=i("cDcd"),v=i("IRlo"),x=i("deeS"),f=i("n5ha");const S=(Object(f.declareStringWithPlaceholders)("search-box-container-plugins.personaPillSearchBoxComponent.ariaLabel")),P=(Object(f.declareStringWithPlaceholders)("search-box-container-plugins.personaPillSearchBoxComponent.clearButtonAriaLabel")),y=t=>({primaryText:{color:t.palette.neutralPrimary,selectors:{":hover":{color:t.palette.neutralPrimary},"& div":{color:t.palette.neutralPrimary}}},wrapper:[{height:24,maxWidth:"150px",marginBottom:0,marginTop:3,background:t.palette.neutralLighter,selectors:{":hover":{background:t.palette.neutralLight}},boxSizing:"content-box",border:"1px solid #eaeaea"}],persona:{height:24},actionWrapper:{display:"flex",alignItems:"center",width:24,height:24,selectors:{"& > button":{color:t.palette.neutralPrimary,height:16,width:16,selectors:{":hover":{color:t.palette.neutralPrimary}}},"& i":{fontSize:14}}}}),I={role:null,ariaHaspopup:null,ariaAutocomplete:null,ariaLabel:null,ariaExpanded:null};function A(t,e){if(!t||t instanceof HTMLDocument)return;const i=t;return i.tagName===e.toUpperCase()?i:A(i.parentNode,e)}class O extends g.PureComponent{constructor(t,e){super(t,e),this.personaPillRef=g.createRef(),this.state={prevInputAttrs:I,isPillEnabled:!1},this.isCursorPositionAtStart=this.isCursorPositionAtStart.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.withForm=this.withForm.bind(this),this.focusPillActionButton=this.focusPillActionButton.bind(this),this.removePillOnBackspace=this.removePillOnBackspace.bind(this),this.removePill=this.removePill.bind(this),this.focusSearchBox=this.focusSearchBox.bind(this),this.selectAllInputText=this.selectAllInputText.bind(this),this.controlSearchInputAttributes=this.controlSearchInputAttributes.bind(this),this.getPreviousInputAttributes=this.getPreviousInputAttributes.bind(this),this.controlSearchInputAriaExpanded=this.controlSearchInputAriaExpanded.bind(this)}componentDidUpdate(){this.withForm(this.controlSearchInputAriaExpanded)}componentWillUnmount(){var t;window.removeEventListener("keydown",this.handleKeyDown,!1),this.setState({isPillEnabled:!1},()=>this.withForm(this.controlSearchInputAttributes)),null===(t=this.props.searchBox)||void 0===t||t.setFilled(!1)}componentDidMount(){var t;this.setState({prevInputAttrs:this.withForm(this.getPreviousInputAttributes)||I,isPillEnabled:!0},()=>this.withForm(this.controlSearchInputAttributes)),window.addEventListener("keydown",this.handleKeyDown,!1),null===(t=this.props.searchBox)||void 0===t||t.setFilled(!0)}getPreviousInputAttributes({input:t}){return t?{ariaLabel:t.getAttribute("aria-label"),role:t.getAttribute("role"),ariaHaspopup:t.getAttribute("aria-haspopup"),ariaExpanded:t.getAttribute("aria-expanded"),ariaAutocomplete:t.getAttribute("aria-autocomplete")}:I}isCursorPositionAtStart(t){return Boolean(t&&null!==t.selectionStart&&(null!==t.selectionEnd&&t.selectionEnd>t.selectionStart||t.selectionStart>0))}handleKeyDown(t){!Object(m.a)(this.props.searchBox)&&this.props.personaPillData&&this.withForm(t.keyCode===a.e?this.removePillOnBackspace:this.focusPillActionButton,t)}withForm(t,e){if(!this.personaPillRef.current)return;const i=A(this.personaPillRef.current,"form"),r=i.querySelector(this.props.inputFieldIdentifier||"");return i&&t({form:i,input:r,e:e})}focusPillActionButton({form:t,input:e,e:i}){if(!t)return;const r=A(t.querySelector(this.props.closestPillAction||""),"button");if(document.activeElement===e){if(this.isCursorPositionAtStart(e))return;i&&i.keyCode===a.b&&(r.setAttribute("tabindex","0"),r.focus())}document.activeElement===r&&i&&i.keyCode===a.c&&(this.focusSearchBox(),this.selectAllInputText(e),r.setAttribute("tabindex","-1"))}getInputSearchBox(){return A(this.personaPillRef.current,"form").querySelector("input[role='searchbox']")}removePillOnBackspace({input:t}){this.isCursorPositionAtStart(t)||this.removePill()}removePill(){var t,e,i,r,o,n;this.logRemovePill();const s=h()?this.props.personaPillData.displayName:"",a=this.props.searchText||s||"";if(window.setTimeout(()=>{var t,e;null===(t=this.props.searchBox)||void 0===t||t.submitSearch(a,{type:"unscope",scopeType:"person"});const i=this.getInputSearchBox();null==i||i.setAttribute("role","combobox"),null==i||i.setAttribute("aria-autocomplete","list"),null==i||i.setAttribute("aria-expanded","false"),null==i||i.removeAttribute("aria-label"),this.focusSearchBox(),null===(e=this.props.searchBox)||void 0===e||e.setFilled(!1)},1),null===(i=null===(e=null===(t=this.props.instrumenter)||void 0===t?void 0:t.props.scenarioContext)||void 0===e?void 0:e.personScope)||void 0===i?void 0:i.richView){const{hostAppInfo:t}=null===(r=this.props.instrumenter)||void 0===r?void 0:r.props;return null===(o=this.props.instrumenter)||void 0===o||o.setProps({hostAppInfo:Object.assign(Object.assign({},t),{scopeId:""}),scenarioContext:{}}),void(null===(n=this.props.searchBox)||void 0===n||n.setSearchText(""))}}logRemovePill(){const t=Object(x.a)(this.props),e=t?t.getLogicalSearchId("sb"):Object(r.a)(),i=t?t.conversationId:"";Object(v.a)(i,e);const o=Object(d.a)("PeoplePill.onRemove")(this.context);Object(b.b)(o,{conversationId:i,impressionId:e},this.context.logContext)}focusSearchBox(){window.setTimeout(()=>{var t;return null===(t=this.props.searchBox)||void 0===t?void 0:t.focus()},0)}selectAllInputText(t){t&&t.setSelectionRange(0,t.value.length)}controlSearchInputAriaExpanded({input:t}){if(!this.personaPillRef||!t)return;const{isPillEnabled:e,prevInputAttrs:{ariaExpanded:i}}=this.state;t.setAttribute("aria-expanded",e?"false":i||""),t.getAttribute("aria-autocomplete")}controlSearchInputAttributes({input:t}){if(!this.personaPillRef||!t)return;const{isPillEnabled:e,prevInputAttrs:{role:i,ariaAutocomplete:r,ariaLabel:o}}=this.state;this.controlSearchInputAriaExpanded({input:t}),t.setAttribute("role",e?"searchbox":i||""),t.setAttribute("aria-autocomplete",e?"none":r||""),t.setAttribute("aria-label",e?S({person:this.props.personaPillData.displayName||""}):o||""),null==t||t.removeAttribute("aria-expanded")}render(){var t;const e=this.props.personaPillData,i=null===(t=this.props.theme)||void 0===t?void 0:t.themeStyles;return e&&e.userPrincipalName?g.createElement(s.a,{fetchProfileImageURL:u.a},g.createElement(o.a,{ref:this.personaPillRef,primaryText:e.displayName||"",imageUrl:e.userPrincipalName,secondaryText:e.userPrincipalName,onRemoveItem:this.removePill,personaSize:n.c.size24,removeButtonAriaLabel:P({person:e.displayName||""}),onRenderPersonaCoin:()=>g.createElement(l.a,{personaCoinSize:24,userName:e.displayName||"",userId:Object(c.a)()?e.aadObjectId:e.userPrincipalName,"aria-hidden":!0}),styling:y(i)})):null}}O.defaultProps={inputFieldIdentifier:'input[type="search"]',closestPillAction:'[data-icon-name="Cancel"]'};e.default=O},H7xZ:function(t,e,i){"use strict";i.r(e);var r=i("6JqZ"),o=i("GtFt"),n=i("617D"),s=i("sRpU"),a=Object(n.a)({classNames:t=>{var e,i;return t.empty?null===(i=t.styles)||void 0===i?void 0:i.submitSearchButtonInactive:null===(e=t.styles)||void 0===e?void 0:e.submitSearchButton},buttonName:o.j,searchIconContext:{SearchIcon:s.a}}),l=i("3Odw"),c=i("LswY"),u=i("n8h4"),p=i("m+2y"),h=i("WLmb"),d=i("Q+ZD"),b=i("TDQE"),m=i("CE7+");const g=b.c.borderRadius,v=Object(m.a)(({addSelectors:t})=>({submitSearchButton:({color:e,backgroundColor:i,backgroundColorOnHover:r})=>Object.assign({borderTopLeftRadius:g,borderTopRightRadius:g,borderBottomRightRadius:g,borderBottomLeftRadius:g,marginTop:b.c.margin,marginBottom:b.c.margin,marginLeft:b.c.margin,marginRight:b.c.margin,borderWidth:"0",height:"calc(100% - 4px)",width:"28px",minWidth:"28px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px",backgroundColor:i,fill:e,color:e},t({":hover":{backgroundColor:r,cursor:"pointer"},":hover svg":{stroke:e,strokeWidth:"1px",overflow:"visible"},":active":{backgroundColor:r},"& svg":{bottom:0}})),icon:(t,e)=>({transform:e?"scale(-1, 1)":void 0}),submitSearchButtonInactive:()=>d.a})),{submitSearchButton:x,submitSearchButtonInactive:f}=v(c.a);var S=Object(u.b)(t=>{const{palette:e}=t,i=x({backgroundColor:e.themeDarkAlt,backgroundColorOnHover:e.themeDark,color:e.white});return Object(p.b)({submitSearchButtonInactive:f({}),submitSearchButton:Object.assign(Object.assign({},i),{selectors:Object.assign({[h.g]:{color:"buttontext",fill:"buttontext"}},i.selectors)})})});e.default=Object(r.a)(a,S,l.a)},Icem:function(t,e,i){"use strict";var r="(?:[^\"'>]|\"[^\"]*\"|'[^']*')*",o=new RegExp("<(?:!--(?:(?:-*[^->])*--+|-?)|script\\b"+r+">[\\s\\S]*?</script\\s*|style\\b"+r+">[\\s\\S]*?</style\\s*|/?[a-z]"+r+")>","gi"),n=function(){function t(){}return t.getTextFromHtml=function(t){if(!t||"string"!=typeof t)return t;var e="";do{t=(e=t).replace(o,"")}while(e!==t);return t},t.decodeHtmlEntities=function(e){e=t.getTextFromHtml(e);var i=document.createElement("div");return i.innerHTML=e,i.textContent},t}();e.a=n},Kwpw:function(t,e,i){"use strict";i.r(e);var r=i("6JqZ"),o=i("3Odw"),n=i("GtFt"),s=i("617D"),a=i("sRpU"),l=Object(s.a)({classNames:t=>{var e,i;return t.empty?null===(i=t.styles)||void 0===i?void 0:i.submitSearchButtonInactive:null===(e=t.styles)||void 0===e?void 0:e.submitSearchButton},buttonName:n.c,searchIconContext:{SearchIcon:a.a}}),c=i("Q+ZD"),u=i("n8h4"),p=i("m+2y"),h=i("PS6g"),d=Object(u.b)(t=>{const e=t.palette.themeDarkAlt;return Object(p.b)({submitSearchButtonInactive:c.a,submitSearchButton:Object.assign(Object.assign({},h.a.IconContainer),{border:"none",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px",backgroundColor:"transparent",fill:e,selectors:{":hover":{cursor:"pointer",stroke:e,strokeWidth:"1px",overflow:"visible"}}})})});e.default=Object(r.a)(l,d,o.a)},PS6g:function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return l}));var r=i("+zb2"),o=i("WLmb"),n={height:"24px",width:"24px"},s={Glyph:{height:"16px",width:"16px"},Icon:{marginLeft:"12px"},IconContainer:{width:"44px",minWidth:"44px",maxWidth:"44px",flex:"0 0 ".concat("44px")},PanelHeader:{height:"22px",paddingBottom:"0",paddingLeft:"12px",paddingTop:"0",fontSize:"12px",fontWeight:"600"},Suggestion:{padding:"6px 18px 6px 0",height:"48px"},SuggestionSecondaryTitle:{lineHeight:"16px"},SuggestionTitle:{lineHeight:"20px"},GroupTitle:{height:"22px",lineHeight:"normal",selectors:{"&:before":{content:'" "',display:"block",height:"6px"}}}},a=Object(r.__assign)(Object(r.__assign)({},s),{FileIcon:n,PeopleIcon:{marginLeft:"10px",marginRight:"6px"},SiteIcon:Object(r.__assign)(Object(r.__assign)({},n),{borderRadius:"2px"}),SuggestionPanel:{paddingBottom:"0",paddingTop:"0",borderBottomWidth:"0",marginBottom:"0"}}),l={themeStyles:Object(o.A)(),version:1,componentStyles:s}},WcHi:function(t,e,i){"use strict";i.r(e);var r=i("wAGM"),o=i("3twC"),n=i("cDcd"),s=i("3c19"),a=Object(o.a)("suggestion","InvokerSuggestionProviderHost")((function(t){return n.createElement(s.a,Object.assign({},t,{invokeSuggestionOnSubmit:!0}))}));e.default=Object(r.a)("InvokerSuggestionProviderHost")(a)},"X+5C":function(t,e,i){"use strict";i.d(e,"a",(function(){return u}));var r=i("+zb2"),o=i("v5Uh"),n=i("1zYj"),s=i("7ivD"),a=i("cDcd"),l=i("R+K2"),c=i("t5x4"),u=function(t){var e=t.children,i=t.theme,u=t.handlers,p=t.displayText,h=t.className,d=Object(r.__read)(a.useState(!1),2),b=d[0],m=d[1];function g(t){var e=t.currentTarget.querySelector("[data-tooltip]");return!!e&&Object(o.a)(e)}var v=Object(l.a)(i);return a.createElement("div",Object(r.__assign)({className:Object(n.a)(v.suggestionContainer,h)},u,{onKeyDown:c.a,onMouseEnter:function(t){var e;return m(g(t)),null===(e=null==u?void 0:u.onMouseEnter)||void 0===e?void 0:e.call(u)},onFocus:function(t){var e;return m(g(t)),null===(e=null==u?void 0:u.onFocus)||void 0===e?void 0:e.call(u)}}),a.createElement(s.a,{content:b?p:"",hostClassName:v.tooltipHost},e&&e))}},npGR:function(t,e,i){"use strict";i.d(e,"a",(function(){return u}));var r=i("pgot"),o=i("+zb2"),n=i("PS6g"),s=i("m+2y"),a=i("n8h4"),l=i("y1hr"),c=Object(a.b)((function(t){void 0===t&&(t=n.b);var e=Object(l.a)(t),i=n.a.FileIcon;return Object(s.b)(Object(o.__assign)({iconWrapper:e.suggestionIconWrapper,fileIcon:[e.suggestionIcon,{marginLeft:"10px"}],icon:Object(o.__assign)(Object(o.__assign)({},i),{backgroundColor:"rgba(0, 0, 0, 0)",margin:"0 auto",color:t.themeStyles.palette.neutralPrimary,marginLeft:"14px",fontSize:"16px"}),textWrapper:e.suggestionTextWrapper,displayText:e.suggestionTitle,secondaryDisplayText:e.suggestionSecondaryTitle},e))}));function u(t){return Object(r.a)()&&t?c(t):i("yGLR")}}}]);