(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[666],{Q8nR:function(e,r,t){"use strict";t.r(r),t.d(r,"Microsoft365Ring",(function(){return R.a})),t.d(r,"loadSearchPage",(function(){return V}));var n="https://",o=n+"outlook-1-cdn.azureedge.",c="/agsc-midgard/";function a(e){switch(e.environment){case"Gallatin":return n+"res-1.cdn.partner.office365.cn/midgard/";case"AG08":return o+"eaglex.ic.gov"+c;case"AG09":return o+"microsoft.scloud"+c;default:return"https://res.cdn.office.net/midgard/"}}function i(e,r){void 0===r&&(r=window);var t="";if(r){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(r.location.search);t=n&&r.decodeURIComponent(n[1].replace(/\+/g," "))||""}return t}var s,u="https://midgardbranches.blob.core.windows.net/lpc/refs/heads/",d="serp-bootstrapper-version-ecs",l=function(e){return"/".concat(function(e){return"".concat("search-page-bootstrapper","-").concat(e.toLowerCase())}(e),".js")},f=new RegExp("https?://(localhost|local\\.teams\\.(office|live)\\.com)(:|/|$)"),p=function(){return t.p},g=["https://res.cdn.office.net","https://res-1.cdn.office.net","https://res-2.cdn.office.net","https://res-1.cdn.partner.office365.cn","https://outlook-1-cdn.azureedge.eaglex.ic.gov","https://outlook-1-cdn.azureedge.microsoft.scloud"];function h(e,r){var t=new URL("https://midgardbranches.blob.core.windows.net/lpc/refs/heads/"),n=r&&"/_next/"!==r&&"/"!==r?new URL(r):void 0,o=new URL(e,document.baseURI).origin;if(o===t.origin||n&&o===n.origin||function(e){return g.includes(e)}(o)||f.test(o))return e;throw new Error("TrustedType policy does not allow loading scripts from ".concat(o,", only from ").concat(t.origin,", ").concat(null==n?void 0:n.origin," and localhost."))}var v=t("mXGw"),m=t("xARA"),_=t("oNR1"),w=t("QjXU");function b(e){return"".concat(e,"?cachekey=").concat((new Date).getTime())}var y=function(e,r,t,n){var o=r+e+l(t);return"1.latest"===e&&(o=b(o)),console.log("Downloading bootstrapper version ".concat(e,".")),P(o,n,e)};function O(e,r,t,n){return Object(w.__awaiter)(this,void 0,void 0,(function(){var o;return Object(w.__generator)(this,(function(c){switch(c.label){case 0:return[4,y(e,r,t,n)];case 1:return o=c.sent(),function(e){var r=JSON.parse(localStorage.getItem(d)||"{}");console.log("Caching bootstrapper version ".concat(e,".")),localStorage.setItem(d,JSON.stringify(Object(w.__assign)(Object(w.__assign)({},r),{cachedVersion:e})))}(e),[2,o]}}))}))}function S(e,r,t,n){return Object(w.__awaiter)(this,void 0,void 0,(function(){return Object(w.__generator)(this,(function(o){return setTimeout((function(){O(e,r,t,n)})),[2]}))}))}var j=function(e,r){var t=JSON.parse(localStorage.getItem(d)||"{}");if(""!==e){var n=r.cdnOptions,o=r.loadingPattern,c=null==t?void 0:t.cachedVersion;c!==e&&(console.log("Bootstrapper cached version ".concat(c," but requested for ECS version ").concat(e,".")),localStorage.setItem(d,JSON.stringify(Object(w.__assign)(Object(w.__assign)({},t),{ecsVersion:e}))),S(e,a(n),o,r))}else localStorage.setItem(d,JSON.stringify(Object(w.__assign)(Object(w.__assign)({},t),{ecsVersion:""})))};function P(e,r,t){var n=window;return n.msfast_search_page_bootstrapper_react=v,n.msfast_search_box_teams_react=v,n.msfast_search_page_bootstrapper_react_dom=m,n.msfast_search_box_teams_react_dom=m,n.msfast_search_page_bootstrapper_react_router=_,function(e,r){void 0===r&&(r={});var t=function(r){return"Error loading script at ".concat(e," (").concat(r,")")},n=document.head||document.getElementsByTagName("head")[0];if(!n)return Promise.reject(t("no head element"));var o=function(e,r,t){void 0===r&&(r=p()),void 0===t&&(t=!0);var n,o=null,c=function(){if(void 0===s&&(s=null,"undefined"!=typeof self&&self.trustedTypes))try{s=self.trustedTypes.createPolicy("@1js/midgard-trusted-types",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e,r){return void 0===r&&(r=p()),h(e,r)}})}catch(e){}return s}();try{o=t&&c?c.createScriptURL(e,r):h(e,r)}catch(e){n=e.message}return{error:n,url:o,trustedTypeAvailable:!!c}}(e);if(o.error)return Promise.reject(t(o.error));var c=document.createElement("script");c.src=o.url,c.crossOrigin="anonymous",c.async=!0,c.charset="utf-8",r.ref&&r.ref(c);var a=new Promise((function(e,n){return window.setTimeout((function(){return n(t("timeout"))}),r.timeout||12e4)})),i=new Promise((function(e,r){c.onload=function(){return e()},c.onerror=function(e,n,o,c,a){var i="string"==typeof e?e:e.type,s=a?JSON.stringify(a):"none",u="Event: ".concat(i,", source: ").concat(n,", line: ").concat(o,", col: ").concat(c,", error: ").concat(s);r(t(u))}}));return n.appendChild(c),Promise.race([i,a])}(e).then((function(){var e=n.msfast_search_page_contract_version;if(1!==e)throw new Error("script contract version ".concat(e," is incompatible with bootstrapper contract version ").concat(1));r.ecsVersionListener=j;var o=n.msfast_search_page_bootstrapper_init;if(o){if(t&&"function"==typeof o[t])return o[t](r);var c=Object.keys(o).sort();if(0===c.length)throw new Error("init function has no versions, version: "+t);return o[c[c.length-1]](r)}throw new Error("init function not assigned by script "+t)}))}var R=t("N5xN");function V(e){return function(e){var r=e.cdnOptions,t=e.loadingPattern,n=e.isUrlOverridingEnabled,o=n?i("SearchPageLocal")||i("MidgardLocal"):"";if(o){var c=parseInt(o,10)||9e3,s="https://localhost:"+c+l(t);return e.cdnOptions.publicPath="https://localhost:"+c+"/",P(s,e)}var f=n?i("SearchPageBranch")||i("MidgardBranch"):"";if(f)return s=b(u+f+l(t)),e.cdnOptions.publicPath=u+f+"/",P(s,e);var p=JSON.parse(localStorage.getItem(d)||"{}"),g=n?i("SearchPageVersion")||i("MidgardVersion"):"",h=null==p?void 0:p.ecsVersion,v=e.preferredVersion,m=null==p?void 0:p.cachedVersion;console.log("Bootstrapper versionOverride : "+g+" ecsVersion : "+h+" preferredVersion : "+v+" cachedVersion : "+m);var _=a(r);return g?O(g,_,t,e):h&&m?(m!==h&&S(h,_,t,e),O(m,_,t,e)):v?O(v,_,t,e):(console.log("Couldnt find any version to load, loading the cached version"),O(m,_,t,e))}(e)}}}]);
//# sourceMappingURL=vendors~search-page-bootstrapper.2938bfcf6001935c39a0.chunk.v7.js.map