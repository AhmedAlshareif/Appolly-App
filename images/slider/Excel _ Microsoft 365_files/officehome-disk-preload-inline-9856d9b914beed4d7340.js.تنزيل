!function(e){var r={};function n(a){if(r[a])return r[a].exports;var o=r[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=r,n.d=function(e,r,a){n.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,r){if(1&r&&(e=n(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)n.d(a,o,function(r){return e[r]}.bind(null,o));return a},n.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(r,"a",r),r},n.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},n.p="",n(n.s="8UtG")}({"8UtG":function(e,r,n){"use strict";n.r(r);var a=n("yxA9");!function(){try{if("serviceWorker"in window.navigator){window.diskPreloadUserIdStorageKey="OfficeHomeDiskPreloadUserStorageId",window.diskPreloadUrlStorageKey="OfficeHomeDiskPreloadUrlStorageKey",window.diskPreloadRequestMap=new Map;var e=JSON.parse(localStorage.getItem(window.diskPreloadUserIdStorageKey));a.b.InitDiskPreload(e,window.diskPreloadRequestMap,window.diskPreloadUrlStorageKey)}}catch(e){}}()},yxA9:function(e,r,n){"use strict";n.d(r,"a",(function(){return a})),n.d(r,"c",(function(){return o})),n.d(r,"d",(function(){return t})),n.d(r,"b",(function(){return i}));var a=36e5,o=function(){function e(){}return e.GetCookies=function(){return document.cookie.split("; ").map((function(e){return e.split("=")})).map((function(e){var r=e[0],n=e[1];return{key:decodeURIComponent(r),value:decodeURIComponent(n)}}))},e.CreateGuid=function(){var e=window.performance.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(r){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===r?n:3&n|8).toString(16)}))},e.InitializeCIDSID=function(r,n){if(r){var a=e.GetQueryParam(new URL(window.location.href),"cid");window.overrideCID=a||e.CreateGuid();var o=e.GetCookies().find((function(e){return e.key===r}));if(o)window.overrideSID=o.value;else{window.overrideSID=e.CreateGuid();var t=n?";path="+n:"";document.cookie=r+"="+encodeURIComponent(window.overrideSID)+t}}},e.NotifyInstallingWorkerAppFailed=function(e,r){if(void 0===r&&(r=!1),e){var n=function(){var a={type:"OFFICECOM_LOAD_COMPLETE",meta:"installation-app",payload:{success:!1,unregister:r}};e.installing.postMessage(a),e.removeEventListener("updatefound",n)};e.installing?n():(e.addEventListener("updatefound",n),setTimeout((function(){e.removeEventListener("updatefound",n)}),5e3))}},e.SetQueryParam=function(e,r,n){if(e&&r&&n)if("undefined"==typeof URLSearchParams){var a=e.search;if(!a||a.length<2)e.search="?"+r+"="+n;else{var o,t=a.substring(1).split("&");for(o=0;o<t.length;o++){var i=t[o].split("=")[0];if(i===r){t[o]=i+"="+n;break}}o===t.length&&t.push(r+"="+n),e.search="?"+t.join("&")}}else e.searchParams.set(r,n)},e.GetQueryParam=function(e,r){if(!e||!r)return"";if("undefined"!=typeof URLSearchParams)return e.searchParams.get(r);var n=e.search;if(!n||n.length<2)return"";for(var a=n.substring(1).split("&"),o=0;o<a.length;o++){var t=a[o].split("="),i=t[0],d=t[1];if(i===r)return d}return""},e}(),t=function(){function e(){}return e.CurrentTime=function(){return e.PerformanceLoggingEnabled?performance.now():(new Date).getTime()},e.LogEvent=function(r,n,a,o,t){if(o=o||{},t=t||[],window.instrumentationService)window.instrumentationService.generateEvent(n,r,a,o,t,!0);else if(e.StandaloneLoggerRunning)StandaloneAriaLogger.Logger.LogEvent(r,n,o,a);else{window.queuedEvents||(window.queuedEvents=[]);var i={streamName:r,eventName:n,eventParams:o,metrics:t,securityThreshold:a};window.queuedEvents.push(i)}},e.MarkPerformance=function(r,n,a,o,t){if(e.PerformanceLoggingEnabled&&!(a>o)&&r)if(window.performanceService)window.performanceService.mark(r,n,0);else{window.performance.mark(r),window.queuedMarks||(window.queuedMarks=[]);var i={markName:r,measureFrom:n,eventParams:t};window.queuedMarks.push(i),e.DrainOnMark&&e.GeneratePerformanceEvents(!1)}},e.FlushQueuedEvents=function(r,n,a){return e.GeneratePerformanceEvents(n,a),window.instrumentationService||e.StandaloneLoggerRunning?(n&&(window.instrumentationService?window.instrumentationService.flush():StandaloneAriaLogger.Logger.EndSession(!0,!0)),Promise.resolve(!0)):r.then((function(r){return"undefined"!=typeof StandaloneAriaLogger&&StandaloneAriaLogger.Logger?(StandaloneAriaLogger.Logger.Initialize(r,!1),n&&StandaloneAriaLogger.Logger.EndSession(!0,!0),e.StandaloneLoggerRunning=!0,Promise.resolve(!0)):Promise.reject("Standalone aria logger does not exist")})).catch((function(e){return console.log(e),Promise.resolve(!1)}))},e.RevokeStandaloneLogger=function(){e.StandaloneLoggerRunning&&(StandaloneAriaLogger.Logger.EndSession(!0,!1),e.StandaloneLoggerRunning=!1,e.DrainOnMark=!1)},e.GeneratePerformanceEvents=function(r,n){if(e.DrainOnMark=!0,e.PerformanceLoggingEnabled&&!window.performanceService){var a=function(r,n,a){var o;(a=a||{}).Latency=n.toString(),a.ItemCategory=null!==(o=a.ItemCategory)&&void 0!==o?o:"Inline",e.LogEvent(e.PerformanceDump,r,0,a,[])},o=function(r,n,a){var o;(a=a||{}).Error=r,a.DebugInfo=n,a.ItemCategory=null!==(o=a.ItemCategory)&&void 0!==o?o:"Inline",e.LogEvent(e.GenericEvent,e.PerformanceMarkFailure,0,a,[])};window.queuedMarks&&window.queuedMarks.splice(0,window.queuedMarks.length).forEach((function(e){var r=e.measureFrom||"navigationStart";try{window.performance.measure(e.markName,r,e.markName)}catch(n){return void o(e.markName,"Failed to record <"+e.markName+"> starting from <"+r+">: exception is thrown",e.eventParams)}var n=window.performance.getEntriesByName(e.markName,"measure");if(n&&n.length){var t=n[0],i=Math.ceil(t.duration);a(e.markName,i,e.eventParams)}else o(e.markName,"Failed to record <"+e.markName+">: measure missing",e.eventParams)})),r||"complete"===document.readyState?e.BrowserMeasuresLogged||(e.BrowserMeasuresLogged=!0,e.GetBrowserTimingMeasures((function(e,r){o(e,r,{Page:n})})).forEach((function(e){a(e.name,e.duration,{Page:n})}))):window.addEventListener("load",(function(){e.GeneratePerformanceEvents(!0,n)}))}},e.PerformanceLoggingSupported=function(){var e=window.performance;return!!(e&&e.now&&e.mark&&e.timing&&e.timing.navigationStart&&e.measure&&e.getEntriesByType)},e.GetBrowserTimingMeasures=function(r,n,a){var o=new Array;if(!e.PerformanceLoggingSupported())return o;for(var t in window.performance.timing){var i=e.globalAllowedMarkers.get(t);if(i){var d=window.performance.timing[t],c=window.performance.timing[i];if("number"==typeof d&&"number"==typeof c)if(0!==d&&0!==c)if(d<c)r(t,"Failed to calculate measure for <"+t+"> starting from <"+i+"> due to relative marker value being greater than marker value: <"+t+">="+d+"; diff from <"+i+">="+(d-c));else if(d<window.performance.timing.navigationStart)r(t,"Failed to calculate measure for <"+t+"> starting from <"+i+"> due to marker value being less than <navigationStart> marker value: <"+t+">="+d+"; diff from <navigationStart}>="+(d-window.performance.timing.navigationStart));else if(c<window.performance.timing.navigationStart)r(t,"Failed to calculate measure for <"+t+"> starting from <"+i+"> due to relative marker value being less than <navigationStart> marker value: <"+t+">="+d+"; <"+i+">="+c+"; diff from <navigationStart}>="+(c-window.performance.timing.navigationStart));else{var s=Math.ceil(d-c);o.push({name:t,duration:s,params:n?Object.assign({},n):{}});var u=t+"_ohp_measure";a&&a(t,u);try{window.performance.measure(u,i,t)}catch(e){r(t,"Failed to record measure for <"+t+"> starting from <"+i+">: exception is thrown")}}else"unloadEventStart"!==t&&"unloadEventEnd"!==t&&r(t,"Failed to calculate measure for <"+t+"> starting from <"+i+"> due to unexpected zero values: <"+t+">="+d+"; <"+i+">="+c);else r(t,"Failed to calculate measure for <"+t+"> starting from <"+i+"> due to unexpected value type: <"+t+"> value type is "+typeof d+"; <"+i+"> value type is "+typeof c)}}return o},e.PerformanceLoggingEnabled=e.PerformanceLoggingSupported(),e.DrainOnMark=!1,e.BrowserMeasuresLogged=!1,e.StandaloneLoggerRunning=!1,e.GenericDebugCache="Generic_Debug_Cache_2",e.GenericClick="Generic_Click",e.GenericEvent="Generic_Event",e.GenericRequest="Generic_Request",e.PerformanceDump="Performance_Dump",e.PerformanceMarkFailure="Performance_Mark_Failure",e.EmailRegex=new RegExp("[a-zA-Z0-9_\\-\\.]+(@|%40|%2540)[a-zA-Z0-9_\\-\\.]+\\.[a-zA-Z]{2,63}","gm"),e.globalAllowedMarkers=new Map([["fetchStart","navigationStart"],["unloadEventStart","navigationStart"],["unloadEventEnd","unloadEventStart"],["domainLookupEnd","domainLookupStart"],["connectEnd","connectStart"],["requestStart","navigationStart"],["responseStart","requestStart"],["responseEnd","responseStart"],["domLoading","responseStart"],["domInteractive","domLoading"],["domComplete","domLoading"]]),e}(),i=function(){function e(){}return e.InitDiskPreload=function(e,r,n){var a=window.navigator.serviceWorker&&window.navigator.serviceWorker.controller;if(e&&a&&r){var o=[],i=localStorage.getItem(n);i&&(o=JSON.parse(i)),o.forEach((function(n){var a=n.url,o=n.markerName;if(a&&o){var i=new Headers;i.append("X-SW-OHP-FetchStrategy","cache-only"),i.append("X-SW-OHP-UserCacheId",e);var d=new Request(a,{headers:i}),c="Disk_Preload_Start_"+o;t.MarkPerformance(c,"",0,3);var s=fetch(d).catch((function(){return Response.error()}));s.then((function(){var e="Disk_Preload_End_"+o;t.MarkPerformance(e,c,0,3)})),r.set(a,s)}}))}},e}();!function(){function e(){}e.prefetchMruData=function(e,r,n,a,o,t,i,d){var c=new URL(window.location.href),s="";s=n?c.origin+"/"+(r?"mock/api/mru":"api/mru"):r?c.origin+"/mock/v2/recent/docs":"https://ocws.officeapps.live.com/ocs/v2/recent/docs";var u=new URL(s+"?apps=Word,Excel,PowerPoint,Visio,OneNote,Sway,Project,Portfolio,Forms,PdfViewer,PowerBI&show=100&rs="+a+(n?"&workload="+t:"")),f=new Headers;n||(f.append("X-CorrelationId",window.overrideCID),f.append("X-Office-Platform","Web"),f.append("X-Office-Application",109..toString()),f.append("X-Office-Version",o)),e&&f.append("Authorization","Bearer "+e.token),i&&this.addCacheHeaders(f,i),d&&f.append("ohp-mock",d);var l={method:"GET",headers:f,credentials:"include"},m=new Request(u.toString(),l);return fetch(m)},e.prefetchRecommendedData=function(e,r,n,a,o,t,i,d,c,s){var u=new URL(window.location.href),f="",l=new URL(window.location.href),m=new Headers;m.append("client-request-id",s),m.append("X-Office-Application",114..toString()),n?(f=r?u.origin+"/mock/PeoplePredictionsB2/MicrosoftFeed":"https://substrate.office.com/PeoplePredictionsB2/MicrosoftFeed",l=new URL(f+"?section=OfficeComHome&scenario=OfficeComANTP&rs="+a),m.append("scenariotag","OfficeComANTP"),m.append("x-officefeedflight","evaluation")):(f=r?u.origin+"/mock/recommended/api/v1.0":"https://substrate.office.com/recommended/api/v1.0",l=new URL(f+"/files?show=16&skipCache=false&apps=Word,Excel,PowerPoint,OneNote,Pdf,Visio&rs="+a),m.append("X-Ms-ClientAppId",o),m.append("X-AnchorMailbox",i+"@"+t),m.append("X-RoutingParameter-SessionKey",i)),e&&m.append("Authorization","Bearer "+e.token),d&&this.addCacheHeaders(m,d),c&&m.append("ohp-mock",c);var g={method:"GET",headers:m,cache:"default",credentials:"include"},p=new Request(l.toString(),g);return fetch(p)},e.prefetchSharePointSitesData=function(e,r,n,a,o,t){var i=new URL(window.location.href),d=r?i.origin+"/mock/sites":"https://odc.officeapps.live.com/odc/servicemanager/v2.0/sites?lcid="+n+"&uilcid="+n+"&syslcid="+n+"&lists=frequent,followed&items=12",c=new URL(d),s=new Headers;s.append("Accept","application/json"),s.append("X-CorrelationId",window.overrideCID),s.append("X-Office-Platform","Web"),s.append("X-Office-Application",109..toString()),s.append("X-Office-Version",a),e&&s.append("Authorization","Bearer "+e.token),o&&this.addCacheHeaders(s,o),t&&s.append("ohp-mock",t);var u={method:"GET",headers:s,cache:"default"},f=new Request(c.toString(),u);return fetch(f)},e.addCacheHeaders=function(e,r){if("serviceWorker"in window.navigator){var n=!!window.navigator.serviceWorker.controller,a=window.navigator.onLine;n&&a&&r&&(e.append("X-SW-OHP-FetchStrategy","network-first"),e.append("X-SW-OHP-UserCacheId",r))}}}()}});
//# sourceMappingURL=officehome-disk-preload-inline-9856d9b914beed4d7340.js.map