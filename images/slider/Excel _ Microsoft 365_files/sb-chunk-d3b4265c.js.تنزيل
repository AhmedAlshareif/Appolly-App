(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["pro-3sepa"],{"/krt":function(t,e,n){"use strict";var r=n("+zb2"),a=n("cDcd"),s={mark:/<mark>(.*?)<\/mark>/gi,bold:/<b>(.*?)<\/b>/gi,c0:/<c0>(.*?)<\/c0>/gi,t0:/<t0>(.*?)<\/t0>/gi,"**":/\*\*(.*?)\*\*/gi,privateUse:/\ue000(.*?)\ue001/gi};function i(t){var e=t.text,n=t.markType,r=e||"";return s.c0.test(r)?s.c0:s.t0.test(r)?s.t0:n?s[n]:function(t){if(s.c0.test(t))return s.c0;return s.t0}(r)}e.a=a.memo((function(t){var e,n=t.text||"",s=i({text:n,markType:t.markType}),c=Object(r.__assign)(Object(r.__assign)({},t.ariaHidden&&((e={role:"presentation"})["aria-hidden"]=!0,e)),t.title&&{title:t.title}),o=function(t,e,n,r,s){void 0===s&&(s="mark");var i,c,o,u=0;e.lastIndex=0;var l=[];for(;o=e.exec(t);){c=o.index,i=e.lastIndex;var g=t.substring(u,c);if(g.length){var d=a.createElement("span",{key:l.length},g);l.push(d)}u=i;var f={key:l.length,className:n,"data-color-item":r},h=a.createElement(s,f,o[1]);l.push(h)}var b=t.substring(u);if(b.length){var p=a.createElement("span",{key:l.length},b);l.push(p)}return l}(n,s,t.highlightCssClass||"",t.shouldColorItem,t.outputTag);if(0===o.length){var u=a.createElement("span",Object(r.__assign)({key:0},c),n);o.push(u)}return a.createElement("span",Object(r.__assign)({key:"wrapper",style:t.style,className:t.className,"data-selector":t.selector,"data-color-item":t.shouldColorItem},c),o)}))},"7nMb":function(t,e,n){"use strict";var r=n("TxXH"),a=n("hY3I"),s=n("FjJx");e.a=function(t,e){return t&&t.length?Object(r.a)(t,Object(s.a)(e,2),a.a):void 0}},"9LXr":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=/https:\/\/(.*?).(.*?)\/(.*?)\/(.*?)\//,a=/^(.*?)safelinks\.protection\.outlook\.com(.*?)\?url=(.*?)$/,s=/^https:\/\/(.*?)\/:(.*?):\/(.*?)\/(.*?)\//;function i(t){var e,n,i=(n=(e=t).match(a))?decodeURIComponent(n[3]):e;if(!(i=i&&function(t){var e=t.match(s);return!e||e.length<4?t:"t"===e[3]?"https://".concat(e[1],"/teams/").concat(e[4],"/"):"p"===e[3]?"https://".concat(e[1],"/personal/").concat(e[4],"_microsoft_com/"):null}(i)))return null;var c=i.match(r);return c?c[0]:null}},FSHq:function(t,e,n){"use strict";var r=n("U1+0"),a=n("TSIh"),s=n("bQU+"),i=n("6kM1"),c=Object.prototype,o=c.hasOwnProperty,u=Object(r.a)((function(t,e){t=Object(t);var n=-1,r=e.length,u=r>2?e[2]:void 0;for(u&&Object(s.a)(e[0],e[1],u)&&(r=1);++n<r;)for(var l=e[n],g=Object(i.a)(l),d=-1,f=g.length;++d<f;){var h=g[d],b=t[h];(void 0===b||Object(a.a)(b,c[h])&&!o.call(t,h))&&(t[h]=l[h])}return t}));e.a=u},JCJM:function(t,e,n){"use strict";n.d(e,"b",(function(){return v})),n.d(e,"a",(function(){return O}));var r=n("+zb2"),a=n("W4Bk");function s(t,e){var n=i();return{iframe:n,initialize:function(){return document.body.contains(n)||(n.src=t,n.style.display="none",document.body.appendChild(n)),n},postMessage:function(r,a,s){var i=function(t,r){return c(n.contentWindow,e,t,r)}(a,s);return n.contentWindow&&n.contentWindow.postMessage(r,t),i}}}var i=function(){return document.createElement("iframe")},c=function(t,e,n,r){return new Promise((function(a,s){return o((function i(c){if(c.source===t&&c.origin===e){var o=void 0,l=!1;try{o=n(c)}catch(t){return u(i),void s(t)}try{l=r(o,c)}catch(t){return u(i),void s(t)}l&&(u(i),a(o))}}))}))},o=function(t){return addEventListener("message",t,!1)},u=function(t){return removeEventListener("message",t,!1)},l=n("LLyz");var g=n("qBZW"),d={},f={},h={};function b(t,e){return d[t]?d[t]:function(t,e,n){if(t){var r=document.getElementById("ms-searchux-3s-proxy"),a=function(t,e){if(t&&t.src===e&&t.ready&&t.postMessage)return{postMessage:t.postMessage,iframe:t,ready:t.ready,initialize:function(){return t}};return null}(r,e);d[n]=a||p(!r,e,n)}else d[n]=p(!1,e,n);return d[n]}((n=window).mssearchux&&n.mssearchux.reuseIframe||!1||e,t+"/search/api/v2/resources",t);var n}function p(t,e,n){var a=s(e,n),i=a.initialize(),o=c(i.contentWindow,n,(function(t){return t.data}),(function(t){return"loaded"===t}));return t&&(i.id="ms-searchux-3s-proxy",i.postMessage=a.postMessage,i.ready=o),Object(r.__assign)(Object(r.__assign)({},a),{ready:o})}var v=function(t,e,n){return void 0===e&&(e="https://substrate.office.com"),void 0===n&&(n=!1),e=Object(g.c)(e),h[e]?m(t,e,n):function(t,e){return void 0===t&&(t="https://substrate.office.com"),void 0===e&&(e=!1),t=Object(g.c)(t),void 0===f[t]&&(f[t]=b(t,e).ready),f[t].then((function(){return h[t]=!0,function(n){return m(n,t,e)}}))}(e,n).then((function(e){return e(t)}))};function m(t,e,n){var r=Object(a.a)(),s=t.action,i=t.token,c=t.prefix,o=t.cvid,u=t.additionalInfo,l=t.headers;return b(e,n).postMessage(JSON.stringify({requestId:r,action:s,token:i,prefix:c,cvid:o,additionalInfo:u,headers:l}),j,(function(t){return t.requestId===r}))}function O(t){var e=JSON.parse(t)[0];e.name;return Object(r.__rest)(e,["name"])}function j(t){try{return JSON.parse(t.data)}catch(t){return Object(l.a)("Failed to parse substrate API JSON response.")}}},TnFU:function(t,e,n){"use strict";var r=n("TxXH"),a=n("hY3I"),s=n("yhHL");e.a=function(t){return t&&t.length?Object(r.a)(t,s.a,a.a):void 0}},TxXH:function(t,e,n){"use strict";var r=n("xZQ+");e.a=function(t,e,n){for(var a=-1,s=t.length;++a<s;){var i=t[a],c=e(i);if(null!=c&&(void 0===o?c==c&&!Object(r.a)(c):n(c,o)))var o=c,u=i}return u}},WoVX:function(t,e,n){"use strict";var r=n("gWgi");var a=function(t,e){return Object(r.a)(e,(function(e){return[e,t[e]]}))},s=n("/QIa"),i=n("8gmL");var c=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n};var o=function(t){return function(e){var n=Object(s.a)(e);return"[object Map]"==n?Object(i.a)(e):"[object Set]"==n?c(e):a(e,t(e))}}(n("3dW/").a);e.a=o},bDlz:function(t,e,n){"use strict";e.a=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var a=t[e];r[a[0]]=a[1]}return r}},cbro:function(t,e,n){"use strict";function r(t){var e;return null===(e=t.match(/.{1,2}/g))||void 0===e?void 0:e.reverse().join("")}function a(t){var e=t.split("_").pop(),n=function(t){for(var e,n,r,a="",s="",i=0;i<t.length;i++){var c="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567".indexOf(t.charAt(i).toUpperCase());a+=(e=c.toString(2),r="0",(n=5)+1>=e.length&&(e=new Array(n+1-e.length).join(r)+e),e)}for(i=0;i+4<=a.length;i+=4){var o=a.substring(i,i+4);s+=parseInt(o,2).toString(16)}return s}((e=null==e?void 0:e.substring(2))||"");return[r((n=n.substring(8)).substring(0,8)),r(n.substring(8,12)),r(n.substring(12,16)),n.substring(16,20),n.substring(20)].join("-")}n.d(e,"a",(function(){return a}))},hY3I:function(t,e,n){"use strict";e.a=function(t,e){return t>e}},hlAE:function(t,e,n){"use strict";n.r(e),n.d(e,"registration",(function(){return x}));var r=n("+zb2"),a=n("KUM7"),s=n("UlRC"),i=n("rpSO"),c=n("KmCS"),o=n("F6lS"),u=n("FzQG"),l=n("2qGI"),g=n("2VtW"),d=n("POWj"),f=n("TBqy"),h=n("a7o/"),b=n("ohlq"),p=n("xo1z"),v=function(t){return"hierarchy.manager.hops:1"===t},m=n("lbO3"),O=n("q9uV");function j(t){return{displayName:t.DisplayName,userPrincipalName:t.UserPrincipalName||t.EmailAddresses[t.EmailAddresses.length-1],icon:Object(f.b)(f.a.m,t.EmailAddresses[0],!1)}}let y=class{constructor(t,e,n,r){this.searchBox=t,this.config=e,this.fetcher=n,this.conversation=r}getId(){return"AutoSuggestExtractedPeopleAnswerSuggestionProvider"}fetchSuggestionGroups(t){return Object(l.a)({searchText:t,entityTypes:Object(O.b)(this.config,t),scenario:Object(p.a)(Object(b.a)()),appOverride:Object(d.a)(),logicalSearchId:this.conversation&&this.conversation.getLogicalSearchId("sb"),conversationId:this.conversation&&this.conversation.conversationId},Object(u.a)(this.fetcher)).selectMany(t=>s.Observable.fromArray(t.value.body.Groups||[]).where(t=>"People"===t.Type).select(e=>{var n;return Object.assign(Object.assign({},e),{logProps:{traceId:Object(g.a)(t.value.body),entityId:null===(n=e.Suggestions[0])||void 0===n?void 0:n.ReferenceId},originalLogicalSearchId:t.value.logicalSearchId})}))}isValidExtractedPeopleAnswerSuggestionGroup(t){if(!t.Intent)return!1;if(!t.Suggestions||t.Suggestions.length<1)return!1;if("Organization"===t.Intent){if(t.Suggestions.length<2)return!1;let e=!1;for(let n=1;n<t.Suggestions.length;++n){if(e=t.Suggestions[n].PropertyHits.some(v),e)break}if(!e)return!1}return!0}createStream(t){return this.fetchSuggestionGroups(t).where(this.isValidExtractedPeopleAnswerSuggestionGroup).select(e=>{const n=e.Suggestions[0],r={id:"ExtractedPeopleAnswerSuggestion",searchText:t,url:"",displayText:""};switch(e.Intent){case"PhoneNumber":return Object.assign(Object.assign({},r),function(t){var e;const n=Object(m.a)(t.Phones,t=>"Mobile"===t.Type),r=null!=n?n:null===(e=t.Phones)||void 0===e?void 0:e[0];return Object.assign(Object.assign({},j(t)),{kind:"PhoneNumber",phone:r})}(n));case"EmailAddress":return Object.assign(Object.assign({},r),function(t){const e=j(t);return Object.assign(Object.assign({},e),{kind:"EmailAddress",emailAddress:e.userPrincipalName})}(n));case"OfficeLocation":return Object.assign(Object.assign({},r),function(t){return Object.assign(Object.assign({},j(t)),{kind:"OfficeLocation",officeLocation:t.OfficeLocation})}(n));case"Organization":return Object.assign(Object.assign({},r),function(t,e,n){const r=t=>({id:t.Id,searchText:e,url:"",displayText:Object(h.c)([e],t.DisplayName),secondaryDisplayText:Object(h.c)([e],t.JobTitle||""),userUpn:t.UserPrincipalName||t.EmailAddresses[t.EmailAddresses.length-1],displayName:t.DisplayName,icon:Object(f.b)(f.a.m,t.EmailAddresses[0],!1)});for(let e=1;e<n.length;++e){const a=n[e],s="hierarchy.manager.hops:1";if(a.PropertyHits.indexOf(s)>-1)return Object.assign(Object.assign({},j(t)),{kind:"Manager",relatedPerson:r(a)})}}(n,t,e.Suggestions));default:return Object(a.b)(e.Intent,void 0)}})}};y=Object(r.__decorate)([Object(O.a)({entityType:"People"}),Object(r.__param)(0,Object(i.a)("searchBox")),Object(r.__param)(1,Object(i.a)("config")),Object(r.__param)(2,Object(i.a)("fetcher")),Object(r.__param)(3,Object(i.a)("conversation"))],y);e.default=y;const x=Object(c.regs)(o.a+".autosuggestextractedpeopleanswer",y)},j4bS:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n("+zb2"),a=n("A9i1"),s=n("ABrm");function i(t,e,n,r){if(!t)return t;var a=t;return a.__catchAll__||(a.__catchAll__=function(){try{return t.apply(this,arguments)}catch(t){var a=Object(s.a)([this&&this.context&&this.context.logContext&&this.context.logContext.context||null,this&&this.constructor&&this.constructor.displayName||null,n]).join("."),i=r||t.message;return a?t.message="".concat(a,": ").concat(i):r&&(t.message=r),e(t)}}),a.__catchAll__}var c=function(t){throw t};function o(t,e,n){var s=t.constructor;return s.contextTypes&&!s.contextTypes.logContext?s.contextTypes=Object(r.__assign)(Object(r.__assign)({},s.contextTypes),{logContext:a.object}):s.contextTypes||(s.contextTypes={logContext:a.object}),{value:i(n.value,c,e,"Callback had an error.")}}},nXbg:function(t,e,n){"use strict";var r=n("TxXH");var a=function(t,e){return t<e},s=n("yhHL");e.a=function(t){return t&&t.length?Object(r.a)(t,s.a,a):void 0}}}]);