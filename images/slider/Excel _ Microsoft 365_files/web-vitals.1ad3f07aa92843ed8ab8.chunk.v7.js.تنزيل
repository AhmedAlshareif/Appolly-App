(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[681],{"/Fzb":function(e,t,n){"use strict";n.r(t),n.d(t,"WebVitalsModuleNgFactory",(function(){return $}));var i=n("keVe"),r=n("4/We"),a=n("QjXU"),o=n("hhzZ"),c=n("casz"),u=n("BMb5"),s=function(){function e(e,t,n){this.instrumentationService=e,this.scheduler=t,this.windowService=n,this.currentWindow=this.windowService.nativeWindow}return e.prototype.getMemoryProfile=function(){var e=this;"measureUserAgentSpecificMemory"in this.currentWindow.performance&&this.scheduler.scheduleWork((function(){e.currentWindow.performance.measureUserAgentSpecificMemory().then((function(t){var n,i=t.bytes,r=e.cleanMemoryBreakdown(t.breakdown),a=((n={}).MemoryProfileBreakdown=JSON.stringify(r),n.TotalSize=i,n);e.instrumentationService.logGenericEvent("Memory_Usage",a)})).catch((function(){}))}),4)},e.prototype.cleanMemoryBreakdown=function(e){var t,n,i,r;try{for(var o=Object(a.__values)(e),c=o.next();!c.done;c=o.next()){var u=c.value.attribution;try{for(var s=(i=void 0,Object(a.__values)(u)),f=s.next();!f.done;f=s.next()){var l=f.value,d=new URL(l.url);l.url=d.hostname+d.pathname}}catch(e){i={error:e}}finally{try{f&&!f.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return e},e.ɵprov=i.kc({factory:function(){return new e(i.lc(o.a),i.lc(c.a),i.lc(u.b))},token:e,providedIn:"root"}),e}(),f=n("Cin9"),l=n("pM41"),d=n("MJsD"),v={OfficeHome:["Shell","AppBar","QuickAccess","MRU","Recommended","CreateOnHome"],Pwa:["Shell","AppBar","QuickAccess","MRU","Recommended","CreateOnHome"],Start:["Shell","AppBar","Templates","Recommended","EdgeworthFirst"],Create:["Shell","AppBar","CreateCenter"]};function m(){var e,t;return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,i,r,o;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return[4,Object(d.a)()];case 1:return n=a.sent(),i=null===(e=null==n?void 0:n.router)||void 0===e?void 0:e.getCurrentRoute(),o=(r=null==i?void 0:i.route)&&null!==(t=v[r])&&void 0!==t?t:[],[2,new Set(o)]}}))}))}function p(){return window._pageTimings||(window._pageTimings={})}function h(e){return"TTVR.".concat(e)}function y(e){var t=e.name,n=e.startTime;if(t.startsWith("Paint_")){var i=t.split("_");if(i.length>=2)return{feature:i[1],latency:Math.round(n)}}else if("shell_plus_end"===t)return{feature:"Shell",latency:Math.round(n)}}function b(){var e=p().TTVR;e&&Object(f.a)({eventName:"TTVR",latency:e})}function g(e,t){var n;return Object(a.__awaiter)(this,void 0,void 0,(function(){var i,r,o,c,u,s,l,d;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return i=p(),[4,m()];case 1:if(!(r=a.sent()).size)return null==t||t.disconnect(),[2];for(o=null!==(n=i.TTVR)&&void 0!==n?n:0,c=0;c<e.length;c++)(u=y(e[c]))&&(l=u.latency,r.has(s=u.feature)&&(d=h(s),i[d]||(Object(f.a)({eventName:d,latency:l}),i[d]=l,o=Math.max(o,l))));return o>0&&(i.TTVR=o),[2]}}))}))}function w(e){void 0===e&&(e=!1);var t=function(){try{var e=new PerformanceObserver((function(e,t){g(e.getEntriesByType("mark"),t)}));return e.observe({type:"mark",buffered:!0}),function(){e&&(e.disconnect(),b())}}catch(e){return function(){try{g(performance.getEntriesByType("mark")),b()}catch(e){}}}}();if(!e)return t;!function(e){var t=!1,n=function(){t||(t=!0,e())},i=function(e){"pagehide"!==e.type&&"hidden"!==document.visibilityState||(n(),window.removeEventListener(e.type,i))};window.addEventListener("visibilitychange",i,!0),window.addEventListener("pagehide",i,!0);var r=["keydown","click"],a=function(){n(),r.forEach((function(e){window.removeEventListener(e,a)}))};r.forEach((function(e){window.addEventListener(e,a,!0)}))}(t)}var S,T,_,C,E=function(e,t){return{name:e,value:void 0===t?-1:t,delta:0,entries:[],id:"v1-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)}},F=function(e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){if("first-input"===e&&!("PerformanceEventTiming"in self))return;var n=new PerformanceObserver((function(e){return e.getEntries().map(t)}));return n.observe({type:e,buffered:!0}),n}}catch(e){}},k=function(e,t){var n=function n(i){"pagehide"!==i.type&&"hidden"!==document.visibilityState||(e(i),t&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};addEventListener("visibilitychange",n,!0),addEventListener("pagehide",n,!0)},L=function(e){addEventListener("pageshow",(function(t){t.persisted&&e(t)}),!0)},P="function"==typeof WeakSet?new WeakSet:new Set,M=function(e,t,n){var i;return function(){t.value>=0&&(n||P.has(t)||"hidden"===document.visibilityState)&&(t.delta=t.value-(i||0),(t.delta||void 0===i)&&(i=t.value,e(t)))}},O=-1,j=function(){return"hidden"===document.visibilityState?0:1/0},I=function(){k((function(e){O=e.timeStamp}),!0)},B=function(){return O<0&&(O=j(),I(),L((function(){setTimeout((function(){O=j(),I()}),0)}))),{get timeStamp(){return O}}},R=function(e,t){var n,i=B(),r=E("FCP"),a=function(e){"first-contentful-paint"===e.name&&(c&&c.disconnect(),e.startTime<i.timeStamp&&(r.value=e.startTime,r.entries.push(e),P.add(r),n()))},o=performance.getEntriesByName("first-contentful-paint")[0],c=o?null:F("paint",a);(o||c)&&(n=M(e,r,t),o&&a(o),L((function(i){r=E("FCP"),n=M(e,r,t),requestAnimationFrame((function(){requestAnimationFrame((function(){r.value=performance.now()-i.timeStamp,P.add(r),n()}))}))})))},D={passive:!0,capture:!0},A=new Date,V=function(e,t){S||(S=t,T=e,_=new Date,z(removeEventListener),U())},U=function(){if(T>=0&&T<_-A){var e={entryType:"first-input",name:S.type,target:S.target,cancelable:S.cancelable,startTime:S.timeStamp,processingStart:S.timeStamp+T};C.forEach((function(t){t(e)})),C=[]}},W=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){V(e,t),r()},i=function(){r()},r=function(){removeEventListener("pointerup",n,D),removeEventListener("pointercancel",i,D)};addEventListener("pointerup",n,D),addEventListener("pointercancel",i,D)}(t,e):V(t,e)}},z=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,W,D)}))},N=function(e,t){var n,i=B(),r=E("FID"),a=function(e){e.startTime<i.timeStamp&&(r.value=e.processingStart-e.startTime,r.entries.push(e),P.add(r),n())},o=F("first-input",a);n=M(e,r,t),o&&k((function(){o.takeRecords().map(a),o.disconnect()}),!0),o&&L((function(){r=E("FID"),n=M(e,r,t),C=[],T=-1,S=null,z(addEventListener),C.push(a),U()}))},x=function(e){var t,n=E("TTFB");t=function(){try{var t=performance.getEntriesByType("navigation")[0]||function(){var e=performance.timing,t={entryType:"navigation",startTime:0};for(var n in e)"navigationStart"!==n&&"toJSON"!==n&&(t[n]=Math.max(e[n]-e.navigationStart,0));return t}();if(n.value=n.delta=t.responseStart,n.value<0)return;n.entries=[t],e(n)}catch(e){}},"complete"===document.readyState?setTimeout(t,0):addEventListener("pageshow",t)},J=n("W3Zz"),Q=function(){function e(e,t,n){this.instrumentationService=e,this.scheduler=t,this.deviceDetector=n}return e.prototype.getVitalsAndTTVR=function(){var e=this,t=this.deviceDetector.deviceInfo.browser.browserType;this.scheduler.scheduleWork(t===J.a.Chrome||t===J.a.Edge||t===J.a.Opera?function(){try{var t=w();!function(e,t){var n,i=E("CLS",0),r=function(e){e.hadRecentInput||(i.value+=e.value,i.entries.push(e),n())},a=F("layout-shift",r);a&&(n=M(e,i,t),k((function(){a.takeRecords().map(r),n()})),L((function(){i=E("CLS",0),n=M(e,i,t)})))}((function(t){return e.assignMetric(t)})),R((function(t){return e.assignMetric(t)})),N((function(t){return e.assignMetric(t)})),x((function(t){return e.assignMetric(t)})),function(e,t){var n,i=B(),r=E("LCP"),a=function(e){var t=e.startTime;t<i.timeStamp&&(r.value=t,r.entries.push(e)),n()},o=F("largest-contentful-paint",a);if(o){n=M(e,r,t);var c=function(){P.has(r)||(o.takeRecords().map(a),o.disconnect(),P.add(r),n())};["keydown","click"].forEach((function(e){addEventListener(e,c,{once:!0,capture:!0})})),k(c,!0),L((function(i){r=E("LCP"),n=M(e,r,t),requestAnimationFrame((function(){requestAnimationFrame((function(){r.value=performance.now()-i.timeStamp,P.add(r),n()}))}))}))}}((function(n){t(),e.assignMetric(n)}))}catch(e){}}:t===J.a.Firefox||t===J.a.Safari?function(){try{w(!0),R((function(t){return e.assignMetric(t)})),N((function(t){return e.assignMetric(t)})),x((function(t){return e.assignMetric(t)}))}catch(e){}}:t===J.a.IE?function(){try{w(!0),x((function(t){return e.assignMetric(t)}))}catch(e){}}:function(){return 0},4),this._FCI=this.scheduler.FCI,this.instrumentationService.logPerformanceEvent("FCI",this._FCI),Object(f.a)({eventName:"FCI",latency:this._FCI})},e.prototype.assignMetric=function(e){switch(e.name){case"CLS":this._CLS=e;break;case"FCP":this._FCP=e;break;case"FID":this._FID=e;break;case"LCP":this._LCP=e;break;case"TTFB":this._TTFB=e}this.logMetric(e)},e.prototype.logMetric=function(e){var t,n=e.name,i=e.value;if("CLS"!==n)this.instrumentationService.logPerformanceEvent(n,i),Object(f.a)({eventName:n,latency:i});else{var r=((t={}).TotalSize=String(i),t);this.instrumentationService.logPerformanceEvent(n,i,r),Object(l.a)({eventName:n,latency:i,instrumentationParams:r})}},Object.defineProperty(e.prototype,"CLS",{get:function(){return void 0!==this._CLS?this._CLS:-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FCI",{get:function(){return void 0!==this._FCI?this._FCI:-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FCP",{get:function(){return void 0!==this._FCP?this._FCP:-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FID",{get:function(){return void 0!==this._FID?this._FID:-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"LCP",{get:function(){return void 0!==this._LCP?this._LCP:-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TTFB",{get:function(){return void 0!==this._TTFB?this._TTFB:-1},enumerable:!0,configurable:!0}),e.ɵprov=i.kc({factory:function(){return new e(i.lc(o.a),i.lc(c.a),i.lc(J.c))},token:e,providedIn:"root"}),e}(),Z=function(){function e(e,t,n,i){this.capabilitiesService=e,this.memoryService=t,this.ngZone=n,this.webVitalsService=i}return e.prototype.ngOnInit=function(){var e=this;this.ngZone.runOutsideAngular((function(){e.capabilitiesService.capabilities.webVitalsEnabled&&e.webVitalsService.getVitalsAndTTVR(),e.capabilitiesService.capabilities.memoryProfilingEnabled&&e.memoryService.getMemoryProfile()}))},e}(),q=Z,H=function(){return function(){}}(),G=i.Fb({encapsulation:2,styles:[],data:{}});function X(e){return i.jc(0,[],null,null)}var K=i.Db("ohp-web-vitals",Z,(function(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-web-vitals",[],null,null,null,X,G)),i.Gb(1,114688,null,0,Z,[r.a,s,i.F,Q],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]),Y=n("CCRL"),$=i.Eb(H,[],(function(e){return i.Tb([i.Ub(512,i.k,i.hb,[[8,[K]],[3,i.k],i.D]),i.Ub(4608,Q,Q,[o.a,c.a,J.c]),i.Ub(1073742336,H,H,[]),i.Ub(256,Y.a,q,[])])}))},MJsD:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("QjXU"),r=n("B5kz"),a=n("zPZ9");function o(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return[2,r.a.fetchQuery(["OfficeComponentContext"],(function(){return a.a}),{cacheTime:1/0,staleTime:1/0})]}))}))}}}]);
//# sourceMappingURL=web-vitals.1ad3f07aa92843ed8ab8.chunk.v7.js.map