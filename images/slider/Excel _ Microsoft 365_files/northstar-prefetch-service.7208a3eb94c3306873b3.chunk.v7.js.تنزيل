(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[586],{"+vVg":function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r("QjXU"),c=r("mgFK"),i=r("W7wX");function a(){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(e){switch(e.label){case 0:return[4,Object(i.a)()];case 1:return[2,!e.sent().isMsa]}}))}))}function o(){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(e){switch(e.label){case 0:return[4,Object(i.a)()];case 1:return[2,e.sent().isMsa]}}))}))}var u=r("/Oio"),s=r("MJsD");function f(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(s.a)()];case 1:return[2,t.sent().workload===e]}}))}))}function l(){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(e){switch(e.label){case 0:return[4,f(u.a.Hwa)];case 1:return[2,e.sent()]}}))}))}function b(){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(e){switch(e.label){case 0:return[4,f(u.a.Embed)];case 1:return[2,e.sent()]}}))}))}var d=r("vb0f"),h=r("yQST"),_=r("CRHC"),j=r("m32Q"),v=r("lkvL"),O=r("a3FV"),m=r("0TX8"),w=r("Wa5Y");function g(e,t,r,c,i,a,o){return Object(n.__awaiter)(this,void 0,void 0,(function(){var u,s;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:u={method:"GET",responseType:"json",url:"".concat(c,"/api/userEntitlements")},n.label=1;case 1:return n.trys.push([1,4,,5]),[4,Object(m.a)(u,r,i,t)];case 2:return n.sent(),[4,Object(w.a)(O.a.UserEntitlementsRequest,"UserEntitlements",u.url,u,o,a,c,e,"OfficeHome",{})];case 3:return(s=n.sent().data)?[2,s]:[3,5];case 4:return n.sent(),[3,5];case 5:return[2,null]}}))}))}var p=r("bIL4");function P(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(c.a)(p.a,e)];case 1:return[2,t.sent()]}}))}))}function y(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(r){return[2,Object(_.a)((function(){return function(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,c,i,u,s,f;return Object(n.__generator)(this,(function(_){switch(_.label){case 0:return c={isCommercialUserPromise:a(),isConsumerUserPromise:o(),isPwaPromise:l(),isEmbedPromise:b()},[4,P(t)];case 1:return void 0!==(r=_.sent())?[3,3]:[4,g(t.correlationId,(function(){return Promise.resolve(e)}),t.inMockMode,t.officeHomeApiRoot,t.workload,t.getAccessToken,t.jwtAuthEnabled)];case 2:r=_.sent(),_.label=3;case 3:return null===r?[3,8]:[4,c.isCommercialUserPromise];case 4:return i=_.sent(),[4,c.isConsumerUserPromise];case 5:return u=_.sent(),[4,c.isPwaPromise];case 6:return s=_.sent(),[4,c.isEmbedPromise];case 7:return f=_.sent(),[2,Object(n.__assign)(Object(n.__assign)({},r),{isCommercialUser:i,isConsumerUser:u,isEmbed:f,isPwa:s,isPwaInUwp:s&&Object(d.a)(),isPwaInWebView2:s&&Object(h.a)()})];case 8:return[2,null]}}))}))}(e,t)}),(function(){return Object(j.a)({userId:e.puid,collectionName:p.c,collectionVersion:p.d,key:p.c})}),(function(t){return Object(v.a)({userId:e.puid,collectionName:p.c,collectionVersion:p.d,key:p.c,data:t})}))]}))}))}},"/Oio":function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e.Antp="antp",e.Embed="embed",e.Hwa="pwa",e.OfficeHome="officehome",e.OfficeHomeReact="officehomereact"}(n||(n={}))},MJsD:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("QjXU"),c=r("B5kz"),i=r("zPZ9");function a(){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(e){return[2,c.a.fetchQuery(["OfficeComponentContext"],(function(){return i.a}),{cacheTime:1/0,staleTime:1/0})]}))}))}},W7wX:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("QjXU"),c=r("MJsD"),i=r("B5kz");function a(){return Object(n.__awaiter)(this,void 0,void 0,(function(){var e;return Object(n.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(c.a)()];case 1:return e=t.sent(),[2,i.a.fetchQuery(["Identity"],(function(){return e.getIdentity()}),{cacheTime:1/0,staleTime:1/0})]}}))}))}},bIL4:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return c})),r.d(t,"c",(function(){return i})),r.d(t,"d",(function(){return a}));var n="UserEntitlements",c="userEntitlements",i="userEntitlements",a=1},gCKw:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r("QjXU"),c=r("MJsD"),i=r("B5kz"),a=r("W7wX"),o=r("XcEc");function u(){var e=this;return i.a.fetchQuery(["FeatureGates"],(function(){return Object(n.__awaiter)(e,void 0,void 0,(function(){var e,t,r;return Object(n.__generator)(this,(function(i){switch(i.label){case 0:return[4,Promise.all([Object(c.a)(),Object(a.a)()])];case 1:return e=n.__read.apply(void 0,[i.sent(),2]),t=e[0],r=e[1],[2,Object(o.a)(r,t)]}}))}))}),{staleTime:1/0,cacheTime:1/0})}},hfNz:function(e,t,r){"use strict";r.r(t),r.d(t,"prefetchNorthStar",(function(){return b}));var n=r("QjXU"),c=r("MJsD"),i=r("gCKw"),a=r("mJgL"),o=r("muUJ"),u=r("a3FV"),s=r("iPRk"),f=r("CMIS"),l=r("s1V1");function b(){return Object(n.__awaiter)(this,void 0,void 0,(function(){var e,t,r,b;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:n.trys.push([0,3,,4]);try{Object(s.a)("PrefetchNorthStar_Started")}catch(e){t="Invoked markPerformance in prefetchNorthStar function, but encountered an error : ".concat(e),Object(o.a)(u.a.PrefetchNorthStarMarkPerformanceError,((r={}).Error=t,r)),Object(f.a)({eventName:u.a.PrefetchNorthStarMarkPerformanceError,errorType:"NorthStarConfig_Error",message:t})}return Object(i.a)(),Object(a.a)(),Object(l.a)(),Object(c.a)(),[4,d()];case 1:n.sent(),n.label=2;case 2:return[3,4];case 3:return e=n.sent(),t="Invoked prefetchNorthStar function, but encountered an error: ".concat(e),Object(o.a)(u.a.PrefetchNorthStarError,((b={}).Error=t,b)),Object(f.a)({eventName:u.a.PrefetchNorthStarError,errorType:"NorthStarConfig_Error",message:t}),[3,4];case 4:return[2]}}))}))}function d(){return Object(n.__awaiter)(this,void 0,void 0,(function(){var e,t,c,i,a,o,u,s;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,r.e(703).then(r.bind(null,"YOYd"))];case 1:return e=n.sent().prefetchAppGalleryConfig,[4,Promise.all([r.e(3),r.e(715)]).then(r.bind(null,"9YWD"))];case 2:return t=n.sent().prefetchCapabilities,[4,Promise.all([r.e(111),r.e(723)]).then(r.bind(null,"rRZh"))];case 3:return c=n.sent().prefetchEdgeworthConfig,[4,r.e(705).then(r.bind(null,"xusa"))];case 4:return i=n.sent().prefetchInstallConfig,[4,r.e(706).then(r.bind(null,"dz9y"))];case 5:return a=n.sent().prefetchMruConfig,[4,r.e(704).then(r.bind(null,"Y3rd"))];case 6:return o=n.sent().prefetchSharedContext,[4,r.e(711).then(r.bind(null,"BHaL"))];case 7:return u=n.sent().prefetchShellConfig,[4,r.e(707).then(r.bind(null,"iWxw"))];case 8:return s=n.sent().prefetchTemplatesConfig,[4,Promise.all([e(),t(),c(),i(),a(),o(),u(),s()])];case 9:return n.sent(),[2]}}))}))}},mJgL:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r("QjXU"),c=r("MJsD"),i=r("B5kz"),a=r("W7wX"),o=r("yNE0");function u(){var e=this;return i.a.fetchQuery(["FeatureSettings"],(function(){return Object(n.__awaiter)(e,void 0,void 0,(function(){var e,t,r;return Object(n.__generator)(this,(function(i){switch(i.label){case 0:return[4,Promise.all([Object(c.a)(),Object(a.a)()])];case 1:return e=n.__read.apply(void 0,[i.sent(),2]),t=e[0],r=e[1],[2,Object(o.a)(r,t)]}}))}))}),{staleTime:1/0,cacheTime:1/0})}},s1V1:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("QjXU"),c=r("MJsD"),i=r("B5kz"),a=r("W7wX"),o=r("+vVg"),u=r("bIL4");function s(){var e=this;return i.a.fetchQuery(u.b,(function(){return Object(n.__awaiter)(e,void 0,void 0,(function(){var e,t,r;return Object(n.__generator)(this,(function(i){switch(i.label){case 0:return[4,Promise.all([Object(c.a)(),Object(a.a)()])];case 1:return e=n.__read.apply(void 0,[i.sent(),2]),t=e[0],r=e[1],[2,Object(o.a)(r,t)]}}))}))}),{staleTime:1/0,cacheTime:1/0})}},vb0f:function(e,t,r){"use strict";function n(){return window.navigator.userAgent.toLowerCase().indexOf("msapphost/")>-1&&!!window.Windows}r.d(t,"a",(function(){return n}))},yNE0:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r("QjXU"),c=r("mgFK"),i=r("CRHC"),a=r("m32Q"),o=r("lkvL"),u=r("a3FV"),s=r("0TX8"),f=r("Wa5Y");function l(e,t,r,c,i,a,o){return Object(n.__awaiter)(this,void 0,void 0,(function(){var l,b,d;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:l={},b={method:"GET",responseType:"json",url:"".concat(c,"/api/featureSettings")},n.label=1;case 1:return n.trys.push([1,4,,5]),[4,Object(s.a)(b,r,i,t)];case 2:return n.sent(),[4,Object(f.a)(u.a.FeatureSettingsRequest,"FeatureSettings",b.url,b,o,a,c,e,"OfficeHome",{})];case 3:return(d=n.sent().data)?[2,d]:[3,5];case 4:return n.sent(),[3,5];case 5:return[2,l]}}))}))}var b="featureSettings";function d(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(c.a)(b,e)];case 1:return[2,t.sent()]}}))}))}function h(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(r){return[2,Object(i.a)((function(){return function(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var r;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,d(t)];case 1:return void 0!==(r=n.sent())?[3,3]:[4,l(t.correlationId,(function(){return Promise.resolve(e)}),t.inMockMode,t.officeHomeApiRoot,t.workload,t.getAccessToken,t.jwtAuthEnabled)];case 2:r=n.sent(),n.label=3;case 3:return[2,r]}}))}))}(e,t)}),(function(){return Object(a.a)({userId:e.puid,collectionName:b,collectionVersion:1,key:b})}),(function(t){return Object(o.a)({userId:e.puid,collectionName:b,collectionVersion:1,key:b,data:0===Object.keys(t).length?null:t})}))]}))}))}},yQST:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r("vb0f");function c(){var e=window.chrome;return e&&e.webview&&Object(n.a)()}}}]);
//# sourceMappingURL=northstar-prefetch-service.7208a3eb94c3306873b3.chunk.v7.js.map