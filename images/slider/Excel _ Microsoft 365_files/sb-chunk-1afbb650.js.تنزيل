(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["pro-site-spnews"],{Ytuu:function(e,t,r){"use strict";r.r(t),r.d(t,"registration",(function(){return b}));var n=r("+zb2"),i=r("rpSO"),o=r("KmCS"),a=r("F6lS"),c=r("POWj"),s=r("ohlq"),l=r("xo1z"),p=r("qGDX"),d=r("q9uV"),u=r("5crk");let h=class{constructor(e,t,r,n){this.searchBox=e,this.config=t,this.fetcher=r,this.conversation=n,this.conversationId=this.conversation&&this.conversation.conversationId}getId(){return"AnswerSuggestionProvider"}createStream(e){return Object(p.b)(this.fetcher,"People",{searchText:e,entityTypes:Object(d.b)(this.config,e),scenario:Object(l.a)(Object(s.a)()),appOverride:Object(c.a)(),logicalSearchId:this.conversation&&this.conversation.getLogicalSearchId("sb"),conversationId:this.conversationId}).take(1).select(e=>Object.assign(Object.assign({},e),{answerTexts:Object(u.a)(e)})).where(e=>!!e.PeopleIntent&&e.answerTexts.length>0).select(t=>({searchText:e,searchBox:this.searchBox,id:t.Id,answerTexts:t.answerTexts,jobTitle:t.JobTitle,displayName:t.DisplayName,userPrincipalName:t.UserPrincipalName,peopleIntent:t.PeopleIntent,logProps:t.logProps,originalLogicalSearchId:t.originalLogicalSearchId,originalConversationId:this.conversationId,entityType:"People"}))}};h=Object(n.__decorate)([Object(d.a)({entityType:"People"}),Object(n.__param)(0,Object(i.a)("searchBox")),Object(n.__param)(1,Object(i.a)("config")),Object(n.__param)(2,Object(i.a)("fetcher")),Object(n.__param)(3,Object(i.a)("conversation"))],h),t.default=h;const b=Object(o.regs)(`${a.a}.${h.prototype.getId()}`,h)},d9Ub:function(e,t,r){"use strict";r.r(t),r.d(t,"registration",(function(){return p}));var n=r("+zb2"),i=r("UlRC"),o=r("rpSO"),a=r("KmCS"),c=r("F6lS"),s=r("q9uV");let l=class{constructor(e,t,r){this.searchBox=e,this.conversationId=t&&t.conversationId,this.context=r}getId(){return"AnswerPersonDataProvider"}createStream(e){var t,r;const n=null===(r=null===(t=this.context)||void 0===t?void 0:t.commanding.currentCommand.values[0])||void 0===r?void 0:r.customProps;return i.Observable.fromPromise(Promise.resolve(n)).select(t=>({searchText:e,searchBox:this.searchBox,id:t.id,answerTexts:n.answerTexts,jobTitle:n.jobTitle,displayName:n.displayName,userPrincipalName:null==n?void 0:n.userPrincipalName,peopleIntent:null==n?void 0:n.peopleIntent,logProps:t.logProps,originalLogicalSearchId:t.originalLogicalSearchId,originalConversationId:this.conversationId}))}};l=Object(n.__decorate)([Object(s.a)({entityType:"People"}),Object(n.__param)(0,Object(o.a)("searchBox")),Object(n.__param)(1,Object(o.a)("conversation")),Object(n.__param)(2,Object(o.a)("context"))],l),t.default=l;const p=Object(a.regs)(`${c.a}.${l.prototype.getId()}`,l)},"yM/U":function(e,t,r){"use strict";r.r(t);var n=r("+zb2"),i=r("UlRC"),o=r("rpSO"),a=r("KmCS"),c=r("XgOi"),s=(r("Jvpx"),r("ohlq")),l=(r("6SpP"),r("eTzd")),p=r("DHVw"),d=r("/hiP");function u(e,t,r){return"".concat(r.sitePath,"/_api/search/query?QueryText='*'").concat(function(e){var t=e.departmentId,r=e.isHubSite;return"&QueryTemplate='({searchterms}) ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118*"+" AND PromotedState:2 AND ".concat((r&&t?b:h)(e),"'")}(r))+"&HitHighlightedProperties='Title'&StartRow=0&RowLimit=100"+"&Properties='ClientFunction:News,EnableMultiGeoSearch:".concat(e?"true":"false","'")+"&sortlist='LastModifiedTime:descending'&SelectProperties='ContentClass,ContentTypeId,DefaultEncodingURL,DocId,EditorOWSUSER,FileExtension,GeoLocationSource,LastModifiedTime,ModifiedBy,Path,SPWebUrl,SPSiteURL,SecondaryFileExtension,ServerRedirectedUrl,SiteId,Title,UniqueId,WebId'"+"&ClientType='".concat(t,"'&EnableQueryRules=false")}function h(e){var t=e.sitePath;return'Path:"'.concat(t,'"')}function b(e){var t=e.departmentId;return"(DepartmentId:".concat(t," OR DepartmentId:").concat(t.replace(/[{}]/g,""),")")}var m=Object(d.a)((function(e){return function(t){var r=t.clientId,i=t.site;return Object(p.a)({url:u(!0,r,i),method:"GET",headers:Object(n.__assign)({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},e?{Authorization:"Bearer ".concat(e)}:{})})}}),{monitorName:"sitenews-rawPrefetch",cacheId:"sitenews-rawPrefetch",cacheVersion:"0",cacheItemLifetime:9e5,cacheKeyExtractor:function(e){return{sitePath:e.site.sitePath}}}),v=r("RkML"),g=r("sUxJ");var f=r("F6lS").a+".sharePointSearchSiteNewsSuggestions";let O=class{constructor(e){this.site=e}getId(){return"SearchSiteNewsSuggestionProvider"}createStream(e){return this.site?(t={site:this.site,clientId:Object(s.a)()},r=t.clientId,n=t.site,o=Object(g.a)(v.a),i.Observable.fromPromise(m({clientId:r,site:n,tokenProvider:Object(l.g)()})).select((function(e){return JSON.parse(e.xhr.responseText)})).select((function(e){return o(e)})).cache("mssearchux-cache-sitenews-mapped",{key:n.sitePath},"1.0.0",9e5,(function(){return!1}))).select(e=>e.value).selectMany(e=>i.Observable.fromArray(e)).specFilter(e,new c.a):i.Observable.empty();var t,r,n,o}};O=Object(n.__decorate)([Object(n.__param)(0,Object(o.a)("site"))],O);t.default=O;Object(a.regs)(f,O)},"yY+F":function(e,t,r){"use strict";var n=r("+zb2"),i=r("/krt"),o=r("NaTl"),a=r("wAGM"),c=r("x/lg");var s=r("Ak5F"),l=r("fVGf"),p={word:["doc","docx","docm","dot","dotx"],excel:["xls","xlsx","xlsm","xlsb","xltm","xlam"],powerpoint:["ppt","pptx","pptm"],video:["wmv","avi","mpg","asf","mp4","ogg","ogv","webm","mov"],image:["bmp","dib","jpg","jpeg","png","gif","rle","wmf","ico","wpd","odg","tiff"],pdf:["pdf"],onenote:["one"]},d=Object(l.a)(p,(function(e,t,r){return t.forEach((function(t){return e[t]=r})),e}),{});function u(e){return d[e]||"other"}function h(e){var t,r;Object(s.a)((t="FileClickedWithExtension",r={fileType:u(e)},{eventType:"USAGE",name:"generic_event",nameDetail:t,properties:{eventData:JSON.stringify(r)}}))}var b=r("pgot"),m=r("Du1W"),v=r("zt+T"),g=r("Dxhy"),f=r("j4bS"),O=r("OJcW"),j=r("ljXs"),y=r("SwU+"),x=r("Jd8/"),I=r("Icem"),T=r("UqTr"),P=r("cDcd"),_=r("gp5W"),S=r("y1hr"),w=r("X+5C"),C=r("3lF4"),E=r("npGR"),N=function(e){function t(t){var r=e.call(this,t)||this;return r.state={previewPanelVisible:!1},r}var r;return Object(n.__extends)(t,e),r=t,t.isHitHighlighted=function(e){return!Object(O.b)(e)&&e.indexOf("<mark>")>=0},t.getFileIconType=function(e){return"Folder"===e?y.a.folder:y.a.genericFile},t.prototype.render=function(){var e=this,t=this.props,a=t.fileExtension,s=t.icon,l=t.iconName,p=t.tidbitIconName,d=r.getFileIconType(this.props.fileType||""),u=Object(E.a)(this.props.theme),h=null;if(s)h=P.createElement("img",{className:"".concat(u.fileIcon," ").concat(u.icon),src:s,alt:""});else if(l)h=P.createElement(x.a,{className:"".concat(u.fileIcon," ").concat(u.icon),iconName:l});else{var v=Object(c.b)(a||"",Object(b.a)()?S.b:S.c,void 0,d),g=Object(c.a)(v,a),f=m.c({ext:g});h=P.createElement("div",null,P.createElement("span",{className:u.offScreen},f),P.createElement(x.a,Object(n.__assign)({},v,{"aria-hidden":"true",className:u.fileIcon})))}var O=P.createElement("div",{className:u.iconWrapper},h),y=this.getTidbits(),T="FileSuggestionsQuickActions_".concat(Object(j.a)());return P.createElement(w.a,{theme:this.props.theme,displayText:this.props.displayTextRaw||I.a.getTextFromHtml(this.props.displayText)},P.createElement(o.a,null,(function(){var t;return P.createElement("a",{href:e.props.url,target:"_blank",className:u.suggestion,onClick:e.onClick,onContextMenu:e.onContextMenu,"aria-describedby":T,rel:"noreferrer"},O,P.createElement("div",{className:u.textWrapper},P.createElement("div",{className:u.displayText,"data-tooltip":!0},P.createElement(i.a,{markType:"mark",text:e.props.displayText,highlightCssClass:u.highlighted}),P.createElement("span",{className:u.offScreen},",")),P.createElement(C.a,Object(n.__assign)({},{tidbits:y,styles:u,theme:e.props.theme,tidbitIcons:[p?{icon:p,ariaLabel:null===(t=e.props.customProps)||void 0===t?void 0:t.tidbitIconLabel}:void 0]}))),P.createElement(_.a,{entityId:e.props.id,customProps:{fileUrl:e.props.url,sPWebUrl:e.props.sPWebUrl,uniqueId:e.props.uniqueId},onClick:function(t,r){var n,i;return null===(i=(n=e.props).dispatchImpressionClick)||void 0===i?void 0:i.call(n,t,{commandId:r.id})},entityType:"File",theme:e.props.theme,describedById:T}))})))},t.prototype.getTidbits=function(){var e=[];return Object(O.b)(this.props.secondaryDisplayText)||e.push(this.props.secondaryDisplayText||""),Object(O.b)(this.props.tertiaryDisplayText)||e.push(this.props.tertiaryDisplayText||""),e.length>1&&r.isHitHighlighted(this.props.tertiaryDisplayText||"")&&!r.isHitHighlighted(this.props.secondaryDisplayText||"")?e.reverse():Object(T.a)(e)},t.prototype.onFilePreviewOpen=function(e){var t,r,n,i;null===(r=(t=this.props).onClick)||void 0===r||r.call(t,e),null===(i=(n=this.props).onOpen)||void 0===i||i.call(n,e)},t.prototype.onFilePreviewClose=function(e){var t,r;null===(r=(t=this.props).onClose)||void 0===r||r.call(t,e)},t.prototype.onClick=function(e){var t,r;null===(r=(t=this.props).onClick)||void 0===r||r.call(t,e),h(this.props.fileExtension||""),e.currentTarget.blur()},t.prototype.onContextMenu=function(){h(this.props.fileExtension||"")},t.prototype.onQuickActionClick=function(){},t.defaultProps={onClick:function(){return null},onMouseEnter:function(){return null},onMouseLeave:function(){return null}},Object(n.__decorate)([v.a,Object(g.a)()],t.prototype,"onFilePreviewOpen",null),Object(n.__decorate)([v.a,Object(g.a)()],t.prototype,"onFilePreviewClose",null),Object(n.__decorate)([v.a,Object(g.a)(),f.a],t.prototype,"onClick",null),Object(n.__decorate)([v.a,Object(g.a)()],t.prototype,"onContextMenu",null),Object(n.__decorate)([v.a,Object(g.a)(),f.a],t.prototype,"onQuickActionClick",null),t=r=Object(n.__decorate)([Object(a.a)("FileSuggestion")],t)}(P.Component);t.a=N}}]);