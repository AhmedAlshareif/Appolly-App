(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[62],{I0st:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a("CDuu"),n=a("gy05");function o(){return Object(r.a)(n.a)}},"Pd+Y":function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var r=a("QjXU"),n=a("8wW2"),o=a("a3FV"),i=a("0TX8"),c=a("Wa5Y"),s=a("mpo9");function u(e,t,a,u){var d=this;return void 0===a&&(a=!1),void 0===u&&(u=1),new Promise((function(l,f){return Object(r.__awaiter)(d,void 0,void 0,(function(){var d,p,v,b,m;return Object(r.__generator)(this,(function(h){switch(h.label){case 0:return(d=Object(s.b)()).hasOwnProperty(e)&&!a?(p=Array.isArray(d[e])?d[e]:Object(r.__assign)({},d[e]),l(p),[2]):Object(s.c)()||u<1?(l(void 0),[2]):[4,t.getIdentity()];case 1:return v=h.sent(),t.jwtAuthEnabled&&v.isMsa?(f("User storage does not support roaming"),[2]):(b={},[4,Object(i.a)(b,t.inMockMode,t.workload,t.getIdentity)]);case 2:return h.sent(),m=0,Object(c.a)(o.a.OfficeHomeStorageReadRequest,"OfficeHomeStorage_Read","".concat(t.officeHomeApiRoot,"/api/userstorage/").concat(e,"/"),b,t.jwtAuthEnabled,t.getAccessToken,t.officeHomeApiRoot,t.correlationId,"OfficeHome",{populateRequestEvent:function(t,a){a.ElementId=e,a.Retry=(m++).toString()},isRetriableError:function(e){return 404!==e&&403!==e}}).then((function(t){t.data&&(d[e]=Array.isArray(t.data)?t.data:Object(r.__assign)({},t.data)),l(t.data)})).catch((function(t){Object(n.a)().handleError(t,"Bn3rc"),t&&t.httpResponse&&404===t.httpResponse.status?l(void 0):f("Failed to get value from user data storage for <".concat(e,"> key."))})),[2]}}))}))}))}},QHw4:function(e,t,a){"use strict";var r;a.d(t,"a",(function(){return r})),function(e){e.M365AppsPageRootPath="/m365apps/",e.StartPageRootPath="/launch/",e.TemplatePageRootPath="/template/",e.WacHostPagePath="/content"}(r||(r={}))},"Yh/z":function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var r=a("QjXU"),n=a("8wW2"),o=a("muUJ"),i=a("a3FV"),c=a("CMIS"),s=a("0TX8"),u=a("cy7S"),d=a("oK0o"),l=a("mpo9");function f(e,t,a){var f=this;return new Promise((function(p,v){return Object(r.__awaiter)(f,void 0,void 0,(function(){var f,b,m;return Object(r.__generator)(this,(function(h){switch(h.label){case 0:return Object(l.b)()[e]=Array.isArray(t)?t:Object(r.__assign)({},t),[4,a.getIdentity()];case 1:if(f=h.sent(),a.jwtAuthEnabled&&f.isMsa)return v("User storage does not support roaming"),[2];if(b={headers:{}},!a.inMockMode&&!a.jwtAuthEnabled){if(!(m=d.get("AjaxSessionKey")))return Object(o.a)(i.a.CsrfTokenError),Object(c.a)({eventName:"Csrf_Token",errorType:"User_Storage_Error"}),v("CSRF token missing"),[2];b.headers.AjaxSessionKey=m}return[4,Object(s.a)(b,a.inMockMode,a.workload,a.getIdentity)];case 2:return h.sent(),Object(u.a)(i.a.OfficeHomeStorageWriteRequest,"OfficeHomeStorage_Write","".concat(a.officeHomeApiRoot,"/api/userstorage/").concat(e,"/"),t,b,a.jwtAuthEnabled,a.getAccessToken,a.officeHomeApiRoot,a.correlationId,"OfficeHome",{populateRequestEvent:function(t,a){a.ElementId=e}}).then((function(){return p()})).catch((function(t){Object(n.a)().handleError(t,"J7GBR"),v("Failed to update or create value in roaming user data storage for <".concat(e,"> key."))})),[2]}}))}))}))}},aXh0:function(e,t,a){"use strict";a.d(t,"a",(function(){return O}));var r=a("QjXU"),n=a("NZpx"),o=a("NrNW"),i=a("8wW2"),c=a("muUJ"),s=a("a3FV"),u=a("CMIS"),d=a("Pd+Y"),l=a("Yh/z"),f=a("mXGw"),p=a("elnK"),v=a.n(p),b=a("v5sg"),m=a("y7UN"),h="AppBarUserData";function g(e){var t=e.inMockMode,a=e.jwtAuthEnabled,r=e.officeHomeApiRoot;return{correlationId:e.correlationId,getAccessToken:e.getAccessToken,getIdentity:e.getIdentity,inMockMode:void 0!==t&&t,jwtAuthEnabled:void 0!==a&&a,officeHomeApiRoot:void 0===r?"":r,workload:e.workload}}function j(e){return Object(d.a)(h,e)}var w=v()((function(e){return{userData:void 0,setUserData:function(t){e({userData:t})}}})),O=function(){var e=w(),t=e.userData,a=e.setUserData,d=Object(n.a)().data,p=Object(o.a)().data,v=Object(b.a)(),O=Object(m.a)();f.useEffect((function(){var e=!0;return function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,o,i,c,s,u,l,f,b,m;return Object(r.__generator)(this,(function(h){switch(h.label){case 0:return(null==d?void 0:d.appBarPinningEnabled)&&p&&v?[4,j(g(p))]:[3,2];case 1:if(t=h.sent(),n=d.appBarDefaultPinSet,o=1,void 0!==O&&(t=void 0,n=O),n&&(o=2,1===(null==t?void 0:t.version)&&(t=void 0)),!t){i=[];try{for(c=Object(r.__values)(v),s=c.next();!s.done;s=c.next())l=(u=s.value).id,void 0!==(f=u.pinnedIndex)&&i.push({id:l,pinnedIndex:f,pinSource:"DefaultPinned"})}catch(e){b={error:e}}finally{try{s&&!s.done&&(m=c.return)&&m.call(c)}finally{if(b)throw b.error}}t={version:o,lastModifiedTimeUtc:Date.now(),pinnedApps:i}}e&&a(t),h.label=2;case 2:return[2]}}))}))}().catch((function(e){var t;Object(i.a)().handleError(e);var a="Error reading app bar user data: ".concat(e);Object(c.a)(s.a.AppBarUserDataReadError,((t={}).Error=a,t)),Object(u.a)({eventName:s.a.AppBarUserDataReadError,errorType:"AppBar_UserData_Error",message:a})})),function(){e=!1}}),[d,p,v,O,a]);var y=f.useCallback((function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){return p&&(t=g(p),function(e,t){return Object(l.a)(h,e,t)}(e=Object(r.__assign)(Object(r.__assign)({},e),{lastModifiedTimeUtc:Date.now()}),t).then((function(){a(e)})).catch((function(e){var t;Object(i.a)().handleError(e);var a="Error writing app bar user data: ".concat(e);Object(c.a)(s.a.AppBarUserDataWriteError,((t={}).Error=a,t)),Object(u.a)({eventName:s.a.AppBarUserDataWriteError,errorType:"AppBar_UserData_Error",message:a})}))),[2]}))}))}),[p,a]);return f.useMemo((function(){return[t,y]}),[t,y])}},cy7S:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("QjXU"),n=a("kb6k"),o=a("lAHu");function i(e,t,a,i,c,s,u,d,l,f,p){void 0===p&&(p={});var v=Object(r.__assign)(Object(r.__assign)({},c),{url:a,method:"PUT",body:i});return Object(n.a)((function(a){return Object(o.a)(e,t,a,d,l,void 0,p.populateRequestEvent,p.onUploadProgress,p.onDownloadProgress,p.cancellationToken,p.timeoutInMs)}),e,t,v,s,u,f,p.mockParam,p.resourceUrl,p.rpsHeaderPrefix,p.additionalAuthErrors,p.isRetriableError,p.updateRequestWithAuth)}},gy05:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a("QjXU"),n=a("mgFK"),o={key:"Workloads",getServerGeneratedConfig:function(e){return function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(a){switch(a.label){case 0:return[4,Object(n.a)("workloadsData",e)];case 1:if(!(t=a.sent()))throw new Error("Cannot parse workloadsData");return[2,t]}}))}))}(e)}}},mpo9:function(e,t,a){"use strict";a.d(t,"b",(function(){return d})),a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return f}));var r,n,o,i=a("E7ar"),c=a("8wW2"),s=!1;function u(){if(!s){s=!0;var e=void 0;try{e=Object(i.a)("userStorageCache")}catch(e){Object(c.a)().handleError(e)}r=e?e.content:{},n=!!e&&e.firstUse,o=e?e.firstUseTimestamp:0}}function d(){return u(),r}function l(){return u(),n}function f(){return u(),o}},oK0o:function(e,t,a){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function n(e,t){if(!t)return"";var a="; "+e;return!0===t?a:a+"="+t}function o(e,t,a){return encodeURIComponent(e).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/\(/g,"%28").replace(/\)/g,"%29")+"="+encodeURIComponent(t).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent)+function(e){if("number"==typeof e.expires){var t=new Date;t.setMilliseconds(t.getMilliseconds()+864e5*e.expires),e.expires=t}return n("Expires",e.expires?e.expires.toUTCString():"")+n("Domain",e.domain)+n("Path",e.path)+n("Secure",e.secure)+n("SameSite",e.sameSite)}(a)}function i(e){for(var t={},a=e?e.split("; "):[],r=/(%[\dA-F]{2})+/gi,n=0;n<a.length;n++){var o=a[n].split("="),i=o.slice(1).join("=");'"'===i.charAt(0)&&(i=i.slice(1,-1));try{t[o[0].replace(r,decodeURIComponent)]=i.replace(r,decodeURIComponent)}catch(e){}}return t}function c(){return i(document.cookie)}function s(e,t,a){document.cookie=o(e,t,r({path:"/"},a))}t.__esModule=!0,t.encode=o,t.parse=i,t.getAll=c,t.get=function(e){return c()[e]},t.set=s,t.remove=function(e,t){s(e,"",r(r({},t),{expires:-1}))}},v5sg:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var r=a("QjXU"),n=a("4PWS"),o=a("NZpx"),i=a("CU8J"),c=a("CaQ9"),s=a("QHw4"),u=a("Coo+"),d=a("I0st"),l=a("mXGw"),f=a("elnK"),p=a.n(f),v=a("jVk8"),b=a("y7UN"),m=p()((function(e){return{hubAppData:void 0,setHubAppData:function(t){e({hubAppData:t})}}})),h=function(){var e,t,a=Object(c.a)().data,f=Object(u.a)().data,p=Object(d.a)().data,h=Object(o.a)().data,g=Object(i.a)().data,j=Object(b.a)(),w=m(),O=w.hubAppData,y=w.setHubAppData;return l.useEffect((function(){var e,t,o,i,c,u,d,l;if(a&&(null==f?void 0:f.result)&&p&&h){var b=a.isMsa,m=b?new Map([[n.a.home,!1],[n.a.create,!1],[n.a.mycontent,!1],[n.a.feed,!1],[n.a.appgallery,!1],[n.a.word,!1],[n.a.excel,!1],[n.a.powerpoint,!1],[n.a.outlook,!1],[n.a.onedrive,!1],[n.a.teams,!1],[n.a.onenote,!1],[n.a.todo,!1],[n.a.familysafety,!1],[n.a.calendar,!1],[n.a.skype,!1],[n.a.forms,!1],[n.a.sway,!1],[n.a.admin,!1],[n.a.people,!1],[n.a.powerautomate,!1],[n.a.clipchamp,!1],[n.a.lists,!1],[n.a.bing,!1],[n.a.msn,!1],[n.a.privacy,!1],[n.a.rewards,!1]]):new Map([[n.a.home,!1],[n.a.create,!1],[n.a.mycontent,!1],[n.a.feed,!1],[n.a.appgallery,!1],[n.a.admin,!1],[n.a.outlook,!1],[n.a.teams,!1],[n.a.word,!1],[n.a.excel,!1],[n.a.powerpoint,!1],[n.a.onenote,!1],[n.a.forms,!1],[n.a.sway,!1],[n.a.visio,!1],[n.a.stream,!1],[n.a.whiteboard,!1]]);(null===(i=null===(o=null==g?void 0:g.result)||void 0===o?void 0:o.orionGates)||void 0===i?void 0:i.orionEnabled)&&m.set(n.a.orion,!1);var w=f.result,O=w.IsAdmin,_=w.IsEdu,A=w.IsEduFaculty;switch(null!=j?j:h.appBarDefaultPinSet){case"A":O&&m.set(n.a.admin,!0);break;case"B":b?(m.set(n.a.outlook,!0),m.set(n.a.word,!0),m.set(n.a.excel,!0)):(O&&m.set(n.a.admin,!0),A?(m.set(n.a.outlook,!0),m.set(n.a.word,!0),m.set(n.a.forms,!0)):_?(m.set(n.a.outlook,!0),m.set(n.a.word,!0),m.set(n.a.powerpoint,!0)):(m.set(n.a.outlook,!0),m.set(n.a.word,!0),m.set(n.a.excel,!0)));break;case"C":b?(m.set(n.a.clipchamp,!0),m.set(n.a.forms,!0),m.set(n.a.lists,!0)):(O&&m.set(n.a.admin,!0),_?(m.set(n.a.onenote,!0),m.set(n.a.forms,!0),m.set(n.a.stream,!0)):(m.set(n.a.visio,!0),m.set(n.a.yammer,!0),m.set(n.a.powerbi,!0)));break;case"D":default:b?(m.set(n.a.word,!0),m.set(n.a.excel,!0),m.set(n.a.powerpoint,!0),m.set(n.a.outlook,!0),m.set(n.a.onedrive,!0),m.set(n.a.teams,!0),m.set(n.a.onenote,!0)):(O&&m.set(n.a.admin,!0),m.set(n.a.outlook,!0),m.set(n.a.teams,!0),m.set(n.a.word,!0),m.set(n.a.excel,!0),m.set(n.a.powerpoint,!0),_&&m.set(n.a.onenote,!0),A&&m.set(n.a.forms,!0));break;case"E":b&&(m.set(n.a.word,!0),m.set(n.a.excel,!0),m.set(n.a.powerpoint,!0))}var E=Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(p.coreAndSegmentApps),!1),Object(r.__read)(p.nonCoreAndSegmentApps),!1),k=function(e){var t=Object(v.a)(e,b);t&&(E.find((function(e){return e.Id===t}))||m.delete(e))};try{for(var U=Object(r.__values)(Array.from(m.keys())),D=U.next();!D.done;D=U.next())k(D.value)}catch(t){e={error:t}}finally{try{D&&!D.done&&(t=U.return)&&t.call(U)}finally{if(e)throw e.error}}if(h.appBarOverflowOnlyEnabled||m.delete(n.a.appgallery),h.myContentEnabled||m.delete(n.a.mycontent),h.feedEnabled||m.delete(n.a.feed),(null===(c=h.startPageAppsArray)||void 0===c?void 0:c.includes("visio"))||m.delete(n.a.visio),(null===(u=h.startPageAppsArray)||void 0===u?void 0:u.includes("whiteboard"))||m.delete(n.a.whiteboard),null===(d=h.startPageAppsArray)||void 0===d?void 0:d.includes("stream")){var R=null===(l=E.find((function(e){return"ShellMicrosoftStream"===e.Id})))||void 0===l?void 0:l.Url;!(null==R?void 0:R.includes(s.a.StartPageRootPath))&&m.delete(n.a.stream)}else m.delete(n.a.stream);var I=0;y(Array.from(m).map((function(e){var t=Object(r.__read)(e,2);return{id:t[0],pinnedIndex:t[1]?I++:void 0}})))}}),[j,a,f,p,h,y,null===(t=null===(e=null==g?void 0:g.result)||void 0===e?void 0:e.orionGates)||void 0===t?void 0:t.orionEnabled]),O}},y7UN:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a("Ot9e"),n=a("mXGw");function o(){return n.useMemo((function(){return Object(r.a)(location.search).appBarDefaultPinSetOverride}),[])}}}]);
//# sourceMappingURL=62.9216814552692b9d327e.chunk.v7.js.map