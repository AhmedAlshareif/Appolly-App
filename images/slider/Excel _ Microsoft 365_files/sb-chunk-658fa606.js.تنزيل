(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["cpl-answerproviderhost~pro-3s-factanswer~pro-3s-factsuggestion~pro-3s-pplkw~pro-3s-univbestmatch~pro~d7ccd496"],{"2VtW":function(e,t,r){"use strict";function n(e){return function(e){return e&&e.Instrumentation||{TraceId:"-1",InstUrlBase:"-1"}}(e).TraceId||"-1"}r.d(t,"a",(function(){return n}))},"2qGI":function(e,t,r){"use strict";var n=r("+zb2"),a=r("bWJB"),s=r("HySD"),c=r("LLyz"),i=r("OJcW"),o=r("UlRC");r("6SpP"),r("PWby");function u(e,t){var r=Object(i.d)(JSON.stringify(e));return t?Math.abs(r)%t:r}function d(e){var t=e.value,r=t.correlationID,n=t.logicalSearchId,i=t.conversationId,o=e.streamState;return Object(a.a)(r)||Object(c.a)("Invalid correlation type or id. Extraction refused."),Object(s.a)(b,o)||Object(c.a)("Invalid stream state. Extraction refused."),{correlationID:r,streamState:o,logicalSearchId:n,conversationId:i}}var b=["New","Pending","Complete"],l=r("KmCS"),g=Object(l.regs)("searchux.suggestionCacheTTL",6e5,{required:!1,tags:["global"]}),h=Object(l.regs)("searchux.suggestionsCachePartitionByKey",!0,{required:!1,tags:["global"]}),O=Object(l.regs)("searchux.suggestionsCacheNumPartitions",15,{required:!1,tags:["global"]}),v=void 0,j=function(){return function(e,t,r){var a=e.cacheId,s=e.cacheVersion,c=e.cacheKeyExtractor,i=e.cacheRefreshIntervalMs,b=e.cacheIncludeKeyInId,l=e.cacheNumKeyPartitions,g=e.extendedMode;return function(){for(var e=[],h=0;h<arguments.length;h++)e[h]=arguments[h];var O=Object(n.__read)(e),v=O[0],j=O.slice(1),f=g?j:e,p=g?v:{},I=c.apply(void 0,Object(n.__spreadArray)([],Object(n.__read)(f),!1)),_=t.apply(void 0,Object(n.__spreadArray)([],Object(n.__read)(f),!1)).cache(b?a+u(I,l):a,I,s,i,(function(e){return e.skipCache})).monitorBasic(Object(n.__assign)({nameDetail:a,isHot:!1},p),d);return r?_.catchException((function(){return o.Observable.returnValue({value:r,streamState:"New"})})):_}}({cacheId:"mssearchux-cache-3sqf",cacheVersion:"1.0.0",cacheRefreshIntervalMs:g(),cacheIncludeKeyInId:h(),cacheNumKeyPartitions:O(),cacheKeyExtractor:function(e,t){e.logicalSearchId,e.conversationId;var r=Object(n.__rest)(e,["logicalSearchId","conversationId"]);return Object(n.__assign)(Object(n.__assign)({},Object(n.__assign)(Object(n.__assign)({},r),{suggestionGroups:void 0})),{entityTypes:(r.entityTypes||[]).join("|")})}},(function(e,t){return t(e)}))};t.a=function(e,t){return v||(v=j()),v(e,t)}},Fjw7:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n="https://substrate.office.com"},FzQG:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r("+zb2"),a=r("B8KU"),s=r("CVAo"),c=r("UlRC"),i=r("fTUD"),o=r("pDa8"),u=r("KmCS"),d=Object(u.regs)("searchux.siteId","",{required:!1,tags:["session","deprecated"]}),b=Object(u.regs)("searchux.webId","",{required:!1,tags:["session","deprecated"]}),l=r("2VtW"),g=r("25hB"),h=Object(u.regs)("searchux.enableUserContextUrlForSuggestions",!1),O=Object(u.regs)("searchux.enableInstanceIdForSuggestions",!1);function v(e){return function(t){var r,u,v,j,f=(h()||O())&&(null===(j=null===(v=null===(u=null===(r=Object(g.c)())||void 0===r?void 0:r.props)||void 0===u?void 0:u.scenarioContext)||void 0===v?void 0:v.warmupSubstrateSearchContextOptions)||void 0===j?void 0:j.queryStringParameters),p=null==f?void 0:f.userContextUrl,I=null==f?void 0:f.instanceId;return c.Observable.fromPromise(e(function(e){var t=e.searchText,r=e.entityTypes,c=e.appOverride,i=e.scenario,u=e.userContextUrl,l=Object(s.a)(),g=new a.a(a.a.concatenate(o.b,"suggestions"));return g.setQueryFromObject(Object(n.__assign)({query:t,entityTypes:r&&r.join(","),cvid:l,clientappoverride:c,scenario:i,webId:b(),siteId:d()},h()&&u&&{userContextUrl:u})),g.toString()}(Object(n.__assign)({userContextUrl:p},t)),{headers:Object(n.__assign)({accept:"application/json"},O()&&I&&{"X-Tenant-Instance-Id":I})}).then((function(e){var t="-1",r="Unknown",a="Unknown",s="Unknown",c="Unknown",o=""!==Object(i.b)();try{t=e.headers.get("x-end2endlatencyms")||"-2",r=e.headers.get("x-calculatedbetarget")||"NotProvided",a=e.headers.get("request-id")||"NotProvided",s=e.headers.get("x-msedge-ref")||"NotProvided",c=e.headers.get("x-besku")||"NotProvided"}catch(e){}var u={status:e.status,serverLatency:parseInt(t),serverName:r,requestId:a,msEdgeReference:s,anchorMailboxSet:o,xBeSku:c};return e.json().then((function(e){return Object(n.__assign)(Object(n.__assign)({},u),{body:e,correlationID:Object(l.a)(e),sprequestduration:"-1"})}))})))}}var j=r("LLyz"),f=r("3WoE"),p=r("GFGo"),I=r("kKJH");function _(e){var t=e.searchText,r=e.entityTypes,a=e.scenario,c=e.appOverride,u=e.site,v=e.logicalSearchId,_=e.conversationId;return Object(I.a)(Object(o.a)(),(function(){return{url:t,method:"IFRAME"}}),(function(e){var t,o,l,j,p=e.headers,I=e.url,m=u&&u.webId?u.webId:b(),y=u&&u.siteId?u.siteId:d(),x=p.Authorization.replace("Bearer ","")||{},S=v||Object(s.a)(),C=(h()||O())&&(null===(j=null===(l=null===(o=null===(t=Object(g.c)())||void 0===t?void 0:t.props)||void 0===o?void 0:o.scenarioContext)||void 0===l?void 0:l.warmupSubstrateSearchContextOptions)||void 0===j?void 0:j.queryStringParameters),w=null==C?void 0:C.userContextUrl,q=null==C?void 0:C.instanceId,U=Object(n.__assign)(Object(n.__assign)(Object(n.__assign)(Object(n.__assign)(Object(n.__assign)(Object(n.__assign)(Object(n.__assign)({},a&&{scenario:a}),r&&{entityTypes:r.join(",")}),c&&{clientAppOverride:c}),m&&{webId:m}),y&&{siteId:y}),{logicalId:S}),h()&&w&&{userContextUrl:w});return Object(i.c)({action:"getsuggestions",dataSource:"mssearchux-cache-3sqf",token:x,query:I,cvid:_||Object(s.a)(),logicalSearchId:S,isResponseOk:f.a,additionalInfo:U,additionalHeaders:Object(n.__assign)({},O()&&q&&{"X-Tenant-Instance-Id":q}),disableIframe:!1})})).select((function(e){var t=Object(p.a)(e,Object(i.b)()),r=e.parsedBody;return r||Object(j.a)("Failed to parse JSON"),Object(n.__assign)(Object(n.__assign)({},t),{correlationID:Object(l.a)(r),sprequestduration:"-1",logicalSearchId:v,conversationId:_,body:r})}))}function m(e){return e?v(e):_}},POWj:function(e,t,r){"use strict";var n=r("KmCS");t.a=Object(n.regs)("searchux.substrateSuggestionsClientAppOverride","",{required:!1,tags:["session"]})},TNbh:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("KmCS"),a=r("UqTr"),s=Object(n.regs)("searchux.substrateSearchClientFlights",""),c=Object(n.regs)("searchux.substrateSearchClientFlightsV2",{});function i(){var e=s().split(",").map((function(e){return e.trim()})).filter((function(e){return e.length>0})),t=c();for(var r in t)e.push(r);return Object(a.a)(e).join(",")}},fTUD:function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"c",(function(){return g})),r.d(t,"b",(function(){return h}));var n=r("+zb2"),a=(r("O38G"),r("UlRC")),s=r("GFGo"),c=r("GJi/"),i=r("25hB"),o=r("qTII"),u=r("KGPt"),d=r("KmCS"),b=r("TNbh"),l=Object(d.regs)("searchux.substrateDiagnosticsLogging",!1);Object(d.regs)("searchux.substrateDiagnosticsWithoutId",!1);function g(e){var t,r=e.action,c=e.dataSource,d=e.token,g=e.query,O=e.cvid,v=e.logicalSearchId,j=e.isResponseOk,f=e.additionalInfo,p=e.additionalHeaders,I=e.disableIframe,_=e.reuseIframe;return a.Observable.fromPromise(Object(s.b)({action:r,dataSource:c,token:d,query:g,cvid:O,logicalSearchId:v,additionalInfo:f,additionalHeaders:p,anchorMailbox:h(),locale:Object(o.b)(),substrateSearchClientFlights:Object(b.a)(),logDiagnosticsMetrics:l(),substrateHostName:Object(u.a)(Object(i.c)()),substrateHostNameWithIFrame:!I,reuseIframe:_})).select((function(e){return Object(n.__assign)(Object(n.__assign)({},e),{status:e.statusCode,clientLatency:Math.round(performance.now())-t})})).doAction((function(e){var t=e.status;if(!j(t))throw{status:t}})).catchException((function(e){if(e&&void 0!==e.statusCode)return a.Observable.returnValue(e);throw e})).onSubscribe((function(){return t=Math.round(performance.now())}))}function h(){return Object(c.c)()||Object(c.b)()||Object(c.a)()||""}},pDa8:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return u}));var n=r("B8KU"),a=r("e24R"),s=r("Fjw7"),c=n.a.concatenate(s.a,"search"),i=n.a.concatenate(c,"api/v1"),o=(n.a.concatenate(c,"api/v2"),n.a.concatenate(s.a,"autosuggest/api/v1")),u=(n.a.concatenate(o,"query"),Object(a.a)("autoSuggest"));Object(a.a)("delegateAutoSuggest")}}]);