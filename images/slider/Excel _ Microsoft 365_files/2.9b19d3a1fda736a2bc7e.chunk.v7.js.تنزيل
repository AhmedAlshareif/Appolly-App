(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[2],{"0TX8":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("QjXU"),a=n("JYsJ");function o(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:e.params||(e.params={}),e.params.workload=n,(c=Object(a.a)("flight"))&&(e.params.flight=c),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,o()];case 2:return(i=r.sent())&&(e.headers||(e.headers={}),e.headers["X-OfficeHome-UserId"]=i.puid,e.headers["X-OfficeHome-TenantId"]=i.tenantId,e.params[t?"mockauth":"auth"]=i.isMsa?"1":"2"),[3,4];case 3:return r.sent(),[3,4];case 4:return[2,e]}}))}))}},CRHC:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("QjXU");function a(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,o,c,i;return Object(r.__generator)(this,(function(r){return a=e(),o=t(),c=o.then((function(e){return e?{result:e,fromPersistence:!0}:null}),(function(){return null})),i=a.then((function(e){return n(e),{result:e,fromPersistence:!1}})),[2,Promise.race([c,i]).then((function(e){return e||i}),(function(){return c.then((function(e){return e||i}))}))]}))}))}},E7ar:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("tjsK");function a(e){try{return function(e){var t=document.getElementById(e),n=t&&t.textContent;return n?JSON.parse(n):void 0}(e)}catch(t){throw new r.a("Failure to parse "+e+" from response",t)}}},JYsJ:function(e,t,n){"use strict";function r(e){return new URLSearchParams(window.location.search).get(e)}n.d(t,"a",(function(){return r}))},Wa5Y:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("QjXU"),a=n("kb6k"),o=n("lAHu");function c(e,t,n,c,i,s,u,f,d,l,h){void 0===l&&(l={});var v="cache-only"===h;v&&(d="None");var m=Object(r.__assign)(Object(r.__assign)({},c),{url:n,method:"GET"});return Object(a.a)((function(n){return Object(o.a)(e,t,n,u,f,h,l.populateRequestEvent,l.onUploadProgress,l.onDownloadProgress,l.cancellationToken,l.timeoutInMs)}),e,t,m,i,s,d,l.mockParam,l.resourceUrl,l.rpsHeaderPrefix,l.additionalAuthErrors,l.isRetriableError,l.updateRequestWithAuth,v,l.silent,l.capDialogData)}},XcEc:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n("QjXU"),a=n("mgFK"),o=n("CRHC"),c=n("m32Q"),i=n("lkvL"),s=n("a3FV"),u=n("0TX8"),f=n("Wa5Y");function d(e,t,n,a,o,c,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var d,l,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:d={},l={method:"GET",responseType:"json",url:"".concat(a,"/api/featureGates")},r.label=1;case 1:return r.trys.push([1,4,,5]),[4,Object(u.a)(l,n,o,t)];case 2:return r.sent(),[4,Object(f.a)(s.a.FeatureGatesRequest,"FeatureGates",l.url,l,i,c,a,e,"OfficeHome",{})];case 3:return(h=r.sent().data)?[2,h]:[3,5];case 4:return r.sent(),[3,5];case 5:return[2,d]}}))}))}var l="featureGates";function h(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(a.a)(l,e)];case 1:return[2,t.sent()]}}))}))}function v(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){return[2,Object(o.a)((function(){return function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,h(t)];case 1:return void 0!==(n=r.sent())?[3,3]:[4,d(t.correlationId,(function(){return Promise.resolve(e)}),t.inMockMode,t.officeHomeApiRoot,t.workload,t.getAccessToken,t.jwtAuthEnabled)];case 2:n=r.sent(),r.label=3;case 3:return[2,n]}}))}))}(e,t)}),(function(){return Object(c.a)({userId:e.puid,collectionName:l,collectionVersion:1,key:l})}),(function(t){return Object(i.a)({userId:e.puid,collectionName:l,collectionVersion:1,key:l,data:0===Object.keys(t).length?null:t})}))]}))}))}},amPu:function(e,t,n){"use strict";function r(e,t,n){return e&&e.success?(t||(t={}),t.Authorization="".concat("RPSCompact"===e.format?n||"":"Bearer ").concat(e.token).trim(),t):null!=t?t:{}}n.d(t,"a",(function(){return r}))},kb6k:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("QjXU"),a=n("yOLj"),o=n("tyUq"),c=n("GMuP"),i=n("JYsJ"),s=n("amPu"),u=[0,11,22,33];function f(e,t,n,r){e&&(e.headers=Object(s.a)(t,e.headers,n),r&&r(e,t))}function d(e,t,n,s,d,l,h,v,m,b,p,j,O,w,_,g){return void 0===w&&(w=!1),new Promise((function(k,y){var C=h||"None",E="None"===C||"OfficeHome"===C&&!d,R=p||new Set;R.add(401);var P=function(e){var r=e.status,c=Number.NaN;!E&&R.has(r)?c=701:j&&j(r)&&(c=703),c!==Number.NaN&&(Object(a.a)(t,c,-1,"",w),Object(o.a)({eventName:n,fromCache:w,httpCode:c,latency:-1,error:""})),y({httpResponse:e})};if(v){var N=Object(i.a)(v);N&&(s.headers||(s.headers={}),s.headers["ohp-mock"]=N)}(E?Promise.resolve(void 0):l(C,!1,m,void 0,void 0,void 0,_,g)).then((function(i){if(!E){if(!i||!i.success){var d=i?i.error:"";return Object(a.a)(t,702,-1,"string"==typeof d?d:"",w),Object(o.a)({eventName:n,fromCache:w,httpCode:702,latency:-1,error:"string"==typeof d?d:""}),void y({httpResponse:{data:"CAP_Error"===d?d:null,status:702,headers:{},ok:!1,statusText:"Failed to fetch access token",fromCache:!1}})}f(s,i,b,O)}e(s).then(k,(function(t){if(!E&&R.has(t.status)){var n=function(e){var t,n,a=null===(n=Object.entries(e).find((function(e){return"www-authenticate"===Object(r.__read)(e,1)[0].toLowerCase()})))||void 0===n?void 0:n[1];if(null==a?void 0:a.includes("insufficient_claims")){var o=a.match(/claims=\"(\S+)\"/);if(o)return o[1];Object(c.a)({eventName:"Extract_ClaimsChallenge_Error",params:(t={},t.Error="Failed to extract insufficient claims value",t)})}return""}(t.headers);l(C,!0,m,void 0,!1,void 0,void 0,void 0,n).then((function(n){n.success?(f(s,n,b,O),e(s).then(k,P)):P(t)}))}else j&&j(t.status)?function(t,n){var r=function(e,t){return e&&e["retry-after"]}(n.headers),a=function(){var e=Math.floor(1e3*Math.random())%u.length;return u[e]}();r&&(a=Math.ceil(1e3*parseFloat(r||"0"))),setTimeout((function(){e(t).then(k,P)}),a)}(s,t):y({httpResponse:t})}))}))}))}},lAHu:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("c/bn"),a=n("JYsJ");function o(e,t,n,o,c,i,s,u,f,d,l){var h="".concat(o,"/");return n.url.startsWith("http")&&!h.startsWith("http")&&(h="".concat(window.location.origin,"/").concat(h)),0===n.url.lastIndexOf(h,0)&&function(e,t){e.headers||(e.headers={}),e.headers["X-OfficeHome-CorrelationId"]=t;var n=Object(a.a)("testtraffic");n&&(e.headers["X-OfficeHome-TestTraffic"]=n)}(n,c),Object(r.a)(e,t,n,i,s,u,f,d,l)}},mgFK:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("QjXU"),a=n("E7ar"),o=n("8wW2"),c=n("a3FV"),i=n("0TX8"),s=n("Wa5Y"),u=new Map;function f(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,u,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t.disableLegacyNetworkConfigs?[2,void 0]:(n=new URL("".concat(t.officeHomeApiRoot,"/api/config/").concat(e),window.location.origin),a={},[4,Object(i.a)(a,t.inMockMode,t.workload,t.getIdentity)]);case 1:return r.sent(),window.location.search&&(u=new URLSearchParams(window.location.search),a.params||(a.params={}),t.inMockMode?u.forEach((function(e,t){void 0===a.params[t]&&(a.params[t]=e)})):u.has("scenarioid")&&(f=u.get("scenarioid"),a.params.scenarioid=null!=f?f:"")),[2,Object(s.a)(c.a.ConfigRequest,"Config",n.toString(),a,t.jwtAuthEnabled,t.getAccessToken,t.officeHomeApiRoot,t.correlationId,"OfficeHome",{populateRequestEvent:function(t,n){n.ElementId=e}}).then((function(e){return e.data})).catch((function(e){Object(o.a)().handleError(e)}))]}}))}))}function d(e,t){var n=this;if(u.has(e))return u.get(e);var o=new Promise((function(o){return Object(r.__awaiter)(n,void 0,void 0,(function(){var n,c,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:n=void 0,r.label=1;case 1:return r.trys.push([1,5,,6]),(c=window.shellAndConfigResponse)?[4,c]:[3,3];case 2:if((i=r.sent())&&i[e]){try{o(JSON.parse(i[e]))}catch(t){o(i[e])}return[2]}return[3,4];case 3:if(n=Object(a.a)(e))return o(n),[2];r.label=4;case 4:return[3,6];case 5:return r.sent(),[3,6];case 6:return[4,f(e,t)];case 7:return n=r.sent(),o(n),[2]}}))}))}));return u.set(e,o),o}},yOLj:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("8/lW"),a=n("ntFm");function o(e,t,n,o,c,i,s,u){void 0===c&&(c=!1),void 0===i&&(i={}),void 0===s&&(s=[]),void 0===u&&(u=r.a.Security),Object(a.a)(e,t,n,o,c,i,s,u).record()}}}]);
//# sourceMappingURL=2.9b19d3a1fda736a2bc7e.chunk.v7.js.map